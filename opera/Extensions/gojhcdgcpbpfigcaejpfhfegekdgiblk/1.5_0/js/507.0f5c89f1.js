"use strict";(self["webpackChunkdesktop_wallet"]=self["webpackChunkdesktop_wallet"]||[]).push([[507],{83458:function(t,e,s){s.r(e),s.d(e,{default:function(){return x}});var r=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"flex flex-col h-full"},[r("top-bar",{attrs:{"test-parent-name":"swap_confirm",title:t.$t("general.confirm")}}),r("div",{staticClass:"flex flex-col flex-grow p-4"},[r("div",[r("div",{staticClass:"bg-neutral-09 p-4 rounded-tl-xl rounded-tr-xl"},[r("div",{staticClass:"flex flex-col items-center justify-center"},[r("div",{staticClass:"flex flex-row items-center justify-center"},[r("div",{staticClass:"flex flex-col items-end relative shrink-0 w-1/2"},[r("token-icon",{staticClass:"-right-3 absolute h-14 my-2 w-14",attrs:{address:t.fromTokenAddress,chain:t.chain}}),r("div",{staticClass:"text-2xl text-dark-N77 text-right truncate w-full"},[t._v(" "+t._s(t.formatNumber(t.fromTokenAmount))+" "+t._s(t.currentSwap.fromToken.symbol)+" ")]),r("div",{staticClass:"h-6 text-dark-N77-op50"},[t.fromTokenFiatAmount>0?r("span",[t._v(t._s("~ "+t.localizeCurrency(t.fromTokenFiatAmount)))]):t._e()])],1),r("img",{staticClass:"mb-4 text-brand-primary z-50",attrs:{src:s(96352)}}),r("div",{staticClass:"flex flex-col items-start relative shrink-0 w-1/2"},[r("token-icon",{staticClass:"-left-3 absolute h-14 my-2 w-14",attrs:{address:t.toTokenAddress,chain:t.chain}}),r("div",{staticClass:"text-2xl text-left truncate w-full"},[t._v(" "+t._s(t.formatNumber(t.toTokenAmount))+" "+t._s(t.currentSwap.toToken.symbol)+" ")]),r("div",{staticClass:"h-6 text-[#ffffff80]"},[t.toTokenFiatAmount>0?r("span",[t._v(t._s("~ "+t.localizeCurrency(t.toTokenFiatAmount)))]):t._e()])],1)]),r("div",{staticClass:"border-b border-dashed border-neutral-05 my-4 w-full"}),r("div",{staticClass:"flex mb-4 w-full"},[t._m(0),r("div",{staticClass:"ms-4 w-full"},[r("div",{staticClass:"font-bold mb-1"},[t._v(t._s(t.$t("general.rate")))]),r("div",{staticClass:"text-sm"},[t._v(" "+t._s(t.conversion)+" ")])])]),r("div",{staticClass:"flex mb-4 w-full"},[t._m(1),r("div",{staticClass:"ms-4 w-full"},[r("div",{staticClass:"font-bold mb-1"},[t._v(t._s(t.$t("general.maxSlippage")))]),r("div",{staticClass:"text-sm"},[t._v(t._s(t.localizePercentage(t.slippageMax)))])])]),r("div",{staticClass:"flex w-full"},[t._m(2),t.tx&&null!==t.fee?r("div",{staticClass:"ms-4 w-full"},[r("div",{staticClass:"font-bold mb-1"},[t._v(t._s(t.$t("general.transactionFee")))]),r("div",{staticClass:"text-sm",class:[{"text-spectrum-red":t.insufficientFunds}]},[t._v(" "+t._s(t.transactionFee)+" ")])]):t._e()]),t.isFeeZero?r("div",{staticClass:"flex items-center w-full"},[t._m(3),r("div",{staticClass:"ms-4 mt-2.5 text-sm text-spectrum-red w-full"},[t._v(" "+t._s(t.$t("errors.cannotEstimateGas"))+" ")])]):t._e()])]),t._m(4),r("div",{staticClass:"bg-neutral-09 flex justify-between p-4 px-8 rounded-bl-xl rounded-br-xl"},[r("div",{staticClass:"font-bold font-semibold text-2xl"},[t._v(t._s(t.$t("general.total")))]),r("div",{staticClass:"font-semibold text-2xl text-brand-primary"},[r("span",[t._v(t._s(t.localizeCurrency(t.totalFiatAmount)))])])]),t.error?r("div",{staticClass:"flex justify-center my-4 text-center text-sm text-spectrum-red"},[r("img",{staticClass:"mx-2",attrs:{alt:"",src:s(98498)}}),r("span",[t._v(t._s(t.error))])]):t._e()]),r("div",{staticClass:"flex-grow"}),r("div",{staticClass:"my-4"},[r("div",{staticClass:"flex flex-col items-center leading-3 mx-13 text-2xs text-center"},[r("p",{class:[{"mb-2":"SaviSwap"===t.swapProvider}]},[t._v(" "+t._s(t.$t("general.poweredBy",{serviceProvider:t.swapProviderLogo?"":t.swapProvider}))+" ")]),"SaviSwap"!==t.swapProvider?r("img",{staticClass:"h-6 my-1",attrs:{alt:"",src:t.swapProviderLogo}}):t._e(),r("i18n",{attrs:{path:"legal.swapProvider",tag:"p"},scopedSlots:t._u([{key:"swapProvider",fn:function(){return[r("span",[t._v(t._s(t.swapProvider))])]},proxy:!0},{key:"swapProviderTerms",fn:function(){return[r("a",{staticClass:"t-swap_view-tos text-brand-primary",attrs:{href:t.swapProviderTermsLink,rel:"noopener noreferrer",target:"_blank"}},[t._v(" "+t._s(t.$t("legal.swapProviderTerms"))+" ")])]},proxy:!0}])})],1),r("primary-button",{staticClass:"mt-4 t-swap_confirm-swap w-full",attrs:{disabled:t.loading||!!t.error,loading:t.loading,title:t.$t("general.swap")},on:{click:t.confirmTransaction}},[r("lottie-component",{staticClass:"absolute",attrs:{src:"loader_button.json"}})],1)],1)])],1)},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon-wrapper"},[s("i",{staticClass:"icon-coupon info-icon"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon-wrapper"},[s("i",{staticClass:"icon-slippage info-icon"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon-wrapper"},[s("i",{staticClass:"icon-currency info-icon"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon-wrapper"},[s("i",{staticClass:"icon-error text-spectrum-red"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"-my-2 bg-neutral-09 flex items-center justify-between"},[s("div",{staticClass:"half-circle-left z-50"}),s("div",{staticClass:"border-b border-dashed border-neutral-05 w-full"}),s("div",{staticClass:"half-circle-right z-50"})])}],a=s(45858),n=s(70794),o=s(39944),l=s(90108),c=s(56258),u=s(67990),m=s(38423),f=s(4634),d=s(98180),p=s(25108),h={name:"SwapConfirm",components:{LottieComponent:o.Z,PrimaryButton:l.Z,TokenIcon:u.Z,TopBar:m.Z},props:{chain:{default:void 0,type:Object},slippageMax:{default:1,type:Number},swap:{default:void 0,type:Object}},data(){return{error:null,fee:null,loading:!1,success:!1,tx:null}},computed:{conversion(){if(!this.currentSwap)return null;const t=this.currentSwap.fromToken.symbol,e=this.toTokenAmount.dividedBy(this.fromTokenAmount),s=this.currentSwap.toToken.symbol;return`1 ${t} â‰ˆ ${f.ZP.formatNumber(e)} ${s}`},currentSwap(){return this.swap.length?this.swap:this.$store.getters.currentSwap},feeFiat(){if(!this.fee)return;const t=this.$store.getters.matchingNativeToken("",this.chain),e=this.getPriceForToken(t);return this.formatNumber(this.fee).multipliedBy(new n.Z(e))},feeSymbol(){const t=this.$store.getters.matchingNativeToken("",this.chain);return t?t.contract.symbol.toUpperCase():""},fromTokenAddress(){return this.currentSwap.fromToken?.address},fromTokenAmount(){return d.Z.withDecimals(this.currentSwap.fromTokenAmount,this.currentSwap.fromToken.decimals)},fromTokenFiatAmount(){const t=this.getPriceForToken(this.currentSwap.fromToken);return this.fromTokenAmount.multipliedBy(t)},insufficientFunds(){return this.$store.getters.txError.insufficientFunds},isFeeZero(){if(null!==this.fee)return this.fee.isEqualTo(0)},swapProvider(){return this.$store.getters.aggregatorName},swapProviderLogo(){return this.$store.getters.aggregatorLogo},swapProviderTermsLink(){return this.$store.getters.aggregatorTermsLink},toTokenAddress(){return this.currentSwap.toToken?.address},toTokenAmount(){return d.Z.withDecimals(this.currentSwap.toTokenAmount,this.currentSwap.toToken.decimals)},toTokenFiatAmount(){const t=this.getPriceForToken(this.currentSwap.toToken);return this.toTokenAmount.multipliedBy(t)},totalFiatAmount(){return this.toTokenFiatAmount.plus(this.feeFiat)},transactionFee(){if(!this.tx)return;const[t,e]=[this.formatNumber(this.fee),this.localizeCurrency(this.feeFiat)];return`~ ${t} ${this.feeSymbol} (${e})`},txNetwork(){return this.$store.getters.getTransactionNetwork(this.chain)}},watch:{insufficientFunds(t){t&&(this.error=this.$t("errors.generic.insufficientFunds"))}},async mounted(){await this.setupTx(),this.setSwapTxFee()},beforeDestroy(){this.$store.dispatch("clearTxError")},methods:{async confirmTransaction(){if(this.error)return;let t;c.Z.sendStatsEvent(c.Z.types.CLICK,"wt_swap_confirm_next"),this.loading=!0;try{t=await this.$wallet.confirmTransaction(this.tx.txId),this.success=!0,this.sendDetailedSwapTxStats(),this.$router.replace({name:"TransactionComplete",params:{token:this.currentSwap.fromToken,txHash:t}})}catch(e){this.$store.getters.authAborted?c.Z.sendStatsEvent(c.Z.types.CLICK,"wt_swap_pwd_can"):(this.error=this.getErrorMessage(e),c.Z.sendStatsEvent(c.Z.types.CLICK,"wt_swap_pwd_fail"))}finally{if(this.loading=!1,this.success){const{currentSwap:e}=this,s={chain:e.fromToken.chain,contract:e.fromToken.address,from:e.tx.from,hash:t,time:Date.now(),to:e.tx.to,type:e.fromToken.type,value:this.swap.fromTokenAmount};this.$store.dispatch("addPendingTransaction",s)}}},formatNumber:f.ZP.formatNumber,getErrorMessage(t){p.error(t);const e=t.toString()?.toLowerCase(),s=[{message:this.$t("errors.insufficientFunds"),raw:"insufficient funds"}],r=s.find((t=>e.includes(t.raw)))?.message;return p.log(r),r??this.$t("errors.generic.unknownError")},getPriceForToken(t){return t?this.$store.getters.getPriceForToken(t):0},isTransactionFeeCovered(t){const{symbol:e}=this.currentSwap.fromToken,s={amount:this.fromTokenAmount,chain:this.chain,fee:t,symbol:e};return this.$store.getters.isTransactionFeeCovered(s)},localizeCurrency:f.ZP.localizeCurrency,localizePercentage:f.ZP.localizePercentage,sendDetailedSwapTxStats(){c.Z.sendStatsEvent(c.Z.types.CLICK,"wt_swap_pwd_suc",{fromAmount:this.fromTokenAmount.toString(),fromCoin:this.currentSwap.fromToken.symbol,fromNetwork:this.txNetwork.name,toAmount:this.toTokenAmount.toString(),toCoin:this.currentSwap.toToken.symbol,toNetwork:this.txNetwork.name,volumeUSD:new n.Z(this.fromTokenAmount).multipliedBy(this.$store.getters.getPriceForToken(this.currentSwap.fromToken)).toString()})},setSwapTxFee(){const t=this.tx.token;this.fee=d.Z.withDecimals(t.amount,t.decimals),this.isTransactionFeeCovered(this.fee)||this.$store.dispatch("setTxError","insufficientFunds")},async setupTx(){this.loading=!0;try{const t=this.swap,e=await(0,a.u1)(t);this.tx=await this.$wallet.createSwapTransaction(e)}catch(t){this.error=this.getErrorMessage(t)}this.loading=!1}}},w=h,v=s(1001),g=(0,v.Z)(w,r,i,!1,null,"4fc90a8e",null),x=g.exports},96352:function(t,e,s){t.exports=s.p+"img/swap_to.9f0358db.svg"}}]);