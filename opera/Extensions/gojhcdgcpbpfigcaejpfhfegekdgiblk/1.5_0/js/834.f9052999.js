"use strict";(self["webpackChunkdesktop_wallet"]=self["webpackChunkdesktop_wallet"]||[]).push([[834],{34834:function(t,e,s){s.r(e),s.d(e,{default:function(){return C}});var r=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"tracking-wider"},[r("top-bar",{attrs:{"test-parent-name":"send_confirm",title:t.$t("general.confirm")}}),t.transaction?r("div",{staticClass:"px-11 py-4"},[r("div",{staticClass:"border-black border-l border-opacity-10 border-r border-t p-4 rounded-tl-lg rounded-tr-lg"},[r("div",{staticClass:"flex flex-col h-full justify-center"},[r("token-icon",{staticClass:"h-10 my-2 w-10",attrs:{address:t.address,chain:t.chain}}),r("div",{staticClass:"font-bold mt-2 text-2xl"},[t._v(t._s(t.formatNumber(t.amount))+" "+t._s(t.symbol))]),t.fiatAmount?r("div",{staticClass:"mb-1 mt-2 text-lg"},[t._v(" "+t._s("~ "+t.localizeCurrency(t.fiatAmount))+" ")]):t._e(),r("div",{staticClass:"border-b border-dark-N20 my-4 w-full"}),r("div",{staticClass:"flex mb-4 w-full"},[r("div",{staticClass:"border border-accent icon-contacts info-icon my-1 p-2 rounded-full text-accent"}),r("div",{staticClass:"ms-4 w-full"},[r("div",{staticClass:"font-bold mb-1 text-dark-N77"},[t._v(t._s(t.$t("general.recipient")))]),r("div",{staticClass:"text-normal"},[t._v(" "+t._s(t.recipient)+" ")])])]),r("div",{staticClass:"flex mb-4 w-full"},[r("div",{staticClass:"border border-accent icon-currency info-icon my-1 p-2 rounded-full text-accent"}),t.transaction&&null!==t.fee?r("div",{staticClass:"ms-4 w-full"},[r("div",{staticClass:"font-bold mb-1 text-dark-N77"},[t._v(t._s(t.$t("general.transactionFee")))]),r("div",{staticClass:"text-sm",class:[{"text-spectrum-red":t.insufficientFunds}]},[t._v(" "+t._s(t.transactionFee)+" ")])]):t._e()]),t.isFeeZero?r("div",{staticClass:"text-spectrum-red"},[t._v(" "+t._s(t.$t("errors.cannotEstimateGas"))+" ")]):t._e(),r("div",{staticClass:"flex hidden w-full"},[r("div",{staticClass:"border border-accent icon-coupon info-icon my-1 p-2 rounded-full text-accent"}),r("div",{staticClass:"ms-4 w-full"},[r("div",{staticClass:"font-bold mb-1 text-dark-N77"},[t._v(t._s(t.$t("general.message")))]),r("div",{staticClass:"text-normal"},[t._v(" "+t._s(t.transaction.message||"-")+" ")])])])],1)]),t._m(0),t.isNativeCurrency?r("div",{staticClass:"flex justify-between p-4 rounded-bl-lg rounded-br-lg text-lg"},[r("div",{staticClass:"font-bold text-dark-N77"},[t._v(t._s(t.$t("general.total")))]),r("div",{staticClass:"text-brand-primary"},[r("span",{staticClass:"font-bold"},[t._v(t._s(t.formatNumber(t.totalAmount))+" "+t._s(t.feeSymbol))]),r("span",[t._v("Â ("+t._s(t.localizeCurrency(t.totalFiatAmount))+")")])])]):t._e(),r("div",{staticClass:"flex-grow"}),r("div",{staticClass:"mt-5"},[t.error?r("div",{staticClass:"flex justify-center my-5 text-center text-sm text-spectrum-red"},[r("img",{staticClass:"mx-2",attrs:{alt:"",src:s(98498)}}),r("span",[t._v(t._s(t.error))])]):t._e(),r("primary-button",{staticClass:"t-send_confirm-send w-full",attrs:{disabled:t.loading||!!t.error,loading:t.loading,title:t.$t("general.send")},on:{click:t.confirmTransaction}})],1)]):t._e()],1)},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"-my-2 flex items-center justify-between"},[s("div",{staticClass:"half-circle-left"}),s("div",{staticClass:"border-b border-dark-N20 my-4 w-full"}),s("div",{staticClass:"half-circle-right"})])}],n=(s(57658),s(90108)),a=s(56258),o=s(67990),c=s(38423),l=s(4634),d=s(74597),u=s(98180),m=s(25108),f={name:"SendConfirm",components:{PrimaryButton:n.Z,TokenIcon:o.Z,TopBar:c.Z},props:{token:{default:void 0,type:Object},transaction:{default:void 0,type:Object}},data(){return{error:null,loading:!1,success:!1}},computed:{address(){return this.token.contract.contract},amount(){const t=this.token.contract.decimals;return u.Z.withDecimals(this.transaction.amount,t)},chain(){return this.token.chain},fee(){const t=this.transaction.token,e=u.Z.withDecimals(t.amount,t.decimals);return this.isTransactionFeeCovered(e)||this.$store.dispatch("setTxError","insufficientFunds"),e},feeFiat(){const t=this.$store.getters.getNativePrice(this.chain);return this.fee.multipliedBy(t)},feeSymbol(){return this.transaction.token.symbol},fiatAmount(){const t=this.getPriceForToken(this.token);return this.amount.multipliedBy(t)},insufficientFunds(){return this.$store.getters.txError.insufficientFunds},isFeeZero(){if(null!==this.fee)return this.fee.isEqualTo(0)},isNativeCurrency(){return this.$store.getters.matchingNativeToken(this.token.contract.type,this.chain)},recipient(){return d.Z.elideAddress(this.transaction.to)},symbol(){return this.token?.contract?.symbol},totalAmount(){return this.amount.plus(this.fee)},totalFiatAmount(){return this.fiatAmount.plus(this.feeFiat)},transactionFee(){if(this.transaction)return`~ ${this.formatNumber(this.fee)} ${this.feeSymbol} (${this.localizeCurrency(this.feeFiat)})`},txNetwork(){return this.$store.getters.getTransactionNetwork(this.chain)}},watch:{insufficientFunds(t){t&&(this.error=this.$t("errors.generic.insufficientFunds"))}},beforeDestroy(){this.$store.dispatch("clearTxError")},methods:{async confirmTransaction(){if(!this.error){a.Z.sendStatsEvent(a.Z.types.CLICK,"wt_send_confirm_next"),this.loading=!0,this.$progress.display=!0,this.$progress.done=0;try{const{chain:t}=this,e=await this.$wallet.confirmTransaction(this.transaction.txId),s={chain:t,contract:this.token.contract.contract,from:this.transaction.from,hash:e,time:Date.now(),to:this.transaction.to,type:this.token.contract.type,value:this.transaction.amount};this.$store.dispatch("addPendingTransaction",s),this.success=!0,this.sendDetailedSendTxStats(),this.$router.push({name:"TransactionComplete",params:{token:this.token,txHash:e}})}catch(t){this.$store.getters.authAborted?a.Z.sendStatsEvent(a.Z.types.CLICK,"wt_send_pwd_can"):(this.error=this.getErrorMessage(t),a.Z.sendStatsEvent(a.Z.types.CLICK,"wt_send_pwd_fail"))}this.$progress.display=!1,this.loading=!1}},formatNumber:l.ZP.formatNumber,getErrorMessage(t){m.error(t);const e=t.toString()?.toLowerCase(),s=[{message:this.$t("errors.insufficientFunds"),raw:"insufficient funds"}],r=s.find((t=>e.includes(t.raw)))?.message;return r??this.$t("errors.generic.unknownError")},getPriceForToken(t){return t?this.$store.getters.getPriceForToken(t):0},isTransactionFeeCovered(t){const{symbol:e}=this.token.contract,s={amount:this.amount,chain:this.chain,fee:t,symbol:e};return this.$store.getters.isTransactionFeeCovered(s)},localizeCurrency:l.ZP.localizeCurrency,sendDetailedSendTxStats(){a.Z.sendStatsEvent(a.Z.types.CLICK,"wt_send_pwd_suc",{amount:this.amount.toString(),coin:this.token.contract.symbol,network:this.txNetwork.name,volumeUSD:this.fiatAmount.toString()})}}},h=f,v=s(1001),p=(0,v.Z)(h,r,i,!1,null,null,null),C=p.exports}}]);