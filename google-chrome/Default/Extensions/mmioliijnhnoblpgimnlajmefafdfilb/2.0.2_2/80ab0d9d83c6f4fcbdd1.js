!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.MusicKit={})}(this,(function(e){"use strict";var t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function i(e,t){return e(t={exports:{}},t.exports),t.exports}var n=i((function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)})),o=i((function(e){var t=e.exports={version:"2.6.3"};"number"==typeof __e&&(__e=t)})),a=(o.version,function(e){return"object"==typeof e?null!==e:"function"==typeof e}),s=function(e){if(!a(e))throw TypeError(e+" is not an object!");return e},u=function(e){try{return!!e()}catch(e){return!0}},c=!u((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),l=n.document,h=a(l)&&a(l.createElement),p=!c&&!u((function(){return 7!=Object.defineProperty(("div",h?l.createElement("div"):{}),"a",{get:function(){return 7}}).a})),d=Object.defineProperty,f={f:c?Object.defineProperty:function(e,t,r){if(s(e),t=function(e,t){if(!a(e))return e;var r,i;if("function"==typeof(r=e.toString)&&!a(i=r.call(e)))return i;if("function"==typeof(r=e.valueOf)&&!a(i=r.call(e)))return i;throw TypeError("Can't convert object to primitive value")}(t),s(r),p)try{return d(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},y=c?function(e,t,r){return f.f(e,t,function(e,t){return{enumerable:!1,configurable:!0,writable:!0,value:t}}(0,r))}:function(e,t,r){return e[t]=r,e},b={}.hasOwnProperty,m=function(e,t){return b.call(e,t)},v=0,g=Math.random(),_=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++v+g).toString(36))},P=i((function(e){var t=_("src"),r=Function.toString,i=(""+r).split("toString");o.inspectSource=function(e){return r.call(e)},(e.exports=function(e,r,o,a){var s="function"==typeof o;s&&(m(o,"name")||y(o,"name",r)),e[r]!==o&&(s&&(m(o,t)||y(o,t,e[r]?""+e[r]:i.join(String(r)))),e===n?e[r]=o:a?e[r]?e[r]=o:y(e,r,o):(delete e[r],y(e,r,o)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[t]||r.call(this)}))})),k=function(e,t,r){if(function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!")}(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,i){return e.call(t,r,i)};case 3:return function(r,i,n){return e.call(t,r,i,n)}}return function(){return e.apply(t,arguments)}},E=function(e,t,r){var i,a,s,u,c=e&E.F,l=e&E.G,h=e&E.S,p=e&E.P,d=e&E.B,f=l?n:h?n[t]||(n[t]={}):(n[t]||{}).prototype,b=l?o:o[t]||(o[t]={}),m=b.prototype||(b.prototype={});for(i in l&&(r=t),r)s=((a=!c&&f&&void 0!==f[i])?f:r)[i],u=d&&a?k(s,n):p&&"function"==typeof s?k(Function.call,s):s,f&&P(f,i,s,e&E.U),b[i]!=s&&y(b,i,u),p&&m[i]!=s&&(m[i]=s)};n.core=o,E.F=1,E.G=2,E.S=4,E.P=8,E.B=16,E.W=32,E.U=64,E.R=128;var w,T,I=E,A={}.toString,S=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==function(e){return A.call(e).slice(8,-1)}(e)?e.split(""):Object(e)},C=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e},O=function(e){return S(C(e))},D=Math.ceil,R=Math.floor,L=function(e){return isNaN(e=+e)?0:(e>0?R:D)(e)},N=Math.min,U=Math.max,j=Math.min,x=i((function(e){var t=n["__core-js_shared__"]||(n["__core-js_shared__"]={});(e.exports=function(e,r){return t[e]||(t[e]=void 0!==r?r:{})})("versions",[]).push({version:o.version,mode:"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})}))("keys"),M=(w=!1,function(e,t,r){var i,n=O(e),o=(i=n.length)>0?N(L(i),9007199254740991):0,a=function(e,t){return(e=L(e))<0?U(e+t,0):j(e,t)}(r,o);for(w;o>a;a++)if(a in n&&n[a]===t)return a||0;return-1}),B=x[T="IE_PROTO"]||(x[T]=_(T)),z="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),q=Object.keys||function(e){return function(e,t){var r,i=O(e),n=0,o=[];for(r in i)r!=B&&m(i,r)&&o.push(r);for(;t.length>n;)m(i,r=t[n++])&&(~M(o,r)||o.push(r));return o}(e,z)},F={f:Object.getOwnPropertySymbols},V={f:{}.propertyIsEnumerable},K=Object.assign,H=!K||u((function(){var e={},t={},r=Symbol(),i="abcdefghijklmnopqrst";return e[r]=7,i.split("").forEach((function(e){t[e]=e})),7!=K({},e)[r]||Object.keys(K({},t)).join("")!=i}))?function(e,t){for(var r=Object(C(e)),i=arguments.length,n=1,o=F.f,a=V.f;i>n;)for(var s,u=S(arguments[n++]),c=o?q(u).concat(o(u)):q(u),l=c.length,h=0;l>h;)a.call(u,s=c[h++])&&(r[s]=u[s]);return r}:K;I(I.S+I.F,"Object",{assign:H}),o.Object.assign,function(e){if(!e.fetch){var t={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(t.arrayBuffer)var r=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],i=function(e){return e&&DataView.prototype.isPrototypeOf(e)},n=ArrayBuffer.isView||function(e){return e&&r.indexOf(Object.prototype.toString.call(e))>-1};l.prototype.append=function(e,t){e=s(e),t=u(t);var r=this.map[e];this.map[e]=r?r+","+t:t},l.prototype.delete=function(e){delete this.map[s(e)]},l.prototype.get=function(e){return e=s(e),this.has(e)?this.map[e]:null},l.prototype.has=function(e){return this.map.hasOwnProperty(s(e))},l.prototype.set=function(e,t){this.map[s(e)]=u(t)},l.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},l.prototype.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),c(e)},l.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),c(e)},l.prototype.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),c(e)},t.iterable&&(l.prototype[Symbol.iterator]=l.prototype.entries);var o=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},y.call(b.prototype),y.call(v.prototype),v.prototype.clone=function(){return new v(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new l(this.headers),url:this.url})},v.error=function(){var e=new v(null,{status:0,statusText:""});return e.type="error",e};var a=[301,302,303,307,308];v.redirect=function(e,t){if(-1===a.indexOf(t))throw new RangeError("Invalid status code");return new v(null,{status:t,headers:{location:e}})},e.Headers=l,e.Request=b,e.Response=v,e.fetch=function(e,r){return new Promise((function(i,n){var o=new b(e,r),a=new XMLHttpRequest;a.onload=function(){var e,t,r={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new l,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var r=e.split(":"),i=r.shift().trim();if(i){var n=r.join(":").trim();t.append(i,n)}})),t)};r.url="responseURL"in a?a.responseURL:r.headers.get("X-Request-URL");var n="response"in a?a.response:a.responseText;i(new v(n,r))},a.onerror=function(){n(new TypeError("Network request failed"))},a.ontimeout=function(){n(new TypeError("Network request failed"))},a.open(o.method,o.url,!0),"include"===o.credentials?a.withCredentials=!0:"omit"===o.credentials&&(a.withCredentials=!1),"responseType"in a&&t.blob&&(a.responseType="blob"),o.headers.forEach((function(e,t){a.setRequestHeader(t,e)})),a.send(void 0===o._bodyInit?null:o._bodyInit)}))},e.fetch.polyfill=!0}function s(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function u(e){return"string"!=typeof e&&(e=String(e)),e}function c(e){var r={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return t.iterable&&(r[Symbol.iterator]=function(){return r}),r}function l(e){this.map={},e instanceof l?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function h(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function p(e){return new Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function d(e){var t=new FileReader,r=p(t);return t.readAsArrayBuffer(e),r}function f(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(t.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(t.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(t.arrayBuffer&&t.blob&&i(e))this._bodyArrayBuffer=f(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!t.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!n(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=f(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},t.blob&&(this.blob=function(){var e=h(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?h(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(d)}),this.text=function(){var e,t,r,i=h(this);if(i)return i;if(this._bodyBlob)return e=this._bodyBlob,r=p(t=new FileReader),t.readAsText(e),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),i=0;i<t.length;i++)r[i]=String.fromCharCode(t[i]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},t.formData&&(this.formData=function(){return this.text().then(m)}),this.json=function(){return this.text().then(JSON.parse)},this}function b(e,t){var r,i,n=(t=t||{}).body;if(e instanceof b){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new l(e.headers)),this.method=e.method,this.mode=e.mode,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new l(t.headers)),this.method=(i=(r=t.method||this.method||"GET").toUpperCase(),o.indexOf(i)>-1?i:r),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function m(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var r=e.split("="),i=r.shift().replace(/\+/g," "),n=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(i),decodeURIComponent(n))}})),t}function v(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new l(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:void 0);var W=function(e,t){return(W=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function Y(e,t){function r(){this.constructor=e}W(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function G(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{u(i.next(e))}catch(e){o(e)}}function s(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(a,s)}u((i=i.apply(e,t||[])).next())}))}function Q(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var Z=i((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.log=function(){},e}();t.Nonsole=r;var i=function(){function e(e){void 0===e&&(e=5),this._level=e,this._console=this._availableConsole()}return Object.defineProperty(e.prototype,"enabled",{get:function(){return this.level<5},set:function(e){this.level=e?1:5},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){return this._level},set:function(e){this._level=e,this._console=this._availableConsole()},enumerable:!0,configurable:!0}),e.prototype.debug=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._perform("debug",arguments)},e.prototype.error=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._perform("error",arguments)},e.prototype.log=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._perform("log",arguments)},e.prototype.trace=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._perform("trace",arguments)},e.prototype.warn=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._perform("warn",arguments)},e.prototype._availableConsole=function(){return console&&this.level<5?console:new r},e.prototype._perform=function(e){for(var t,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var n=["trace","debug","info","warn","error","silent"].splice(this.level),o="log"===e?"debug":e;-1!==n.indexOf(o)&&(this._console[e]||(e="log"),(t=this._console[e]).apply.apply(t,[this._console].concat(r)))},e}();t.Logger=i}));r(Z),Z.Nonsole;var X=Z.Logger,J=function(){function e(){this._events={},this._keys=[]}return Object.defineProperty(e.prototype,"events",{get:function(){return this._events},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"first",{get:function(){return this.at(0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keys",{get:function(){return this._keys},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"last",{get:function(){return this.at(this.length-1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"second",{get:function(){return this.at(1)},enumerable:!0,configurable:!0}),e.prototype.at=function(e){if(e>this.length-1)throw new Error("Invalid timeline index");var t=this._keys[e];return this._events[t]},e.prototype.before=function(e){if("number"!=typeof e){var t=[];for(var r in this._events)this._events.hasOwnProperty(r)&&t.push(this._events[r]);e=this._keys[t.indexOf(e)]}var i=this._keys.indexOf(e);if(-1===i)throw new Error("Key not found");if(i>0)return this._events[this._keys[i-1]]},e.prototype.drain=function(){var e=this,t=this._keys.map((function(t){return e._events[t]}));return this.reset(),t},e.prototype.reset=function(){this._events={},this._keys=[]},e.prototype.pop=function(){return G(this,void 0,void 0,(function(){var e,t;return Q(this,(function(r){return(e=this._keys.pop())?(t=this._events[e],delete this._events[e],[2,Promise.resolve(t)]):[2,Promise.reject("TIMELINE IS EMPTY")]}))}))},e.prototype.add=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return[2,this.push(e,t)]}))}))},e.prototype.push=function(e,t){return void 0===t&&(t=Date.now()),G(this,void 0,void 0,(function(){return Q(this,(function(r){for(;-1!==this._keys.indexOf(t);)t++;return this._events[t]=e,this._keys.push(t),[2,Promise.resolve(t)]}))}))},e.prototype.shift=function(){return G(this,void 0,void 0,(function(){var e,t;return Q(this,(function(r){return(e=this._keys.shift())?(t=this._events[e],delete this._events[e],[2,Promise.resolve(t)]):[2,Promise.reject("TIMELINE IS EMPTY")]}))}))},e.prototype.unshift=function(e,t){return void 0===t&&(t=Date.now()),G(this,void 0,void 0,(function(){return Q(this,(function(r){for(;-1!==this._keys.indexOf(t);)t++;return this._events[t]=e,this._keys.unshift(t),[2,Promise.resolve(t)]}))}))},e}(),$=function(){function e(e,t){void 0===t&&(t=""),this._message=e,this._explanation=t,this.id="musickit-dialog",this.scrimId=this.id+"-scrim",this.styleId=this.id+"-style",this._okButtonString="OK",[this.id,this.scrimId,this.styleId].forEach((function(e){try{var t=document.getElementById(e);t.parentElement.removeChild(t)}catch(e){}})),this._appendStyle("\n#musickit-dialog-scrim {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.35);\n}\n\n#musickit-dialog * {\n  -webkit-tap-highlight-color: transparent;\n  -webkit-touch-callout: none;\n  -ms-touch-action: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  font-family: -apple-system, SF UI Text, Helvetica Neue, Helvetica, sans-serif;\n  font-size: 15px;\n  line-height: 20px;\n  font-weight: 300;\n}\n\n#musickit-dialog *:focus { outline: 0; }\n\n#musickit-dialog {\n  display: -webkit-box;\n  display: -moz-box;\n  display: -ms-flexbox;\n  display: -webkit-flex;\n  display: flex;\n  -webkit-flex-direction: column;\n  -moz-flex-direction: column;\n  flex-direction: column;\n  -webkit-justify-content: space-between;\n  -moz-justify-content: space-between;\n  justify-content: space-between;\n  min-width: 277px;\n  max-width: 283px;\n  min-height: 109px;\n  max-height: 150px;\n  background: rgba(255, 255, 255, 1);\n  box-shadow: 0px 0px 9px rgba(0, 0, 0, 0.18);\n  border-radius: 10px;\n  color: #333;\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  margin-left: -142px;\n  margin-top: -67px;\n  background: rgba(255, 255, 255, 0.95);\n  z-index: 9999999999999999999999999;\n}\n\n#musickit-dialog aside {\n  display: -webkit-box;\n  display: -moz-box;\n  display: -ms-flexbox;\n  display: -webkit-flex;\n  display: flex;\n  -webkit-flex-direction: column;\n  -moz-flex-direction: column;\n  flex-direction: column;\n  flex-grow: 1;\n  -webkit-justify-content: space-evenly;\n  -moz-justify-content: space-evenly;\n  justify-content: space-evenly;\n  -webkit-align-items: stretch;\n  align-items: stretch;\n  padding: 0px 20px;\n  max-height: 108px;\n  min-height: 74px;\n  text-align: center;\n}\n\n#musickit-dialog aside h5 {\n  font-weight: 500;\n  line-height: 20px;\n  margin: 7px 0 0 0;\n  padding: 0;\n}\n\n#musickit-dialog aside p {\n  margin: 0 0 7px 0;\n  padding: 0;\n  line-height: 18px;\n  font-size: 13px;\n}\n\n#musickit-dialog nav {\n  border-top: 1px solid #E2E2E2;\n  display: -webkit-box;\n  display: -moz-box;\n  display: -ms-flexbox;\n  display: -webkit-flex;\n  display: flex;\n  -webkit-flex-direction: row;\n  -moz-flex-direction: colrowumn;\n  flex-direction: row;\n  max-height: 41px;\n  min-height: 34px;\n  -webkit-justify-self: flex-end;\n  -moz-justify-self: flex-end;\n  justify-self: flex-end;\n}\n\n#musickit-dialog nav button {\n  flex-grow: 1;\n  border: 0;\n  background: none;\n  color: #C82C4C;\n  padding: 0;\n  margin: 0;\n  min-height: 34px;\n  height: 41px;\n  text-align: center;\n}\n\n#musickit-dialog nav *:nth-child(2) {\n  border-left: 1px solid #E2E2E2;\n  font-weight: 500;\n}\n")}return e.serverDialog=function(e){var t=new this(e.message,e.explanation);return e.okButtonAction&&e.okButtonAction.url&&(t._okButtonActionURL=e.okButtonAction.url),e.okButtonString&&(t._okButtonString=e.okButtonString),e.cancelButtonString&&(t._cancelButtonString=e.cancelButtonString),t},Object.defineProperty(e.prototype,"actions",{get:function(){return this.cancelButton?"<nav>"+this.cancelButton+this.okButton+"</nav>":"<nav>"+this.okButton+"</nav>"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cancelButton",{get:function(){if("string"==typeof this._cancelButtonString)return"<button>"+this._cancelButtonString+"</button>"},set:function(e){this._cancelButtonString=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"explanation",{get:function(){return"<p>"+this._explanation+"</p>"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasOKButtonAction",{get:function(){return!!this._okButtonActionURL},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"message",{get:function(){return"<h5>"+this._message+"</h5>"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"okButton",{get:function(){return this.hasOKButtonAction?"<button data-ok-action-url='"+this._okButtonActionURL+"'>"+this._okButtonString+"</button>":"<button>"+this._okButtonString+"</button>"},enumerable:!0,configurable:!0}),e.prototype.present=function(){var e=this,t=document.createDocumentFragment(),r=document.createElement("div");r.id=this.scrimId,t.appendChild(r);var i=document.createElement("div");i.id=this.id;var n="<aside>"+this.message+this.explanation+"</aside>";n=""+n+this.actions,i.innerHTML=n,t.appendChild(i),document.body.appendChild(t),setTimeout((function(){document.querySelector("#"+i.id+" nav *:first-child").addEventListener("mouseup",(function(){i.parentElement.removeChild(i),r.parentElement.removeChild(r)})),e.hasOKButtonAction&&document.querySelector("#"+i.id+" nav *:last-child").addEventListener("mouseup",(function(e){window.open(e.target.dataset.okActionUrl,"_blank"),i.parentElement.removeChild(i),r.parentElement.removeChild(r)}))}))},e.prototype._appendStyle=function(e){var t=document.createElement("style");t.id=this.styleId,t.type="text/css",t.styleSheet?t.styleSheet.cssText=e:t.innerHTML=e,document.body.appendChild(t)},e}(),ee="UNKNOWN_ERROR",te={400:"REQUEST_ERROR",401:"UNAUTHORIZED_ERROR",403:"ACCESS_DENIED",404:"NOT_FOUND",405:"NOT_FOUND",413:"REQUEST_ERROR",414:"REQUEST_ERROR",429:"QUOTA_EXCEEDED",500:"SERVER_ERROR",501:"NOT_FOUND",503:"SERVICE_UNAVAILABLE"},re={1010:te[404],2002:"AUTHORIZATION_ERROR",2034:"TOKEN_EXPIRED",3059:"DEVICE_LIMIT",3063:"SUBSCRIPTION_ERROR",3076:"CONTENT_UNAVAILABLE",3082:"CONTENT_RESTRICTED",3084:"STREAM_UPSELL",5002:te[500]},ie=[],ne=function(e){function t(r,i){var n=e.call(this)||this;return n.errorCode=ee,i||"string"!=typeof r?(n.name=n.errorCode=r||ee,i&&(n.message=n.description=i)):(n.name=n.errorCode=ee,n.message=n.description=r),ie.push(n),Error.captureStackTrace&&Error.captureStackTrace(n,t),n.presentDialog=function(){n.dialog?$.serverDialog(n.dialog).present():new $(n.message).present()},n}return Y(t,e),Object.defineProperty(t,"errors",{get:function(){return ie},enumerable:!0,configurable:!0}),t.playActivityError=function(e){return new this("PLAY_ACTIVITY",e)},t.parseError=function(e){return new this("PARSE_ERROR",e)},t.responseError=function(e){var t=e.status,r=e.statusText;return new this(te[t]||"NETWORK_ERROR",r||""+t)},t.serverError=function(e){var t=e.status,r=e.dialog,i=e.failureType,n=e.customerMessage,o=e.errorMessage,a=e.message;r&&(a=r.message||r.customerMessage||r.errorMessage);var s=re[i]||re[t]||ee,u=new this(s,a||n||o);return"STREAM_UPSELL"===s&&r.okButtonAction&&r.okButtonAction.url&&(r.okButtonAction.url=r.okButtonAction.url.replace(/\&(?:challenge|key-system|uri|user-initiated)=[^\&]+/gim,"")),u.dialog=r,u},t.ACCESS_DENIED=te[403],t.AUTHORIZATION_ERROR=re[2002],t.CONFIGURATION_ERROR="CONFIGURATION_ERROR",t.CONTENT_EQUIVALENT="CONTENT_EQUIVALENT",t.CONTENT_RESTRICTED=re[3082],t.CONTENT_UNAVAILABLE=re[3076],t.DEVICE_LIMIT=re[3059],t.INVALID_ARGUMENTS="INVALID_ARGUMENTS",t.MEDIA_CERTIFICATE="MEDIA_CERTIFICATE",t.MEDIA_DESCRIPTOR="MEDIA_DESCRIPTOR",t.MEDIA_LICENSE="MEDIA_LICENSE",t.MEDIA_KEY="MEDIA_KEY",t.MEDIA_PLAYBACK="MEDIA_PLAYBACK",t.MEDIA_SESSION="MEDIA_SESSION",t.NETWORK_ERROR="NETWORK_ERROR",t.NOT_FOUND=re[1010],t.PARSE_ERROR="PARSE_ERROR",t.PLAY_ACTIVITY="PLAY_ACTIVITY",t.QUOTA_EXCEEDED=te[429],t.REQUEST_ERROR=te[400],t.SERVER_ERROR=re[5002],t.SERVICE_UNAVAILABLE=te[503],t.STREAM_UPSELL=re[3084],t.SUBSCRIPTION_ERROR=re[3063],t.TOKEN_EXPIRED=re[2034],t.UNAUTHORIZED_ERROR=te[401],t.UNKNOWN_ERROR=ee,t.UNSUPPORTED_ERROR="UNSUPPORTED_ERROR",t}(Error),oe=/\/([a-z]{2})\/(album|playlist|podcast|song|station)\/(?:[^\/]*\/)?(?:id)?(\d+|[a-z]{2}\.[a-z0-9\-]+)(?:.*(?:[\?|\&]i=(\d+)).*)?.*$/i;function ae(e){return{hours:Math.floor(e/3600),minutes:Math.floor(e%3600/60)}}function se(e,t){void 0===t&&(t=":");var r=ae(e),i=r.hours,n=r.minutes;e=Math.floor(e%3600%60);var o=[];return i?(o.push(""+i),o.push(n<10?"0"+n:""+n)):o.push(""+n),o.push(e<10?"0"+e:""+e),o.join(t)}function ue(e){if(!oe.test(e))throw new TypeError("Invalid Media URL: "+e);var t=e.match(oe),r=t[1],i=t[2],n=t[3],o=t[4];return-1!==["album","playlist"].indexOf(i)&&o?(i="song",n=o):"podcast"===i&&o&&(i="episode",n=o),{storefrontId:r,kind:i,contentId:n}}function ce(e){return/^[a|i|l|p]{1}\.[a-zA-Z0-9]+$/.test(e)}function le(e){return void 0!==e&&e.hasAuthorized&&e.userTokenIsValid}var he=i((function(e,t){function r(){return Math.random().toString(16).substring(2)}Object.defineProperty(t,"__esModule",{value:!0}),t.generateUUID=function(){for(var e=r()+r();e.length<16;)e+=r();return e.slice(0,16)},t.isLibraryType=function(e){return/^(?:[a|i|l|p]{1}\.|pl\.u\-)[a-zA-Z0-9]+$/.test(e)}}));r(he);var pe=he.generateUUID,de=(he.isLibraryType,i((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._data={}}return e.prototype.clear=function(){this._data={}},e.prototype.getItem=function(e){return this._data[e]},e.prototype.removeItem=function(e){delete this._data[e]},e.prototype.setItem=function(e,t){this._data[e]=t},e}();t.GenericStorage=r,t.getCookie=function(e){void 0===e&&(e="");var t=document.cookie.match(new RegExp("(?:^|;\\s*)"+e+"=([^;]*)"));if(t)return t[1]},t.setCookie=function(e,t,r,i){void 0===r&&(r=""),void 0===i&&(i=14);var n=new Date,o=/\./.test(window.location.hostname)?window.location.hostname:"";/^(?:[a-z\-]+\.)?(?:music|itunes)\.apple\.com$/i.test(o)&&(o="domain=apple.com"),n.setTime(n.getTime()+24*i*60*60*1e3),window.document.cookie=e+"="+t+"; expires="+n.toUTCString()+"; "+o+"; path="+r}})));r(de),de.GenericStorage;var fe,ye,be,me,ve,ge,_e,Pe,ke,Ee=de.getCookie,we=de.setCookie;function Te(e){return e&&"song"===e.type}!function(e){e.MUSICKIT="music_kit-integration",e.OTHER="other",e.MINI="mini",e.SONG="song",e.ALBUM="album",e.ALBUM_CLASSICAL="album-classical",e.ARTIST="artist",e.COMPILATION="compilation",e.COMPILATION_CLASSICAL="compilation-classical",e.PLAYLIST="playlist",e.PLAYLIST_CLASSICAL="playlist-classical",e.SEARCH="search"}(fe||(fe={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.RADIO=1]="RADIO",e[e.PLAYLIST=2]="PLAYLIST",e[e.ALBUM=3]="ALBUM",e[e.ARTIST=4]="ARTIST"}(ye||(ye={})),function(e){e[e.NOT_APPLICABLE=0]="NOT_APPLICABLE",e[e.OTHER=1]="OTHER",e[e.TRACK_SKIPPED_FORWARDS=2]="TRACK_SKIPPED_FORWARDS",e[e.PLAYBACK_MANUALLY_PAUSED=3]="PLAYBACK_MANUALLY_PAUSED",e[e.PLAYBACK_SUSPENDED=4]="PLAYBACK_SUSPENDED",e[e.MANUALLY_SELECTED_PLAYBACK_OF_A_DIFF_ITEM=5]="MANUALLY_SELECTED_PLAYBACK_OF_A_DIFF_ITEM",e[e.PLAYBACK_PAUSED_DUE_TO_INACTIVITY=6]="PLAYBACK_PAUSED_DUE_TO_INACTIVITY",e[e.NATURAL_END_OF_TRACK=7]="NATURAL_END_OF_TRACK",e[e.PLAYBACK_STOPPED_DUE_TO_SESSION_TIMEOUT=8]="PLAYBACK_STOPPED_DUE_TO_SESSION_TIMEOUT",e[e.TRACK_BANNED=9]="TRACK_BANNED",e[e.FAILED_TO_LOAD=10]="FAILED_TO_LOAD",e[e.PAUSED_ON_TIMEOUT=11]="PAUSED_ON_TIMEOUT",e[e.SCRUB_BEGIN=12]="SCRUB_BEGIN",e[e.SCRUB_END=13]="SCRUB_END",e[e.TRACK_SKIPPED_BACKWARDS=14]="TRACK_SKIPPED_BACKWARDS",e[e.NOT_SUPPORTED_BY_CLIENT=15]="NOT_SUPPORTED_BY_CLIENT",e[e.QUICK_PLAY=16]="QUICK_PLAY",e[e.EXITED_APPLICATION=17]="EXITED_APPLICATION"}(be||(be={})),function(e){e[e.NOT_SPECIFIED=0]="NOT_SPECIFIED",e[e.CONTAINER_CHANGED=1]="CONTAINER_CHANGED"}(me||(me={})),function(e){e[e.PLAY_END=0]="PLAY_END",e[e.PLAY_START=1]="PLAY_START"}(ve||(ve={})),function(e){e[e.INVALID=0]="INVALID",e[e.ITUNES_STORE_CONTENT=1]="ITUNES_STORE_CONTENT",e[e.NON_SONG_CLIP=2]="NON_SONG_CLIP",e[e.AD=3]="AD",e[e.STREAM=4]="STREAM",e[e.AUDIO_AD=5]="AUDIO_AD",e[e.VIDEO_AD=6]="VIDEO_AD",e[e.TIMED_METADATA_PING=7]="TIMED_METADATA_PING",e[e.ARTIST_UPLOADED_CONTENT=8]="ARTIST_UPLOADED_CONTENT",e[e.AGGREGATE_NON_CATALOG_PLAY_TIME=9]="AGGREGATE_NON_CATALOG_PLAY_TIME",e[e.ORIGINAL_CONTENT_MOVIES=10]="ORIGINAL_CONTENT_MOVIES",e[e.ORIGINAL_CONTENT_SHOWS=11]="ORIGINAL_CONTENT_SHOWS"}(ge||(ge={})),function(e){e[e.AUDIO=0]="AUDIO",e[e.VIDEO=1]="VIDEO"}(_e||(_e={})),function(e){e[e.AUTO=0]="AUTO",e[e.MANUAL=1]="MANUAL"}(Pe||(Pe={})),function(e){e[e.WEBPLAYER=8]="WEBPLAYER",e[e.MUSICKIT=10]="MUSICKIT"}(ke||(ke={}));var Ie,Ae=function(){function e(e,t,r,i){this.accessToken=e,this.musicUserToken=t,this.storefrontId=r,this.privateEnabled=!1,this.siriInitiated=!1,this.clientId="JSCLIENT",this.eventType="JSPLAY",this.internalBuild=!1,this.sourceType=ke.MUSICKIT,this.timeline=new J,this._logInfo=!1,this._mode=Pe.AUTO,this._navigator=navigator,this._utcOffset=(new Date).getTimezoneOffset(),i&&(this._appInfo=i.app,this._logInfo=i.logInfo||!1,this._utcOffset=i.utcOffset||(new Date).getTimezoneOffset(),this._userAgent=i.userAgent,this.sourceType=i.sourceType&&"number"==typeof i.sourceType?i.sourceType:ke.MUSICKIT),this.buildVersion=this._generateBuildVersion()}return Object.defineProperty(e.prototype,"appID",{get:function(){if(!this._appInfo||!this._appInfo.name)return"MusicKitApp/1.0";if(!this._appId){var e=this._appInfo.name.toLowerCase().replace(/[-_]+/g," ").replace(/[^\w\s]/g,"").replace(/\b./g,(function(e){return e.toUpperCase()})).replace(/\s/g,"");this._appId=e+"/"+(this._appInfo.version||"1.0")}return this._appId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"utcOffsetInSeconds",{get:function(){if(!this._utcOffsetInSeconds&&this._utcOffset){var e=60*this._utcOffset;this._utcOffsetInSeconds=e<0?Math.abs(e):-e}return this._utcOffsetInSeconds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"userAgent",{get:function(){return this._userAgent||navigator.userAgent},enumerable:!0,configurable:!0}),e.prototype.activate=function(e){return void 0===e&&(e=!1),G(this,void 0,void 0,(function(){var t;return Q(this,(function(r){switch(r.label){case 0:return e?[4,this.flush()]:[3,2];case 1:r.sent(),r.label=2;case 2:return(t=this.timeline.last)&&t.endReasonType===be.EXITED_APPLICATION?[2,this.timeline.pop()]:[2]}}))}))},e.prototype.exit=function(e){return void 0===e&&(e=0),G(this,void 0,void 0,(function(){return Q(this,(function(t){return[2,this.stop(e,be.EXITED_APPLICATION)]}))}))},e.prototype.pause=function(e){return void 0===e&&(e=0),G(this,void 0,void 0,(function(){return Q(this,(function(t){return[2,this.stop(e,be.PLAYBACK_MANUALLY_PAUSED)]}))}))},e.prototype.play=function(e,t){return void 0===t&&(t=0),G(this,void 0,void 0,(function(){var r,i,n,o,a;return Q(this,(function(s){switch(s.label){case 0:return r=this.timeline.length>0,!e&&r?((n=this._previousDescriptor()).eventType===ve.PLAY_END&&delete n.endReasonType,i=Object.assign(n,{eventType:ve.PLAY_START,timestamp:Date.now()}),[2,this._addToTimeline(i)]):r?(n=this._previousDescriptor()).eventType!==ve.PLAY_START&&n.endReasonType!==be.SCRUB_END?[3,2]:(o=Object.assign(n,{eventType:ve.PLAY_END,endReasonType:be.MANUALLY_SELECTED_PLAYBACK_OF_A_DIFF_ITEM,timestamp:Date.now(),position:t}),[4,this._addToTimeline(o)]):[3,2];case 1:s.sent(),t=0,s.label=2;case 2:return a=Object.assign(e,{eventType:ve.PLAY_START,timestamp:Date.now(),position:t}),[2,this._addToTimeline(a)]}}))}))},e.prototype.scrub=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=be.SCRUB_BEGIN),G(this,void 0,void 0,(function(){var r,i;return Q(this,(function(n){return r=this._previousDescriptor(),t===be.SCRUB_END&&r.endReasonType!==be.SCRUB_BEGIN?[2,Promise.reject(ne.playActivityError("The scrub() method was called with the SCRUB_END action without a previous SCRUB_START descriptor"))]:(i=Object.assign(r,{eventType:ve.PLAY_END,endReasonType:t,timestamp:Date.now(),position:e}),[2,this._addToTimeline(i)])}))}))},e.prototype.skip=function(e,t,r){return void 0===t&&(t=be.TRACK_SKIPPED_FORWARDS),void 0===r&&(r=0),G(this,void 0,void 0,(function(){return Q(this,(function(i){switch(i.label){case 0:return[4,this.stop(r,t)];case 1:return i.sent(),[2,this.play(e)]}}))}))},e.prototype.stop=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=be.NATURAL_END_OF_TRACK),G(this,void 0,void 0,(function(){var r,i;return Q(this,(function(n){switch(n.label){case 0:return(r=this._previousDescriptor()).endReasonType!==be.EXITED_APPLICATION?[3,2]:[4,this.timeline.pop()];case 1:n.sent(),we("amupaee","","/",0),r=this._previousDescriptor(),n.label=2;case 2:return r.eventType===ve.PLAY_START||r.endReasonType===be.SCRUB_END?(i=Object.assign(r,{eventType:ve.PLAY_END,timestamp:Date.now(),endReasonType:t,position:e}),[2,this._addToTimeline(i)]):[2,Promise.reject(ne.playActivityError("A play stop() method was called without a previous play() descriptor"))]}}))}))},e.prototype.build=function(e,t){if(void 0===e&&(e=this.timeline.last),!e)throw ne.playActivityError("build() called without a play activity descriptor");var r=e.cloudId,i=e.container,n=e.duration,o=void 0===n?0:n,a=e.endReasonType,s=e.eventType,u=void 0===s?ve.PLAY_START:s,c=e.id,l=e.itemType,h=void 0===l?ge.ITUNES_STORE_CONTENT:l,p=e.mediaType,d=void 0===p?_e.AUDIO:p,f=e.position,y=void 0===f?0:f,b=e.timestamp,m="-1"===c?{}:{"subscription-adam-id":c};if(r&&(m["cloud-id"]=r),t||(t=this.timeline.before(e)),u===ve.PLAY_END&&!t)throw ne.playActivityError("Cannot build() for PLAY_END descriptors without previous descriptors");var v=!1;i&&(v=!t||!t.container||i.id!==t.container.id);var g=Math.round(1e3*o),_=b?Date.now()-b:0,P=Math.round(1e3*y),k={"build-version":this.buildVersion,"developer-token":this.accessToken,"event-type":u,ids:m,"internal-build":this.internalBuild,"media-duration-in-milliseconds":g,"media-type":d,"milliseconds-since-play":_,offline:!1,"persistent-id":pe(),"private-enabled":this.privateEnabled,"sb-enabled":!0,"siri-initiated":this.siriInitiated,"source-type":this.sourceType,"start-position-in-milliseconds":P,"store-front":this.storefrontId,type:h,"user-agent":this.userAgent,"user-token":this.musicUserToken,"utc-offset-in-seconds":this.utcOffsetInSeconds||-1};if(u===ve.PLAY_START?k["event-reason-hint-type"]=v?me.CONTAINER_CHANGED:me.NOT_SPECIFIED:u===ve.PLAY_END&&t&&void 0!==t.position&&(k["end-position-in-milliseconds"]=P,P>g&&(k["media-duration-in-milliseconds"]=P),k["start-position-in-milliseconds"]=Math.round(1e3*t.position),k["end-reason-type"]=a),i){var E=void 0;if("string"==typeof i.type)switch(i.type){case"album":case"albums":case"library-albums":E=ye.ALBUM;break;case"artist":case"artists":case"library-artists":E=ye.ARTIST;break;case"playlist":case"playlists":case"library-playlists":E=ye.PLAYLIST;break;case"radio":case"radioStation":case"station":case"stations":E=ye.RADIO}else"number"==typeof i.type&&(E=i.type);k["feature-name"]=""+(i.name||fe.MUSICKIT),E&&(k["container-type"]=E,E===ye.PLAYLIST?k["container-ids"]={"global-playlist-id":i.id}:k["container-ids"]=ce(i.id)?{"cloud-album-id":i.id}:{"album-adam-id":i.id})}return k},e.prototype.flush=function(){return G(this,void 0,void 0,(function(){var e,t;return Q(this,(function(r){switch(r.label){case 0:if(!(e=Ee("amupaee")))return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),t=JSON.parse(atob(e)),[4,this.send(t)];case 2:return r.sent(),we("amupaee","","/",0),[3,4];case 3:return r.sent(),[2,Promise.reject(ne.playActivityError("flush"))];case 4:return[2,Promise.resolve()]}}))}))},e.prototype.send=function(e){return G(this,void 0,void 0,(function(){var t,r;return Q(this,(function(i){switch(i.label){case 0:return t=new Headers({Authorization:"Bearer "+this.accessToken,"Content-Type":"application/json","X-Apple-Music-User-Token":""+this.musicUserToken}),(r={client_id:this.clientId,event_type:this.eventType,data:Array.isArray(e)?e:[e]}).data.length>0?[4,fetch("https://universal-activity-service.itunes.apple.com/play",{method:"POST",body:JSON.stringify(r),headers:t})]:[3,3];case 1:return[4,i.sent().text()];case 2:return i.sent(),this._logInfo&&console.info("play activity:",r),[2,r];case 3:throw ne.playActivityError("send() called without any data")}}))}))},e.prototype._addToTimeline=function(e){return G(this,void 0,void 0,(function(){var t;return Q(this,(function(r){switch(r.label){case 0:return[4,this.timeline.add(e)];case 1:return t=r.sent(),this._mode!==Pe.AUTO||e.endReasonType===be.EXITED_APPLICATION?[3,3]:[4,this.send(this.build())];case 2:return r.sent(),[3,4];case 3:we("amupaee",btoa(JSON.stringify(this.build())),"/"),r.label=4;case 4:return[2,t]}}))}))},e.prototype._generateBuildVersion=function(){var e,t=this.userAgent.toLowerCase(),r=this._navigator&&this._navigator.platform?this._navigator.platform:"Unavailable",i="Unidentified OS",n="0.0",o=/mobile/.test(t);o&&/android|adr/.test(t)?(i="Android",e=t.match(/(?:android|adr)\ ((\d+[._])+\d+)/)):o&&/iphone|ipad|ipod/.test(t)?(i="iOS",e=t.match(/os\ ((\d+[._])+\d+)\ like\ mac\ os\ x/)):/tizen/.test(t)?(i="Tizen",e=t.match(/tizen (.*)/)):/web0s|webos/.test(t)?(i="WebOS",e=t.match(/[web0s|webos] (.*)/)):!o&&/cros/.test(t)?i="ChromeOS":!o&&/macintosh/.test(t)?(i="macOS",e=t.match(/os\ x\ ((\d+[._])+\d+)\b/)):!o&&/linux/.test(t)?i="Linux":!o&&/windows/.test(t)&&(i="Windows",e=t.match(/windows ([^\)]*)/)),e&&e[1]&&(n=e[1].replace(/_/g,"."));var a=this._appInfo&&this._appInfo.build?this._appInfo.build:"0.0.0";return this.appID+" "+i+"/"+n+" model/"+r+" build/"+a},e.prototype._previousDescriptor=function(){var e=this.timeline.last;if(!e)throw ne.playActivityError("A method was called without a previous descriptor");return Object.assign({},e)},e}(),Se=function(){function e(){}return e.prototype.activate=function(e){return void 0===e&&(e=!1),G(this,void 0,void 0,(function(){return Q(this,(function(e){return[2,Promise.resolve()]}))}))},e.prototype.exit=function(e){return void 0===e&&(e=0),G(this,void 0,void 0,(function(){return Q(this,(function(e){return[2,Promise.resolve(0)]}))}))},e.prototype.flush=function(){return G(this,void 0,void 0,(function(){return Q(this,(function(e){return[2,Promise.resolve(0)]}))}))},e.prototype.pause=function(e){return void 0===e&&(e=0),G(this,void 0,void 0,(function(){return Q(this,(function(e){return[2,Promise.resolve(0)]}))}))},e.prototype.play=function(e,t){return void 0===t&&(t=0),G(this,void 0,void 0,(function(){return Q(this,(function(e){return[2,Promise.resolve(0)]}))}))},e.prototype.scrub=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=be.SCRUB_BEGIN),G(this,void 0,void 0,(function(){return Q(this,(function(e){return[2,Promise.resolve(0)]}))}))},e.prototype.skip=function(e,t,r){return void 0===t&&(t=be.TRACK_SKIPPED_FORWARDS),void 0===r&&(r=0),G(this,void 0,void 0,(function(){return Q(this,(function(e){return[2,Promise.resolve(0)]}))}))},e.prototype.stop=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=be.NATURAL_END_OF_TRACK),G(this,void 0,void 0,(function(){return Q(this,(function(e){return[2,Promise.resolve(0)]}))}))},e}(),Ce=function(e){void 0===e&&(e=window.navigator.userAgent);var t=e.toLowerCase();this.isEdge=/\sedge\//.test(t),this.isChrome=!this.isEdge&&/chrome/.test(t),this.isSafari=!this.isEdge&&!this.isChrome&&/safari/.test(t),this.isFirefox=!this.isEdge&&!this.isChrome&&!this.isSafari&&/firefox/.test(t),this.isIE=!this.isEdge&&!this.isChrome&&!this.isSafari&&!this.isFirefox&&/trident|msie/.test(t),this.isMobile=/mobile/.test(t),this.isAndroid=this.isMobile&&/android/.test(t),this.isiOS=this.isMobile&&/iphone|ipad|ipod/.test(t),this.isWebView=/(webview|(iphone|ipod|ipad)(?!.*safari\/)|android.*(wv|\.0\.0\.0)|\bfb[\w_]+\/(?:messenger)?|\binstagram|\btwitter)/.test(t),this.isEdge?this.engineVersion=t.match(/(?:edge).(\d+)/):(this.version=t.match(/(?:chrome|version|firefox|msie|rv).(\d+)\.(\d+)/),this.engineVersion=t.match(/(?:applewebkit|gecko|trident).(\d+)/)),this.version&&(this.majorVersion=parseInt(this.version[1],10),this.minorVersion=parseInt(this.version[2],10)),this.engineVersion&&(this.engineMajorVersion=parseInt(this.engineVersion[1],10))},Oe="explicit",De='audio/mp4;codecs="mp4a.40.2"',Re={app:{},browser:function(){return Ie||(Ie=new Ce),Ie},features:{equivalencies:!0},logger:new X,sourceType:ke.MUSICKIT,supportedMediaTypes:["song"],urls:{api:"https://api.music.apple.com/v1",play:"https://play.itunes.apple.com/WebObjects/MZPlay.woa/wa/webPlayback"}},Le=i((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.mapFeatures=function(e){void 0===e&&(e=[]);var t={};return e.forEach((function(e){"-"===e.charAt(0)?(e=e.substr(1),t[e]=!1):t[e]=!0})),t}}));r(Le);var Ne=Le.mapFeatures,Ue=i((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default="undefined"!=typeof FastBoot?FastBoot.require("buffer").Buffer:"undefined"!=typeof process&&null!==process.versions&&null!==process.versions.node?Buffer:window.Buffer}));r(Ue);var je=i((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.memoize=function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var i="",n=t.length;n--;){var o=t[n];i+=o===Object(o)?JSON.stringify(o):o,e._memoized||(e._memoized={})}return i in e._memoized?e._memoized[i]:e._memoized[i]=e.apply(void 0,t)}}}));r(je),je.memoize;var xe=i((function(e,r){var i=t&&t.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return a},n=t&&t.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var o=n(Ue);function a(){return Math.random().toString(16).substring(2)}function s(e){var t=function(e){return null!=e};return 0===arguments.length&&"undefined"!=typeof process&&(e=process),t(e)&&t(e.versions)&&t(e.versions.node)||"undefined"!=typeof FastBoot}r.isObject=function(e){return!!e&&"object"==typeof e&&!Array.isArray(e)},r.generateUUID=function(){for(var e=a()+a();e.length<16;)e+=a();return e.slice(0,16)},r.isLibraryType=je.memoize((function(e){return/^[a|i|l|p]{1}\.[a-zA-Z0-9]+$/.test(e)})),r.isAdamId=je.memoize((function(e){return/^(a\.)?[a-zA-Z0-9]+$/.test(e)})),r.isNodeEnvironment=s,r.atob=je.memoize(s()?function(e){return o.default.from(e,"base64").toString("binary")}:function(e){return window.atob(e)}),r.btoa=je.memoize(s()?function(e){return o.default.from(e).toString("base64")}:function(e){return window.btoa(e)}),r.getArtworkFromURL=function(e){var t=e.split("/").pop(),r=i(!!t&&t.match(/\d+/g)||["100","100"],2),n=r[0],o=r[1];return{width:parseInt(n,10),height:parseInt(o,10),url:e.replace(n+"x"+o,"{w}x{h}")}},r.throttled=function(e,t){var r=0;return function(){var i=Date.now();if(!(i-r<e))return r=i,t.apply(this,Array.from(arguments))}},r.debounce=function(e,t,r){var i;return void 0===t&&(t=250),void 0===r&&(r={isImmediate:!1}),function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var a=this,s=r.isImmediate&&void 0===i;void 0!==i&&clearTimeout(i),i=setTimeout((function(){i=void 0,r.isImmediate||e.apply(a,n)}),t),s&&e.apply(a,n)}},r.exceptFields=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var i={};return Object.keys(e).forEach((function(r){t.includes(r)||(i[r]=e[r])})),i},r.arrayEquals=function(e,t){return!!e&&!!t&&[].every.call(e,(function(e,r){return e===t[r]}))},r.parseNumber=function(e){var t=Number(e);if(Number.isFinite(t))return t}}));r(xe),xe.isObject,xe.generateUUID,xe.isLibraryType,xe.isAdamId,xe.isNodeEnvironment,xe.atob,xe.btoa,xe.getArtworkFromURL,xe.throttled,xe.debounce,xe.exceptFields,xe.arrayEquals,xe.parseNumber;var Me=i((function(e,r){var i=t&&t.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e){if(this.token=e,!e||!/^[a-z0-9\-\_]{16,}\.[a-z0-9\-\_]{16,}\.[a-z0-9\-\_]{16,}/i.test(e))throw new Error("Invalid token.");var t=i(e.split("."),2),r=t[0],n=t[1],o=this._decode(n),a=o.exp,s=o.iss;if(this.expiration=1e3*a,this.isExpired)throw new Error("Initialized with an expired token.");this.teamId=s;var u=this._decode(r).kid;this.keyId=u}return Object.defineProperty(e.prototype,"isExpired",{get:function(){return this.expiration<Date.now()},enumerable:!0,configurable:!0}),e.prototype._decode=function(e){return JSON.parse(xe.atob(e))},e}();r.DeveloperToken=n}));r(Me),Me.DeveloperToken;var Be=i((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){var r=this;void 0===e&&(e=[]),this._eventRegistry={},e.forEach((function(e){r._eventRegistry[e]=[]})),t&&t.namespace&&(this.dispatchNamespace="com.apple."+t.namespace),this.shouldStorageDispatch&&(this._handleGlobalStorageEvent=this._handleGlobalStorageEvent.bind(this),window.addEventListener("storage",this._handleGlobalStorageEvent))}return Object.defineProperty(e.prototype,"shouldStorageDispatch",{get:function(){return"undefined"!=typeof window&&"undefined"!=typeof sessionStorage&&this.dispatchNamespace},enumerable:!0,configurable:!0}),e.prototype.addEventListener=function(e,t){Array.isArray(this._eventRegistry[e])&&this._eventRegistry[e].push(t)},e.prototype.dispatchEvent=function(e,t){Array.isArray(this._eventRegistry[e])&&this._eventRegistry[e].forEach((function(e){return e(t)}))},e.prototype.dispatchDistributedEvent=function(e,t){if(this.dispatchEvent(e,t),this.shouldStorageDispatch){var r=this.dispatchNamespace+":"+e;sessionStorage.setItem(r,JSON.stringify(t))}},e.prototype.removeEventListener=function(e,t){if(Array.isArray(this._eventRegistry[e])){var r=this._eventRegistry[e].indexOf(t);this._eventRegistry[e].splice(r,1)}},e.prototype._handleGlobalStorageEvent=function(e){var t;if(this.dispatchNamespace&&(null===(t=e.key)||void 0===t?void 0:t.startsWith(this.dispatchNamespace+":"))){var r=e.key.substring(this.dispatchNamespace.length+1);this.dispatchEvent(r,JSON.parse(e.newValue))}},e}();t.Notifications=r}));r(Be),Be.Notifications;var ze=i((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){void 0===e&&(e={}),this.data=e}return Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this.keys.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keys",{get:function(){return Object.keys(this.data)},enumerable:!0,configurable:!0}),e.prototype.getItem=function(e){return this.data[e]||null},e.prototype.setItem=function(e,t){this.data[e]=t},e.prototype.removeItem=function(e){delete this.data[e]},e.prototype.clear=function(){var e=this;this.keys.forEach((function(t){return e.removeItem(t)}))},e.prototype.key=function(e){return this.keys[e]||null},e}();function i(e,t,r,i,n,o){void 0===r&&(r=""),void 0===i&&(i=14);var a=new Date;n=null!=n?n:window;var s=(o=null!=o?o:/\./.test(n.location.hostname)?n.location.hostname:"").length>0?"domain="+o+"; ":"";a.setTime(a.getTime()+24*i*60*60*1e3),n.document.cookie=e+"="+t+"; expires="+a.toUTCString()+"; "+s+"path="+r}t.GenericStorage=r,t.getCookie=function(e,t){void 0===e&&(e=""),void 0===t&&(t=document.cookie);var r=t.match(new RegExp("(?:^|;\\s*)"+e+"=([^;]*)"));if(r)return r[1]},t.setCookie=i,t.removeCookie=function(e,t,r){i(e,"","/",0,t,r)}}));r(ze),ze.GenericStorage,ze.getCookie,ze.setCookie,ze.removeCookie;var qe=i((function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.APP="music",e.P="subscribe"}(r=t.Defaults||(t.Defaults={})),t.buildQueryParams=function(e){return void 0===e&&(e={app:r.APP,p:r.P}),e.app||(e.app=r.APP),e.p||(e.p=r.P),Object.keys(e).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])})).join("&")},t.parseQueryParams=function(e){return e?(-1!==e.indexOf("?")&&(e=e.substr(e.indexOf("?")).replace("?","")),e.split("&").reduce((function(e,t){var r=t.split("="),i=r[0],n=r[1];return e[i]=n?decodeURIComponent(n.replace(/\+/g," ")):"",e}),{})):{}}}));r(qe),qe.Defaults,qe.buildQueryParams;var Fe=qe.parseQueryParams,Ve=i((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.arrayBufferToString=je.memoize((function(e){for(var t=new Uint16Array(e),r=t.length,i="",n=0;n<r;n++)i+=String.fromCharCode(t[n]);return i})),t.base64ToUint8Array=je.memoize((function(e){var r=xe.atob(e);return t.stringToUint8Array(r)})),t.ensureArray=function(e){return void 0===e&&(e=[]),Array.isArray(e)?e:[e]},t.stringToHashCode=je.memoize((function(e){var t=0;if(0!==e.length)for(var r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return t})),t.stringToUint8Array=je.memoize((function(e){for(var t=e.length,r=new ArrayBuffer(t),i=new Uint8Array(r),n=0;n<t;n++)i[n]=e.charCodeAt(n);return i})),t.stringToUint16Array=je.memoize((function(e){for(var t=e.length,r=new ArrayBuffer(2*t),i=new Uint16Array(r),n=0;n<t;n++)i[n]=e.charCodeAt(n);return i})),t.uint8ArrayToBase64=je.memoize((function(e){for(var t,r,i,n,o,a,s,u=0,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="";u<e.length;)n=(t=e[u++])>>2,o=(3&t)<<4|(r=u<e.length?e[u++]:Number.NaN)>>4,a=(15&r)<<2|(i=u<e.length?e[u++]:Number.NaN)>>6,s=63&i,isNaN(r)?a=s=64:isNaN(i)&&(s=64),l+=c.charAt(n)+c.charAt(o)+c.charAt(a)+c.charAt(s);return l}))}));r(Ve),Ve.arrayBufferToString,Ve.base64ToUint8Array,Ve.ensureArray,Ve.stringToHashCode,Ve.stringToUint8Array,Ve.stringToUint16Array,Ve.uint8ArrayToBase64;var Ke=i((function(e,r){var i,n=t&&t.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{u(i.next(e))}catch(e){o(e)}}function s(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))},o=t&&t.__generator||function(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(r,"__esModule",{value:!0}),function(e){e[e.ParseError=-32700]="ParseError",e[e.InvalidRequest=-32600]="InvalidRequest",e[e.MethodNotFound=-32601]="MethodNotFound",e[e.InvalidParams=-32602]="InvalidParams",e[e.InternalError=-32603]="InternalError"}(i=r.RPCErrorCodes||(r.RPCErrorCodes={}));var a="2.0",s=function(){function e(e){var t=this;void 0===e&&(e={}),this._registry={},this._sequence=0,this.handle=function(e){e.data&&e.data.jsonrpc===a&&("*"!==t.origin&&t.origin!==e.origin||(e.data.method&&t.destination?t.handleRequest(e.data).then((function(e){t.send(t.destination,e)})):(e.data.hasOwnProperty("result")||e.data.error)&&t.handleResponse(e.data)))},this.destination=e.destination,this.methods=e.methods||{},this.origin=e.origin||"*",e.source&&(this.source=e.source)}return Object.defineProperty(e.prototype,"source",{get:function(){return this._source},set:function(e){if(!e&&this._source)return this._source.removeEventListener("message",this.handle),void(this._source=void 0);e.addEventListener("message",this.handle),this._source=e},enumerable:!0,configurable:!0}),e.prototype.apply=function(e,t){var r=this;if(!this.destination)throw new Error("No destination");var i=this._sequence++,n=new Promise((function(e,t){r._registry[i]={resolve:e,reject:t}}));return this.send(this.destination,{jsonrpc:a,id:i,method:e,params:t}),n},e.prototype.call=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return this.apply(e,t)},e.prototype.handleRequest=function(e){return n(this,void 0,void 0,(function(){var t,r,n,s;return o(this,(function(o){switch(o.label){case 0:if(t={jsonrpc:a,id:e.id},!(r=this.methods[e.method]))return[2,Object.assign(t,{error:{code:i.MethodNotFound,message:"Method not found"}})];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,r.apply(null,Ve.ensureArray(e.params))];case 2:return n=o.sent(),[2,Object.assign(t,{result:n})];case 3:return s=o.sent(),[2,Object.assign(t,{error:{code:s.code||i.InternalError,message:s.message}})];case 4:return[2]}}))}))},e.prototype.handleResponse=function(e){var t=this._registry[e.id];delete this._registry[e.id],t&&(e.error?t.reject(Object.assign(Error(),e.error)):t.resolve(e.result))},e.prototype.send=function(e,t){e.postMessage(t,e.window===e?this.origin:void 0)},e}();r.Dispatch=s}));r(Ke),Ke.RPCErrorCodes,Ke.Dispatch;var He=i((function(e,r){var i,n,o=t&&t.__assign||Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},a=t&&t.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{u(i.next(e))}catch(e){o(e)}}function s(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(a,s)}u((i=i.apply(e,t||[])).next())}))},s=t&&t.__generator||function(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function u(e){if("string"!=typeof e)return!1;var t=e.match(/[a-zA-Z0-9=\/+]{32,}==$/);return!(!t||!t.length)&&t.length>0}Object.defineProperty(r,"__esModule",{value:!0}),function(e){e[e.UNAVAILABLE=-1]="UNAVAILABLE",e[e.NOT_DETERMINED=0]="NOT_DETERMINED",e[e.DENIED=1]="DENIED",e[e.RESTRICTED=2]="RESTRICTED",e[e.AUTHORIZED=3]="AUTHORIZED"}(i=r.AuthorizationStatus||(r.AuthorizationStatus={})),r.validateToken=u,r.ACTIVATE_REQUEST_URL="https://activate.apple.com/mkauth",r.AUTHENTICATE_REQUEST_URL="https://buy.itunes.apple.com/commerce/account/authenticateMusicKitRequest",r.SERVICE_URL="https://authorize.music.apple.com",r.SUBSCRIBE_URL=r.SERVICE_URL+"/upsell",r.WHITELIST_DOMAIN_REGEX=/^https?:\/\/(.+\.)*(apple\.com|apps\.mzstatic\.com)(\/[\w\d]+)*$/,function(e){e[e.AUTHORIZE=0]="AUTHORIZE",e[e.SUBSCRIBE=1]="SUBSCRIBE"}(n=r.ServiceSetupAction||(r.ServiceSetupAction={}));var c=function(){function e(e,t){void 0===t&&(t={}),this.developerToken=e,this.authenticateMethod="GET",this.target="apple-music-service-view",this.deeplinkParameters=t&&t.deeplinkParameters||{},this.iconURL=t&&t.iconURL,this.authenticateMethod=t&&t.authenticateMethod||"GET",this.isServiceView&&window.opener!==window&&(this.dispatch=new Ke.Dispatch({destination:window.opener,origin:"*",source:window}))}return Object.defineProperty(e.prototype,"isServiceView",{get:function(){return window&&window.name===this.target||!1},enumerable:!0,configurable:!0}),e.prototype.focus=function(){this._window&&window.focus&&this._window.focus()},e.prototype.load=function(e){return void 0===e&&(e={action:n.AUTHORIZE}),a(this,void 0,void 0,(function(){return s(this,(function(t){return e.action===n.SUBSCRIBE?[2,this._subscribeAction(e.parameters)]:[2,this._authorizeAction(e.parameters)]}))}))},e.prototype.present=function(e,t){void 0===e&&(e="");var r=this._calculateClientDimensions(),i=r.height,n=r.left,a=r.top,s=r.width,u={height:650,menubar:"no",resizable:"no",scrollbars:"no",status:"no",toolbar:"no",width:650},c=o({},u,{left:s/2-u.width/2+n,top:i/2-u.height/2+a},t),l=Object.keys(c).map((function(e){return e+"="+c[e]})).join(",");return/trident|msie/i.test(navigator.userAgent)?(this._window=window.open(window.location.href,this.target,l)||void 0,this._window.location.href=e):this._window=window.open(e,this.target,l)||void 0,/\bedge\b/i.test(navigator.userAgent)&&(this._window.opener=self),this.focus(),this._window},e.prototype._authorizeAction=function(e){return void 0===e&&(e={}),a(this,void 0,void 0,(function(){var t,n,a,c=this;return s(this,(function(s){return a=window.location&&window.location.href||"","GET"===this.authenticateMethod?n=r.SERVICE_URL+"/woa?"+qe.buildQueryParams(o({},this.deeplinkParameters,{a:btoa(this._thirdPartyInfo()),referrer:a})):(t=this._buildFormElement(r.AUTHENTICATE_REQUEST_URL),document.body.appendChild(t)),[2,new Promise((function(o,a){var s=c.present(n);c.dispatch=new Ke.Dispatch({methods:{authorize:function(e,t,r){u(e)?o({restricted:t&&"1"===t,userToken:e,cid:r}):a(i.NOT_DETERMINED)},close:function(){},decline:function(){a(i.DENIED)},switchUserId:function(){a(i.NOT_DETERMINED)},thirdPartyInfo:function(){return c._thirdPartyInfo(c.developerToken,Object.assign(c.deeplinkParameters,e))},unavailable:function(){a(i.UNAVAILABLE)}},origin:r.SERVICE_URL,source:window,destination:s}),t&&t.submit()}))]}))}))},e.prototype._buildFormElement=function(e,t,r){void 0===t&&(t=this.target),void 0===r&&(r=this.developerToken);var i=document.createElement("form");i.setAttribute("method","post"),i.setAttribute("action",e),i.setAttribute("target",t),i.style.display="none";var n=document.createElement("input");n.setAttribute("name","jwtToken"),n.setAttribute("value",r),i.appendChild(n);var o=document.createElement("input");o.setAttribute("name","isWebPlayer"),o.setAttribute("value","true"),i.appendChild(o);var a=document.createElement("input");return a.setAttribute("name","LogoURL"),a.setAttribute("value",""),i.appendChild(a),i},e.prototype._calculateClientDimensions=function(e){return void 0===e&&(e=window),{height:e.innerHeight?e.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,left:e.screenLeft?e.screenLeft:screen.availLeft||screen.left,top:e.screenTop?e.screenTop:screen.availTop||screen.top,width:e.innerWidth?e.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width}},e.prototype._subscribeAction=function(e){return void 0===e&&(e={}),a(this,void 0,void 0,(function(){var t=this;return s(this,(function(i){return Object.assign(e,this.deeplinkParameters),[2,new Promise((function(i,n){var o=r.SUBSCRIBE_URL+"?"+qe.buildQueryParams(e);t.present(o),window.addEventListener("message",(function(e){var t=e.data,o=e.origin,a=(e.source,"string"==typeof t?JSON.parse(t):t),s=(a.closeWindow,a.launchClient);o&&!r.WHITELIST_DOMAIN_REGEX.test(o)||(s?0===s.supported?n("Unable to subscribe on this platform."):i(s):n("Subscribe action error."))}))}))]}))}))},e.prototype._thirdPartyInfo=function(e,t){void 0===e&&(e=this.developerToken);var r=this.iconURL,i=window.location.host||document.referrer,n=[].slice.call(document.querySelectorAll('link[rel="apple-music-app-icon"]')).concat([].slice.call(document.querySelectorAll('link[rel="apple-touch-icon-precomposed"]')),[].slice.call(document.querySelectorAll('link[rel="apple-touch-icon"]')));if(n&&n[0]&&n[0].href){var o=n.find((function(e){return!!e.sizes&&"120x120"===e.sizes.value}));r=o&&o.href?o.href:n[0].href}return JSON.stringify({thirdPartyIconURL:r,thirdPartyName:i,thirdPartyParameters:t,thirdPartyToken:e})},e}();r.ServiceSetupView=c}));r(He),He.AuthorizationStatus,He.validateToken,He.ACTIVATE_REQUEST_URL,He.AUTHENTICATE_REQUEST_URL,He.SERVICE_URL,He.SUBSCRIBE_URL,He.WHITELIST_DOMAIN_REGEX,He.ServiceSetupAction,He.ServiceSetupView;var We=i((function(e,r){var i=t&&t.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{u(i.next(e))}catch(e){o(e)}}function s(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(a,s)}u((i=i.apply(e,t||[])).next())}))},n=t&&t.__generator||function(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function o(e,t){return void 0===t&&(t="https://api.music.apple.com/v1"),i(this,void 0,void 0,(function(){var r,i;return n(this,(function(n){switch(n.label){case 0:return r=new Headers({Authorization:"Bearer "+e}),[4,fetch(t+"/storefronts",{headers:r})];case 1:return[4,n.sent().json()];case 2:return(i=n.sent()).errors?[2,Promise.reject(i.errors)]:[2,i.data]}}))}))}Object.defineProperty(r,"__esModule",{value:!0}),function(e){e.ID="us",e.LANGUAGE_TAG="en-gb"}(r.Defaults||(r.Defaults={})),r.fetchStorefronts=o;var a=function(){function e(e,t,r){this.id=e,this.attributes=t,this.type="storefronts",this.href=r||"/v1/"+this.type+"/"+e}return e.inferFromLanguages=function(e,t){return void 0===t&&(t=navigator.languages||[navigator.language||navigator.userLanguage]),i(this,void 0,void 0,(function(){var r,i,a,s,u,c;return n(this,(function(n){switch(n.label){case 0:return[4,o(e)];case 1:return r=n.sent(),i=r.map((function(e){return e.id})),a=t[0]||"en-US",(s=a.toLowerCase().split(/-|_/))[0],u=s[1],c=i.includes(u)?u:"us",[2,r.find((function(e){return e.id===c}))]}}))}))},e}();r.Storefront=a}));r(We);var Ye=We.Defaults,Ge=(We.fetchStorefronts,We.Storefront,i((function(e,r){var i,n,o=t&&t.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),a=t&&t.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{u(i.next(e))}catch(e){o(e)}}function s(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(a,s)}u((i=i.apply(e,t||[])).next())}))},s=t&&t.__generator||function(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.validateToken=He.validateToken,r.AuthorizationStatus=He.AuthorizationStatus,function(e){e.authorizationStatusDidChange="authorizationStatusDidChange",e.authorizationStatusWillChange="authorizationStatusWillChange",e.eligibleForSubscribeView="eligibleForSubscribeView",e.storefrontCountryCodeDidChange="storefrontCountryCodeDidChange",e.storefrontIdentifierDidChange="storefrontIdentifierDidChange",e.userTokenDidChange="userTokenDidChange"}(n=r.StoreKitNotifications||(r.StoreKitNotifications={}));var u=function(e){function t(t,r){var i=e.call(this,[n.authorizationStatusDidChange,n.authorizationStatusWillChange,n.eligibleForSubscribeView,n.storefrontCountryCodeDidChange,n.userTokenDidChange])||this;return i.developerToken=t,i.apiBase="https://api.music.apple.com/v1",i.persist="localstorage",i.playBase="https://play.itunes.apple.com/WebObjects/MZPlay.woa/wa",i.prefix="music",i.storage=window.localStorage,i._authorizationStatus=He.AuthorizationStatus.NOT_DETERMINED,i._dispatchedSubscribeView=!1,r&&(r.deeplink&&(i.deeplinkParameters=r.deeplink),r.persist&&(i.persist=r.persist),r.prefix&&(i.prefix=r.prefix)),i._developerToken=new Me.DeveloperToken(t),i._serviceSetupView=new He.ServiceSetupView(t,{authenticateMethod:r&&r.authenticateMethod,iconURL:r&&r.iconURL,deeplinkParameters:i.deeplinkParameters}),i.storagePrefix=(i.prefix+"."+i._developerToken.teamId).toLocaleLowerCase(),i.userTokenIsValid&&(i._restrictedEnabled=i.restrictedEnabled,i._authorizationStatus=i.restrictedEnabled?He.AuthorizationStatus.RESTRICTED:He.AuthorizationStatus.AUTHORIZED),i._storefrontCountryCode=i.storefrontCountryCode,xe.isNodeEnvironment()||i._processLocationHash(window.location.hash),i}return o(t,e),Object.defineProperty(t.prototype,"authorizationStatus",{get:function(){return this._authorizationStatus},set:function(e){this.dispatchEvent(n.authorizationStatusWillChange,{authorizationStatus:this._authorizationStatus,newAuthorizationStatus:e}),this._authorizationStatus=e,this.dispatchEvent(n.authorizationStatusDidChange,{authorizationStatus:e})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cid",{get:function(){if(!this._cid){var e=this._getStorageItem(this.storagePrefix+".c");this._cid=e||void 0}return this._cid},set:function(e){e?this._setStorageItem(this.storagePrefix+".c",e):this._removeStorageItem(this.storagePrefix+".c"),this._cid=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eligibleForSubscribeView",{get:function(){return!this.hasAuthorized&&!this._dispatchedSubscribeView},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasAuthorized",{get:function(){return this.authorizationStatus>He.AuthorizationStatus.DENIED},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"restrictedEnabled",{get:function(){if(this.userToken&&"boolean"!=typeof this._restrictedEnabled){var e=this._getStorageItem(this.userToken+".r");e?this._restrictedEnabled="0"!==e:this._storefrontCountryCode&&(this._restrictedEnabled=-1!==["br","ch","gt","hu","id","in","it","kr","la","lt","my","ru","sg","tr"].indexOf(this._storefrontCountryCode)||void 0)}return this._restrictedEnabled},set:function(e){this.userToken&&void 0!==e&&this._setStorageItem(this.userToken+".r",e?"1":"0"),this._restrictedEnabled=e,e&&(this.authorizationStatus=He.AuthorizationStatus.RESTRICTED)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"storefrontCountryCode",{get:function(){if(!this._storefrontCountryCode){var e=this._getStorageItem(this.userToken+".s");this._storefrontCountryCode=e||We.Defaults.ID}return this._storefrontCountryCode},set:function(e){e&&this.userToken?this._setStorageItem(this.userToken+".s",e):this._removeStorageItem(this.userToken+".s"),this._storefrontCountryCode=e,this.dispatchEvent(n.storefrontCountryCodeDidChange,{storefrontCountryCode:e})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"storefrontIdentifier",{get:function(){return this._storefrontIdentifier},set:function(e){this._storefrontIdentifier=e,this.dispatchEvent(n.storefrontIdentifierDidChange,{storefrontIdentifier:e})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userToken",{get:function(){if(!this._userToken){var e=this._getStorageItem(this.storagePrefix+".u");this._userToken=e||void 0}return this._userToken},set:function(e){e&&He.validateToken(e)?(this.authorizationStatus=this.restrictedEnabled?He.AuthorizationStatus.RESTRICTED:He.AuthorizationStatus.AUTHORIZED,this._setStorageItem(this.storagePrefix+".u",e)):(this.authorizationStatus=He.AuthorizationStatus.NOT_DETERMINED,this._removeStorageItem(this.storagePrefix+".u")),this._userToken=e,this.dispatchEvent(n.userTokenDidChange,{userToken:e})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userTokenIsValid",{get:function(){return He.validateToken(this.userToken)},enumerable:!0,configurable:!0}),t.prototype.deeplinkURL=function(e){return void 0===e&&(e={}),e=Object.assign(this.deeplinkParameters||{},e),"https://finance-app.itunes.apple.com/deeplink?"+qe.buildQueryParams(e)},t.prototype.itunesDeeplinkURL=function(e){return void 0===e&&(e={p:"browse"}),e=Object.assign(this.deeplinkParameters||{},e),"https://itunes.apple.com/deeplink?"+qe.buildQueryParams(e)},t.prototype.renewUserToken=function(){return a(this,void 0,void 0,(function(){var e,t,r;return s(this,(function(i){switch(i.label){case 0:return this.userToken?(e=new Headers({Authorization:"Bearer "+this.developerToken,Accept:"application/json","Content-Type":"application/json","X-Apple-Music-User-Token":""+this.userToken}),[4,fetch(this.playBase+"/renewMusicToken",{method:"POST",headers:e})]):[2,this.requestUserToken()];case 1:return 401!==(t=i.sent()).status?[3,3]:[4,this.revokeUserToken()];case 2:return i.sent(),[2,Promise.reject(new Error("Renew token"))];case 3:return[4,t.json()];case 4:return(r=i.sent())["music-token"]&&(this.userToken=r["music-token"]),[2,this.userToken]}}))}))},t.prototype.requestStorefrontCountryCode=function(){return a(this,void 0,void 0,(function(){var e,t,r,i;return s(this,(function(n){switch(n.label){case 0:return this.authorizationStatus<=He.AuthorizationStatus.DENIED?[2,Promise.reject("Not authorized: "+this.authorizationStatus)]:(e=new Headers({Authorization:"Bearer "+this.developerToken,"Music-User-Token":this.userToken}),[4,fetch(this.apiBase+"/me/storefront",{headers:e})]);case 1:return(t=n.sent()).ok?[4,t.json()]:(this._reset(),[2,Promise.reject("Storefront Country Code error.")]);case 2:return(r=n.sent()).errors?[2,Promise.reject(r.errors)]:(i=r.data[0])&&i.id?(this.storefrontCountryCode=i.id,[2,this.storefrontCountryCode]):[2,Promise.reject("Storefront Country Code error.")]}}))}))},t.prototype.requestStorefrontIdentifier=function(){return a(this,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return this.storefrontIdentifier?[3,2]:[4,We.Storefront.inferFromLanguages(this.developerToken)];case 1:e=t.sent(),this.storefrontIdentifier=e.id,t.label=2;case 2:return[2,this.storefrontIdentifier]}}))}))},t.prototype.requestUserToken=function(){return a(this,void 0,void 0,(function(){var e,t;return s(this,(function(r){switch(r.label){case 0:if(this._serviceSetupView.isServiceView)return[2,this.userToken];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this._serviceSetupView.load({action:He.ServiceSetupAction.AUTHORIZE})];case 2:return e=r.sent(),this.cid=e.cid,this.userToken=e.userToken,this.restrictedEnabled=e.restricted,[3,4];case 3:return t=r.sent(),this._reset(),this.authorizationStatus=t,[2,Promise.reject(t)];case 4:return[2,this.userToken]}}))}))},t.prototype.revokeUserToken=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this._webPlayerLogout()];case 1:case 2:return e.sent(),[3,3];case 3:return this.dispatchEvent(n.authorizationStatusWillChange,{authorizationStatus:this.authorizationStatus,newAuthorizationStatus:He.AuthorizationStatus.NOT_DETERMINED}),this._reset(),this.dispatchEvent(n.authorizationStatusDidChange,{authorizationStatus:this.authorizationStatus}),this.dispatchEvent(n.userTokenDidChange,{userToken:this._userToken}),[2]}}))}))},t.prototype.presentSubscribeView=function(e){return void 0===e&&(e=!0),a(this,void 0,void 0,(function(){var t;return s(this,(function(r){switch(r.label){case 0:if(this._serviceSetupView.isServiceView||!this.eligibleForSubscribeView)return[2];if(!e)return this.dispatchEvent(n.eligibleForSubscribeView),this._dispatchedSubscribeView=!0,[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this._serviceSetupView.load({action:He.ServiceSetupAction.SUBSCRIBE})];case 2:return t=r.sent(),this._dispatchedSubscribeView=!0,[2,t];case 3:return r.sent(),[2,this.revokeUserToken()];case 4:return[2]}}))}))},t.prototype.me=function(){return a(this,void 0,void 0,(function(){var e,t,r,i;return s(this,(function(n){switch(n.label){case 0:return this.authorizationStatus<=He.AuthorizationStatus.DENIED?[2,Promise.reject("Not authorized: "+this.authorizationStatus)]:(e=new Headers({Authorization:"Bearer "+this.developerToken,"Music-User-Token":this.userToken}),[4,fetch(this.apiBase+"/me/account?meta=subscription",{headers:e})]);case 1:return(t=n.sent()).ok?[4,t.json()]:(this._reset(),[2,Promise.reject("Account error.")]);case 2:return(r=n.sent()).errors?[2,Promise.reject(r.errors)]:(i=r.meta)&&i.subscription?(this.storefrontCountryCode=i.subscription.storefront,[2,i.subscription]):[2,Promise.reject("Account error.")]}}))}))},t.prototype._getStorageItem=function(e){if(e)return"cookie"===this.persist?ze.getCookie(btoa(e)):"localstorage"===this.persist?this.storage.getItem(e):void 0},t.prototype._processLocationHash=function(e){var t=/^\#([a-zA-Z0-9+\/]{200,}={0,2})$/;if(t.test(e)){var r=e.replace(t,"$1");try{var i=JSON.parse(atob(r)),n=i.itre,o=i.musicUserToken,a=i.cid;this.restrictedEnabled=n&&"1"===n,this.userToken=o,this.cid=a}catch(e){}history.replaceState(null,document.title," ")}},t.prototype._removeStorageItem=function(e){return"cookie"===this.persist?ze.setCookie(btoa(e),"","/",0):"localstorage"===this.persist?this.storage.removeItem(e):void 0},t.prototype._reset=function(e){void 0===e&&(e=He.AuthorizationStatus.NOT_DETERMINED),this._authorizationStatus=e,this._cid=void 0,this._dispatchedSubscribeView=!1,this._restrictedEnabled=void 0,this._storefrontCountryCode=void 0,this._removeStorageItem(this.storagePrefix+".c"),this._removeStorageItem(this._userToken+".r"),this._removeStorageItem(this.storagePrefix+".u"),this._removeStorageItem(this._userToken+".s"),this._userToken=void 0},t.prototype._setStorageItem=function(e,t){return"cookie"===this.persist?ze.setCookie(btoa(e),t,"/",180):"localstorage"===this.persist?this.storage.setItem(e,t):void 0},t.prototype._webPlayerLogout=function(){return a(this,void 0,void 0,(function(){var e,t;return s(this,(function(r){switch(r.label){case 0:return e=new Headers({Authorization:"Bearer "+this.developerToken,Accept:"application/json","Content-Type":"application/json","X-Apple-Music-User-Token":""+this.userToken}),[4,fetch(this.playBase+"/webPlayerLogout",{method:"POST",headers:e})];case 1:return(t=r.sent()).ok?[2,t.json()]:[2,Promise.reject(t.status)]}}))}))},t}(Be.Notifications);r.StoreKit=u})));r(Ge),Ge.validateToken;var Qe=Ge.AuthorizationStatus,Ze=Ge.StoreKitNotifications,Xe=Ge.StoreKit,Je={configured:"musickitconfigured",loaded:"musickitloaded",authorizationStatusDidChange:Ze.authorizationStatusDidChange,authorizationStatusWillChange:Ze.authorizationStatusWillChange,bufferedProgressDidChange:"bufferedProgressDidChange",eligibleForSubscribeView:Ze.eligibleForSubscribeView,mediaCanPlay:"mediaCanPlay",mediaItemDidChange:"mediaItemDidChange",mediaItemStateDidChange:"mediaItemStateDidChange",mediaItemStateWillChange:"mediaItemStateWillChange",mediaItemWillChange:"mediaItemWillChange",mediaPlaybackError:"mediaPlaybackError",mediaPlaybackPreview:"mediaPlaybackPreview",metadataDidChange:"metadataDidChange",playbackBitrateDidChange:"playbackBitrateDidChange",playbackDurationDidChange:"playbackDurationDidChange",playbackProgressDidChange:"playbackProgressDidChange",playbackStateDidChange:"playbackStateDidChange",playbackStateWillChange:"playbackStateWillChange",playbackTargetAvailableDidChange:"playbackTargetAvailableDidChange",playbackTimeDidChange:"playbackTimeDidChange",playbackVolumeDidChange:"playbackVolumeDidChange",primaryPlayerDidChange:"primaryPlayerDidChange",queueItemsDidChange:"queueItemsDidChange",queueItemForStartPosition:"queueItemForStartPosition",queuePositionDidChange:"queuePositionDidChange",storefrontCountryCodeDidChange:Ze.storefrontCountryCodeDidChange,storefrontIdentifierDidChange:Ze.storefrontIdentifierDidChange,userTokenDidChange:Ze.userTokenDidChange},$e=i((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){if(this.token=e,!e||!/^[a-z0-9\-\_]{16,}\.[a-z0-9\-\_]{16,}\.[a-z0-9\-\_]{16,}/i.test(e))throw new Error("Invalid token.");var t=e.split("."),r=t[0],i=t[1],n=this._decode(i),o=n.exp,a=n.iss;if(this.expiration=1e3*o,this.isExpired)throw new Error("Initialized with an expired token.");this.teamId=a;var s=this._decode(r).kid;this.keyId=s}return Object.defineProperty(e.prototype,"isExpired",{get:function(){return this.expiration<Date.now()},enumerable:!0,configurable:!0}),e.prototype._decode=function(e){return JSON.parse(window.atob(e))},e}();t.DeveloperToken=r}));r($e),$e.DeveloperToken;var et=i((function(e,r){var i,n=t&&t.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=t&&t.__assign||Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},a=t&&t.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{u(i.next(e))}catch(e){o(e)}}function s(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(a,s)}u((i=i.apply(e,t||[])).next())}))},s=t&&t.__generator||function(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function e(e,t,r){this.headers=new Headers,this.prefix="ï£¿",this.method="GET",this.url=e,this.storage=t||new de.GenericStorage,this.ttl=r||3e5}return e.prototype.request=function(e,t,r){return a(this,void 0,void 0,(function(){var i,n,a,u,c,l,h;return s(this,(function(s){switch(s.label){case 0:return r||"object"!=typeof e||(r=t||{},t=e,e=void 0),r=o({method:this.method,headers:this.headers},r),i=e?this.url+"/"+e:this.url,n=r.method,t&&"GET"===n&&(a=Object.keys(t).map((function(e){var r=t[e];return r.constructor===Object?Object.keys(r).map((function(t){return encodeURIComponent(e)+"["+encodeURIComponent(t)+"]="+encodeURIComponent(r[t])})).join("&"):encodeURIComponent(e)+"="+encodeURIComponent(t[e])})).join("&"),i=i+"?"+a),(u=this.getCacheItem(i))?[2,Promise.resolve(u)]:(!t||"POST"!==n&&"PUT"!==n||(r.body=JSON.stringify(t)),[4,fetch(i,r)]);case 1:return(c=s.sent()).ok?[4,c.json()]:[2,Promise.reject(c)];case 2:return(l=s.sent()).errors?[2,Promise.reject(l.errors)]:(h=l.results||l.data||l,this.setCacheItem(i,h),[2,h])}}))}))},e.prototype.clearCacheItems=function(){var e=this,t=this.storage.constructor===de.GenericStorage?this.storage._data:this.storage;Object.keys(t).filter((function(t){return new RegExp("^"+e.prefix).test(t)})).forEach((function(t){e.storage.removeItem(t)}))},e.prototype.getCacheItem=function(e){var t=this._key(e),r=this.storage.getItem(t);if(r){var i=JSON.parse(r),n=i.x,o=i.d;if(n>Date.now())return o;this.storage.removeItem(t)}},e.prototype.setCacheItem=function(e,t,r){void 0===r&&(r=this.ttl);var i=this._key(e);this.storage.removeItem(i),this.storage.setItem(i,JSON.stringify({x:Date.now()+r,d:t}))},e.prototype._key=function(e){var t=e.toLowerCase().replace(this.url,""),r=this.headers.get("Music-User-Token");return r&&(t=""+r.replace(/[^0-9a-z]{1,}/g,"")+t),""+this.prefix+t.replace(/[^-_0-9a-z]{1,}/g,".")},e}();r.URLSession=u;var c=function(e){function t(t,r,i,n){var o=e.call(this,t,n)||this;return o._developerToken=new $e.DeveloperToken(r),o.headers.append("Authorization","Bearer "+o.developerToken),o.userToken=i,o.userToken&&o.headers.append("Music-User-Token",o.userToken),o}return n(t,e),Object.defineProperty(t.prototype,"developerToken",{get:function(){return this._developerToken.token},enumerable:!0,configurable:!0}),t}(u);r.TokenSession=c}));r(et),et.URLSession;var tt=et.TokenSession,rt=i((function(e,t){function r(e,t){return t.split(".").reduce((function(e,t){if(void 0!==e)return e[t]}),e)}function i(e,t,r){return t.split(".").reduce((function(t,i,n,o){var a=n===o.length-1,s=t.hasOwnProperty(i),u=t[i]instanceof Object,c=null===t[i];if(!a&&s&&(!u||c))throw new TypeError("Value at "+o.slice(0,n+1).join(".")+" in keypath is not an Object.");return a?(t[i]=r,e):s?t[i]:t[i]={}}),e)}Object.defineProperty(t,"__esModule",{value:!0}),t.get=r,t.set=i,t.transform=function(e,t){return Object.keys(e).reduce((function(n,o){var a,s=e[o];return(a="function"==typeof s?s():r(t,s))&&i(n,o,a),n}),{})}}));r(rt);var it=rt.get,nt=(rt.set,rt.transform);function ot(e,t){if(void 0===t&&(t=25),e)return nt({limit:function(){return e.limit&&e.limit>t?t:e.limit},offset:"offset"},e)}var at=i((function(e,t){function r(e){for(var t=e.length,r=new ArrayBuffer(t),i=new Uint8Array(r),n=0;n<t;n++)i[n]=e.charCodeAt(n);return i}Object.defineProperty(t,"__esModule",{value:!0}),t.arrayBufferToString=function(e){for(var t=new Uint16Array(e),r=t.length,i="",n=0;n<r;n++)i+=String.fromCharCode(t[n]);return i},t.base64ToUint8Array=function(e){return r(window.atob(e))},t.ensureArray=function(e){return void 0===e&&(e=[]),Array.isArray(e)?e:[e]},t.stringToUint8Array=r,t.stringToUint16Array=function(e){for(var t=e.length,r=new ArrayBuffer(2*t),i=new Uint16Array(r),n=0;n<t;n++)i[n]=e.charCodeAt(n);return i},t.uint8ArrayToBase64=function(e){for(var t,r,i,n,o,a,s,u=0,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="";u<e.length;)n=(t=e[u++])>>2,o=(3&t)<<4|(r=u<e.length?e[u++]:Number.NaN)>>4,a=(15&r)<<2|(i=u<e.length?e[u++]:Number.NaN)>>6,s=63&i,isNaN(r)?a=s=64:isNaN(i)&&(s=64),l+=c.charAt(n)+c.charAt(o)+c.charAt(a)+c.charAt(s);return l}}));r(at);var st=at.arrayBufferToString,ut=at.base64ToUint8Array,ct=(at.ensureArray,at.stringToUint8Array,at.stringToUint16Array),lt=at.uint8ArrayToBase64,ht=i((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.type=e,this.id=t,this._attributes=[],this._relationships=[]}return e.prototype.hasAttributes=function(e){if(!e)return this._attributes.length>0;e=at.ensureArray(e);for(var t=!1,r=0;r<e.length&&(t=this._attributes.indexOf(e[r])>-1);r++);return t},e.prototype.serialize=function(e){var t=this;void 0===e&&(e=!0);var r={id:this.id,type:this.type};return this.hasAttributes()&&(r.attributes=this._attributes.reduce((function(e,r){return e[r]=t[r],e}),{})),this._relationships.length>0&&(r.relationships=this._relationships.reduce((function(e,r){var i=t[r];return Array.isArray(i)?e[r]={data:i.map((function(e){return"function"==typeof e.serialize?e.serialize(!1):e}))}:e[r]="function"==typeof i.serialize?i.serialize():i,e}),{})),e?{data:r}:r},e.prototype.setProperty=function(e,t,r){void 0===r&&(r="attributes"),this.hasOwnProperty(e)||this["_"+r].push(e),this[e]=t},e}();t.DataRecord=r;var i=function(){function e(e){this.mapping=e,this.clear()}return e.prototype.clear=function(){this._records={}},e.prototype.peek=function(e,t){var r=this;return"string"!=typeof t?!t&&this._records[e]?Object.values(this._records[e]):Array.isArray(t)&&this._records[e]?t.map((function(t){return r._records[e][t]})):[]:this._records[e]&&this._records[e][t]?this._records[e][t]:null},e.prototype.populateDataRecords=function(e,t,r){var i=this;return void 0===t&&(t={}),void 0===r&&(r=this.mapping),at.ensureArray(e.data).map((function(e){var n=i._materializeRecord(e.type,e.id,t);return r&&Object.assign(e,rt.transform(r,e)),e.attributes?(Object.keys(e.attributes).forEach((function(t){n.setProperty(t,e.attributes[t],"attributes")})),e.relationships&&Object.keys(e.relationships).forEach((function(o){if(e.relationships[o].data){var a=i.populateDataRecords(e.relationships[o],t,r);n.setProperty(o,a,"relationships")}})),n):n}))},e.prototype.save=function(e,t){return void 0===t&&(t=this.mapping),this.populateDataRecords(e,this._records,t)},e.prototype._materializeRecord=function(e,t,i){return i[e]=i[e]||{},i[e][t]=i[e][t]||new r(e,t),i[e][t]},e}();t.DataStore=i}));r(ht),ht.DataRecord;var pt,dt=ht.DataStore,ft=function(){function e(){this.enableDataStore=!!Re.features["api-data-store"],this.enableDataStore&&(this._store=new dt)}return Object.defineProperty(e.prototype,"hasDataStore",{get:function(){return this.enableDataStore&&void 0!==this._store},enumerable:!0,configurable:!0}),e.prototype.read=function(e,t,r){if(this.hasDataStore){var i=this._store.peek(e,t);if(i&&i.hasAttributes())return i}return r()},e.prototype.write=function(e){var t=this;return this._prepareDataForDataStore(e,(function(e){return t._store.save(e)}))},e.prototype.parse=function(e){var t=this;return this._prepareDataForDataStore(e,(function(e){return t._store.populateDataRecords(e,{})}))},e.prototype._prepareDataForDataStore=function(e,t){return this.hasDataStore?Array.isArray(e)?t({data:e}):Object.keys(e).reduce((function(r,i){var n=e[i];return n.hasOwnProperty("data")&&n.hasOwnProperty("href")&&(r[i]=t({data:n.data})),r}),{}):e},e}(),yt="me/library",bt=function(e){function t(t,r,i){var n=e.call(this,t,r,i)||this;return n._last=0,n._store=new ft,n}return Y(t,e),t.prototype.add=function(e){return G(this,void 0,void 0,(function(){var t,r,i,n;return Q(this,(function(o){switch(o.label){case 0:if((t=Date.now())-this._last<1e3)return[2,Promise.reject(new ne(ne.QUOTA_EXCEEDED))];r=new Headers({Authorization:"Bearer "+this.developerToken,"Music-User-Token":this.userToken}),i=Object.keys(e).map((function(t){return"ids["+t+"]="+e[t].join(",")})).join("&"),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,fetch(this.url+"/"+yt+"?"+i,{method:"POST",headers:r})];case 2:return o.sent(),this._last=t,[2,e];case 3:return n=o.sent(),[2,Promise.reject(ne.responseError(n))];case 4:return[2]}}))}))},t.prototype.album=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return[2,this.resource("albums",e,t)]}))}))},t.prototype.albumRelationship=function(e,t,r){return G(this,void 0,void 0,(function(){return Q(this,(function(i){return[2,this.collection("albums/"+e+"/"+t,void 0,r)]}))}))},t.prototype.albums=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return[2,this.collection("albums",e,t,!1)]}))}))},t.prototype.artist=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return[2,this.resource("artists",e,t)]}))}))},t.prototype.artistRelationship=function(e,t,r){return void 0===t&&(t="albums"),G(this,void 0,void 0,(function(){return Q(this,(function(i){return[2,this.collection("artists/"+e+"/"+t,void 0,r)]}))}))},t.prototype.artists=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return[2,this.collection("artists",e,t)]}))}))},t.prototype.musicVideo=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return[2,this.resource("music-videos",e,t)]}))}))},t.prototype.musicVideos=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return[2,this.collection("music-videos",e,t)]}))}))},t.prototype.playlist=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return t=Object.assign({include:"tracks"},t),[2,this.resource("playlists",e,t)]}))}))},t.prototype.playlistRelationship=function(e,t,r){return void 0===t&&(t="tracks"),G(this,void 0,void 0,(function(){return Q(this,(function(i){return[2,this.collection("playlists/"+e+"/"+t,void 0,r)]}))}))},t.prototype.playlists=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return[2,this.collection("playlists",e,t,!1)]}))}))},t.prototype.recentlyAdded=function(e){return G(this,void 0,void 0,(function(){return Q(this,(function(t){return[2,this.collection("recently-added",void 0,ot(e,10),!1)]}))}))},t.prototype.search=function(e,t){return G(this,void 0,void 0,(function(){var r;return Q(this,(function(i){return t=this._denormalizeLibraryTypes(t),r=Object.assign({term:e,types:"library-albums"},t),[2,this.collection("search",void 0,r,!1)]}))}))},t.prototype.song=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return[2,this.resource("songs",e,t)]}))}))},t.prototype.songs=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return[2,this.collection("songs",e,t)]}))}))},t.prototype.collection=function(e,t,r,i){return void 0===i&&(i=!0),G(this,void 0,void 0,(function(){var n,o,a;return Q(this,(function(s){switch(s.label){case 0:!t||t.length||r||(r=ot(t,100),t=void 0),o=t?Object.assign({ids:t.join(",")},r):r,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.request(yt+"/"+e,o)];case 2:return n=s.sent(),[3,4];case 3:return a=s.sent(),[2,Promise.reject(ne.responseError(a))];case 4:try{return[2,i?this._store.write(n):this._store.parse(n)]}catch(e){return[2,Promise.reject(ne.parseError(e))]}return[2]}}))}))},t.prototype.resource=function(e,t,r){return G(this,void 0,void 0,(function(){var i,n=this;return Q(this,(function(o){return[2,this._store.read(e,t,(function(){return G(n,void 0,void 0,(function(){var n;return Q(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.request(yt+"/"+e+"/"+t,r)];case 1:return i=o.sent(),[3,3];case 2:return n=o.sent(),[2,Promise.reject(ne.responseError(n))];case 3:try{return[2,this._store.write(i)[0]]}catch(e){return[2,Promise.reject(ne.parseError(e))]}return[2]}}))}))}))]}))}))},t.prototype._denormalizeLibraryTypes=function(e,t){void 0===e&&(e={}),void 0===t&&(t="types");var r=e[t];return r?("string"==typeof r&&(r=r.split(",")),e[t]=r.map((function(e){return e.replace(/^(albums|music-videos|playlists|songs)$/,"library-$1")})),e):e},t}(tt);function mt(e,t,r){return t=t||e.height||100,r=r||e.width||100,window.devicePixelRatio>=1.5&&(r*=2,t*=2),e.url.replace("{h}",""+t).replace("{w}",""+r).replace("{f}","jpeg")}!function(e){e[e.Global=0]="Global",e.Catalog="catalog",e.Personalized="me",e.Editorial="editorial"}(pt||(pt={}));var vt=["search/hints","recommendations"],gt=function(e){function t(t,r,i,n,o,a){var s=e.call(this,t,r,n,a)||this;return s.storefrontId=Ye.ID,s.enablePlayEquivalencies=!!Re.features.equivalencies,s.resourceRelatives={artists:{albums:{include:"tracks"},playlists:{include:"tracks"},songs:null}},s._store=new ft,i&&(s.storefrontId=i),n&&o&&(s.userStorefrontId=o),s.library=new bt(t,r,n),s}return Y(t,e),Object.defineProperty(t.prototype,"needsEquivalents",{get:function(){return this.userStorefrontId&&this.userStorefrontId!==this.storefrontId},enumerable:!0,configurable:!0}),t.prototype.activity=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return[2,this.resource(pt.Catalog,"activities",e,t)]}))}))},t.prototype.activities=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return[2,this.collection(pt.Catalog,"activities",e,t)]}))}))},t.prototype.album=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return t=this.equivalentParameters(t,"extend[songs]"),[2,this.resource(pt.Catalog,"albums",e,t)]}))}))},t.prototype.albumRelationship=function(e,t,r){return G(this,void 0,void 0,(function(){return Q(this,(function(i){return[2,this.collection(pt.Catalog,"albums/"+e+"/"+t,void 0,r)]}))}))},t.prototype.albums=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return t=this.equivalentParameters(t,"extend[songs]"),[2,this.collection(pt.Catalog,"albums",e,t)]}))}))},t.prototype.appleCurator=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return[2,this.resource(pt.Catalog,"apple-curators",e,t)]}))}))},t.prototype.appleCurators=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return[2,this.collection(pt.Catalog,"apple-curators",e,t)]}))}))},t.prototype.artist=function(e,t){return G(this,void 0,void 0,(function(){var r;return Q(this,(function(i){return!Re.features["api-artist-include"]&&t&&t.hasOwnProperty("include")&&this.resourceRelatives.artists.hasOwnProperty(t.include)?(r=t.include,delete t.include,t=Object.assign(t,this.resourceRelatives.artists[r]||{}),[2,this.collection(pt.Catalog,"artists/"+e+"/"+r,void 0,t)]):[2,this.resource(pt.Catalog,"artists",e,t)]}))}))},t.prototype.artistRelationship=function(e,t,r){return G(this,void 0,void 0,(function(){return Q(this,(function(i){return[2,this.collection(pt.Catalog,"artists/"+e+"/"+t,void 0,r)]}))}))},t.prototype.artists=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return[2,this.collection(pt.Catalog,"artists",e,t)]}))}))},t.prototype.charts=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return[2,this.collection(pt.Catalog,"charts",e,t)]}))}))},t.prototype.curator=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return[2,this.resource(pt.Catalog,"curators",e,t)]}))}))},t.prototype.curators=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return[2,this.collection(pt.Catalog,"curators",e,t)]}))}))},t.prototype.genre=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return[2,this.resource(pt.Catalog,"genres",e,t)]}))}))},t.prototype.genres=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return[2,this.collection(pt.Catalog,"genres",e,t)]}))}))},t.prototype.historyHeavyRotation=function(e){return G(this,void 0,void 0,(function(){return Q(this,(function(t){return[2,this.collection(pt.Personalized,"history/heavy-rotation",void 0,ot(e,10))]}))}))},t.prototype.musicVideo=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return t=this.equivalentParameters(t),[2,this.resource(pt.Catalog,"music-videos",e,t)]}))}))},t.prototype.musicVideos=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return t=this.equivalentParameters(t),[2,this.collection(pt.Catalog,"music-videos",e,t)]}))}))},t.prototype.playlist=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return[2,this.resource(pt.Catalog,"playlists",e,t)]}))}))},t.prototype.playlistRelationship=function(e,t,r){return G(this,void 0,void 0,(function(){return Q(this,(function(i){return[2,this.collection(pt.Catalog,"playlists/"+e+"/"+t,void 0,r)]}))}))},t.prototype.playlists=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return[2,this.collection(pt.Catalog,"playlists",e,t)]}))}))},t.prototype.recentPlayed=function(e){return G(this,void 0,void 0,(function(){return Q(this,(function(t){return[2,this.collection(pt.Personalized,"recent/played",void 0,ot(e,10))]}))}))},t.prototype.recommendation=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){switch(r.label){case 0:return[4,this.recommendations([e],t)];case 1:return[2,r.sent()[0]]}}))}))},t.prototype.recommendations=function(e,t){return G(this,void 0,void 0,(function(){var r;return Q(this,(function(i){switch(i.label){case 0:return[4,this.collection(pt.Personalized,"recommendations",e,t)];case 1:r=i.sent(),this._reindexRelationships(r,"recommendations");try{return[2,this._store.parse(r)]}catch(e){return[2,Promise.reject(ne.parseError(e))]}return[2]}}))}))},t.prototype.search=function(e,t){return G(this,void 0,void 0,(function(){var r;return Q(this,(function(i){return r=Object.assign({term:e},ot(t)),[2,this.collection(pt.Catalog,"search",void 0,r)]}))}))},t.prototype.searchHints=function(e,t){return G(this,void 0,void 0,(function(){var r;return Q(this,(function(i){return r=Object.assign({term:e},ot(t)),[2,this.collection(pt.Catalog,"search/hints",void 0,r)]}))}))},t.prototype.song=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return t=this.equivalentParameters(t),[2,this.resource(pt.Catalog,"songs",e,t)]}))}))},t.prototype.songs=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return!t&&e&&e.constructor===Object&&(t=e,e=void 0),t=this.equivalentParameters(t),[2,this.collection(pt.Catalog,"songs",e,t)]}))}))},t.prototype.station=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return[2,this.resource(pt.Catalog,"stations",e,t)]}))}))},t.prototype.stations=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return[2,this.collection(pt.Catalog,"stations",e,t)]}))}))},t.prototype.storefront=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return[2,this.resource(pt.Global,"storefronts",e,t)]}))}))},t.prototype.storefronts=function(e,t){return G(this,void 0,void 0,(function(){return Q(this,(function(r){return[2,this.collection(pt.Global,"storefronts",e,t)]}))}))},t.prototype.addToLibrary=function(e){return G(this,void 0,void 0,(function(){return Q(this,(function(t){return this.developerToken&&this.userToken&&this.library?[2,this.library.add(e)]:[2,Promise.reject("Invalid tokens")]}))}))},t.prototype.collection=function(e,t,r,i,n){return void 0===n&&(n=!0),G(this,void 0,void 0,(function(){var o,a,s,u,c,l;return Q(this,(function(h){switch(h.label){case 0:switch(r&&r.length?((u={})["charts"===t?"types":"ids"]=r.join(","),o=Object.assign(u,i)):o=i,e){case pt.Catalog:case pt.Editorial:c=this.storefrontId,this.needsEquivalents&&"playlists"===t&&(c=this.userStorefrontId),a=e+"/"+c+"/"+t;break;case pt.Global:a=t;break;case pt.Personalized:a=e+"/"+t,n=!1}h.label=1;case 1:return h.trys.push([1,3,,4]),[4,this.request(a,o)];case 2:return 0===(s=h.sent()).length?[2,Promise.reject(new ne(ne.CONTENT_UNAVAILABLE,"The requested content is not available."))]:void 0!==vt.find((function(e){return null!==a.match(e)}))?[2,s]:[3,4];case 3:return l=h.sent(),[2,Promise.reject(ne.responseError(l))];case 4:try{return[2,n?this._store.write(s):this._store.parse(s)]}catch(e){return[2,Promise.reject(ne.parseError(e))]}return[2]}}))}))},t.prototype.resource=function(e,t,r,i,n){return void 0===n&&(n=!0),G(this,void 0,void 0,(function(){var o=this;return Q(this,(function(a){return[2,this._store.read(t,r,(function(){return G(o,void 0,void 0,(function(){return Q(this,(function(o){switch(o.label){case 0:return[4,this.collection(e,t,[r],i,n)];case 1:return[2,o.sent()[0]]}}))}))}))]}))}))},t.prototype.equivalentParameters=function(e,t){if(void 0===e&&(e={}),void 0===t&&(t="extend"),!this.needsEquivalents||!this.userStorefrontId)return e;var r={equivalentStorefronts:this.userStorefrontId};return this.enablePlayEquivalencies?r[t]="equivalentPlayParams":r.include="equivalents",Object.assign(e,r)},t.prototype._reindexRelationships=function(e,t){e.forEach((function(e){e.hasOwnProperty("relationships")&&e.relationships.hasOwnProperty(t)&&e.relationships[t].hasOwnProperty("data")&&Array.isArray(e.relationships[t].data)&&e.relationships[t].data.forEach((function(e,t){e.id=e.id+"-"+t}))}))},t}(tt),_t=i((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){void 0===e&&(e=[]);var t=this;this._registry={},e.forEach((function(e){t._registry[e]=[]}))}return e.prototype.addEventListener=function(e,t){Array.isArray(this._registry[e])&&this._registry[e].push(t)},e.prototype.dispatchEvent=function(e,t){Array.isArray(this._registry[e])&&this._registry[e].forEach((function(e){return e(t)}))},e.prototype.removeEventListener=function(e,t){if(Array.isArray(this._registry[e])){var r=this._registry[e].indexOf(t);this._registry[e].splice(r,1)}},e}();t.Notifications=r}));r(_t);var Pt,kt,Et=_t.Notifications;!function(e){e[e.STANDARD=64]="STANDARD",e[e.HIGH=256]="HIGH"}(e.PlaybackBitrate||(e.PlaybackBitrate={})),function(e){e[e.DEFAULT=0]="DEFAULT",e[e.PREVIEW_ONLY=1]="PREVIEW_ONLY"}(Pt||(Pt={})),function(e){e[e.ACCURATE=0]="ACCURATE",e[e.ROUND=1]="ROUND"}(kt||(kt={})),function(e){e[e.none=0]="none",e[e.loading=1]="loading",e[e.playing=2]="playing",e[e.paused=3]="paused",e[e.stopped=4]="stopped",e[e.ended=5]="ended",e[e.seeking=6]="seeking",e[e.waiting=8]="waiting",e[e.stalled=9]="stalled",e[e.completed=10]="completed"}(e.PlaybackStates||(e.PlaybackStates={}));var wt,Tt=Je.playbackBitrateDidChange,It=Je.playbackStateDidChange,At=Je.playbackStateWillChange,St=Je.playbackTargetAvailableDidChange,Ct=function(t){function r(r){void 0===r&&(r=[]);var i=t.call(this,[Tt,It,At,St].concat(r))||this;return i._bitrate=e.PlaybackBitrate.STANDARD,i._playbackState=e.PlaybackStates.none,i._timingAccuracy=kt.ROUND,i._downlinkSamples=[],i._playbackTargetAvailable=!1,i._mode=Pt.DEFAULT,i}return Y(r,t),Object.defineProperty(r.prototype,"bitrate",{get:function(){return this._bitrate},set:function(e){this._bitrate!==e&&(this._bitrate=e,this.dispatchEvent(Tt,{bitrate:e}))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"medianDownlink",{get:function(){return this._downlinkSamples.reduce((function(e,t){return e+t}),0)/this._downlinkSamples.length||0},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"playbackState",{get:function(){return this._playbackState},set:function(e){var t={oldState:this._playbackState,state:e};this.dispatchEvent(At,t),this._playbackState=e,this.dispatchEvent(It,t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"playbackTargetAvailable",{get:function(){return window.WebKitPlaybackTargetAvailabilityEvent&&this._playbackTargetAvailable},set:function(e){this._playbackTargetAvailable=e,this.dispatchEvent(St,{available:e})},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"previewOnly",{get:function(){return this._mode===Pt.PREVIEW_ONLY},set:function(e){this._mode=e?Pt.PREVIEW_ONLY:Pt.DEFAULT},enumerable:!0,configurable:!0}),r.prototype.timing=function(e){return void 0===e&&(e=0),this._timingAccuracy===kt.ROUND?Math.round(e):e},r.prototype.recalculateBitrate=function(t){this._downlinkSamples.push(t),this.medianDownlink&&this.medianDownlink>=65?this.bitrate=e.PlaybackBitrate.HIGH:this.bitrate=e.PlaybackBitrate.STANDARD},r}(Et);!function(e){e[e.none=0]="none",e[e.loading=1]="loading",e[e.ready=2]="ready",e[e.playing=3]="playing",e[e.ended=4]="ended",e[e.unavailable=5]="unavailable",e[e.restricted=6]="restricted",e[e.error=7]="error"}(wt||(wt={}));var Ot=Je.mediaItemStateDidChange,Dt=Je.mediaItemStateWillChange,Rt=function(e){function t(t){void 0===t&&(t={});var r=e.call(this,[Ot,Dt])||this;return r._assets=[],r._isPlayable=!0,r._state=wt.none,t.id&&t.attributes?(Object.assign(r,t),r.type=r.playParams&&r.playParams.kind?r.playParams.kind:r.type||"song"):(r.id=t.id||pe(),r.type=t.type||"song",r.attributes={playParams:{id:r.id,kind:r.type}}),r._isPlayable=-1!==Re.supportedMediaTypes.indexOf(r.type),t.container?r._container=t.container:t.containerId&&t.containerType&&(r._container={id:t.containerId,type:t.containerType}),r}return Y(t,e),Object.defineProperty(t.prototype,"albumInfo",{get:function(){return this.artistName+" - "+this.albumName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"albumName",{get:function(){return this.attributes.albumName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"artistName",{get:function(){return this.attributes.artistName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"artwork",{get:function(){return this.attributes.artwork},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"artworkURL",{get:function(){if(this.artwork&&this.artwork.url)return this.artwork.url},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"assets",{get:function(){return this._assets},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canPlay",{get:function(){return this.isPlayable&&this.isReady},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"container",{get:function(){return this._container},set:function(e){this._container=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentRating",{get:function(){return this.attributes.contentRating},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"discNumber",{get:function(){return this.attributes.discNumber},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"equivalent",{get:function(){return this._equivalent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasContainerArtwork",{get:function(){return this.container&&this.container.attributes&&this.container.attributes.artwork&&this.container.attributes.artwork.url},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasPlaylistContainer",{get:function(){return this.container&&"playlists"===this.container.type&&this.container.attributes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"info",{get:function(){return this.title+" - "+this.albumInfo},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isCloudItem",{get:function(){return ce(this.id)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isCloudUpload",{get:function(){return-1===this._songId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isExplicitItem",{get:function(){return this.contentRating===Oe},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLoading",{get:function(){return this.state===wt.loading},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPlayable",{get:function(){return"song"===this.type?this._isPlayable&&(this.playParams||this.previewURL):this._isPlayable&&!!this.attributes.assetUrl},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPlaying",{get:function(){return this.state===wt.playing},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPreparedToPlay",{get:function(){return"song"===this.type?!!this._assets&&!!this.keyURLs&&!!this._songId:!!this.assetURL||this.playRawAssetURL&&!!this.attributes.assetUrl},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isrc",{get:function(){return this.attributes.isrc},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isReady",{get:function(){return this.state===wt.ready},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isRestricted",{get:function(){return this.state===wt.restricted},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isUnavailable",{get:function(){return this.state===wt.unavailable},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"playbackData",{set:function(e){var t;void 0!==e&&(this.previewURL&&(e.previewURL=this.previewURL),Object.assign(this,nt({"attributes.albumName":"metadata.playlistName","attributes.artistName":"metadata.artistName","attributes.artwork.url":"artworkURL","attributes.composerName":"metadata.composerName","attributes.contentRating":function(){if(1===it(t,"metadata.explicit"))return Oe},"attributes.discNumber":function(){return it(t,"metadata.discNumber")||1},"attributes.durationInMillis":"metadata.duration","attributes.genreNames":function(){return[it(t,"metadata.genre")]},"attributes.isrc":function(){var e=it(t,"metadata.xid");if(e)return e.replace(/^([^:]+):isrc:/,"$1")},"attributes.name":"metadata.itemName","attributes.playParams.id":"metadata.itemId","attributes.playParams.kind":"metadata.kind","attributes.previews":function(){return[{url:it(t,"previewURL")}]},"attributes.releaseDate":"metadata.releaseDate","attributes.trackNumber":"metadata.trackNumber",assetURL:"URL",cloudId:"metadata.cloud-id",id:function(){return""+it(t,"metadata.itemId")},flavor:"flavor",type:"metadata.kind"},t=e)),this.state=wt.ready)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"playbackDuration",{get:function(){return this.attributes.durationInMillis||this.attributes.durationInMilliseconds},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"playlistArtworkURL",{get:function(){return this.hasPlaylistContainer&&this.hasContainerArtwork?this.container.attributes.artwork.url:this.artworkURL},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"playlistName",{get:function(){return this.hasPlaylistContainer?this.container.attributes.name:this.albumName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"playParams",{get:function(){return this.attributes.playParams},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"playRawAssetURL",{get:function(){return this.isCloudUpload||"podcast-episodes"===this.type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"previewURL",{get:function(){return it(this,"attributes.previews.0.url")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"releaseDate",{get:function(){if(this._releaseDate)return this._releaseDate;if(this.attributes&&(this.attributes.releaseDate||this.attributes.releaseDateTime)){var e=this.attributes.releaseDate||this.attributes.releaseDateTime;return this._releaseDate=/^\d{4}-\d{1,2}-\d{1,2}/.test(e)?new Date(e):void 0,this._releaseDate}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"songId",{get:function(){return this._songId&&-1!==this._songId?this._songId:this.id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},set:function(e){var t={oldState:this._state,state:e};this._stateWillChange&&this._stateWillChange(this),this.dispatchEvent(Dt,t),this._state=e,this._stateDidChange&&this._stateDidChange(this),this.dispatchEvent(Ot,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"title",{get:function(){return this.attributes.name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trackNumber",{get:function(){return this.attributes.trackNumber},enumerable:!0,configurable:!0}),t.prototype.beginMonitoringStateDidChange=function(e){this._stateDidChange=e},t.prototype.beginMonitoringStateWillChange=function(e){this._stateWillChange=e},t.prototype.endMonitoringStateDidChange=function(){this._stateDidChange=void 0},t.prototype.endMonitoringStateWillChange=function(){this._stateWillChange=void 0},t.prototype.isEqual=function(e){return this.id===e.id&&this.type===e.type&&this.attributes===e.attributes},t.prototype.prepareToPlay=function(e,t,r){return G(this,void 0,void 0,(function(){var i,n,o,a,s,u,c,l;return Q(this,(function(h){switch(h.label){case 0:return e||t?this.isPreparedToPlay?[2]:(this.state=wt.loading,"podcast-episodes"===this.type?(this.assetURL=this.attributes.assetUrl,[2]):[4,this._handleStorefrontEquivalency(r)]):[2,Promise.reject(new ne(ne.AUTHORIZATION_ERROR,"Unable to prepare media item for play."))];case 1:return h.sent(),i=this.playParams.id,n=new Headers({Authorization:"Bearer "+e,Accept:"application/json","Content-Type":"application/json","X-Apple-Music-User-Token":""+t}),o={salableAdamId:i},this.isCloudItem&&(o=(a=/^a\.(\d+)$/).test(this.id)?{subscriptionAdamId:parseInt(i.replace(a,"$1"),10),isLibrary:!0}:{universalLibraryId:i,isLibrary:!0}),[4,fetch(Re.urls.play,{method:"POST",body:JSON.stringify(o),headers:n})];case 2:return[4,h.sent().text()];case 3:if(s=h.sent(),!(u=JSON.parse(s))||!u.songList){switch((c=ne.serverError(u)).errorCode){case ne.CONTENT_RESTRICTED:this.state=wt.restricted;break;case ne.CONTENT_UNAVAILABLE:this.state=wt.unavailable;break;default:this.state=wt.error}return[2,Promise.reject(c)]}return l=u.songList[0],this._songId=l.songId,this._assets=l.assets,this.keyURLs={"hls-key-cert-url":l["hls-key-cert-url"],"hls-key-server-url":l["hls-key-server-url"],"widevine-cert-url":l["widevine-cert-url"]},[2]}}))}))},t.prototype.restrict=function(){this.isExplicitItem&&(this.state=wt.restricted,this._isPlayable=!1,this.playParams&&delete this.attributes.playParams)},t.prototype._handleStorefrontEquivalency=function(e){return G(this,void 0,void 0,(function(){var t,r;return Q(this,(function(i){return e?(this.attributes.equivalents?(t=this.attributes.equivalents[e].equivalentPlayParams)&&(this.attributes.playParams=t):this.relationships&&this.relationships.equivalents&&this.relationships.equivalents.data&&this.relationships.equivalents.data.length&&(r=this.relationships.equivalents.data[0]).id!==this.id&&(this._equivalent=r),[2]):[2]}))}))},t}(Et);function Lt(e){return e&&void 0!==e._attributes&&"function"==typeof e.serialize}function Nt(e){return e&&void 0!==e.id}function Ut(e){return e&&void 0!==e.id&&void 0!==e.type}var jt=Je.queueItemsDidChange,xt=Je.queuePositionDidChange,Mt=function(e){function t(t){var r=e.call(this,[jt,xt])||this;if(r._itemIDs=[],r._unshuffledIDs={},r._items=[],r._isRestricted=!1,r._position=-1,!t)return r;r._items=r._descriptorToMediaItems(t);var i=parseInt(""+t.startPosition,10);return isNaN(i)||(r._position=i),r._reindex(),r._itemIDs.forEach((function(e,t){r._unshuffledIDs[e]=t})),r}return Y(t,e),Object.defineProperty(t.prototype,"isEmpty",{get:function(){return 0===this.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isRestricted",{get:function(){return this._isRestricted},set:function(e){this._isRestricted=e,this._isRestricted&&this._items&&(this._items=this._items.map((function(e){return e.restrict(),e})))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){return this._items},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this._items.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nextPlayableItem",{get:function(){if(void 0!==this.nextPlayableItemIndex)return this.item(this.nextPlayableItemIndex)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nextPlayableItemIndex",{get:function(){if(void 0===this._nextPlayableItemIndex)for(var e=this.position+1;e<this.length;){var t=this.item(e);if(t&&t.isPlayable){this._nextPlayableItemIndex=e;break}e++}return this._nextPlayableItemIndex},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this._position},set:function(e){if(e!==this._position){var t={oldPosition:this._position,position:e};this._nextPlayableItemIndex=void 0,this._previousPlayableItemIndex=void 0,this._position=e,this.dispatchEvent(xt,t)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"previousPlayableItem",{get:function(){if(void 0!==this.previousPlayableItemIndex)return this.item(this.previousPlayableItemIndex)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"previousPlayableItemIndex",{get:function(){if(void 0===this._previousPlayableItemIndex)for(var e=this.position-1;e>-1;){var t=this.item(e);if(t&&t.isPlayable){this._previousPlayableItemIndex=e;break}e--}return this._previousPlayableItemIndex},enumerable:!0,configurable:!0}),t.prototype.append=function(e){var t,r,i=this._descriptorToMediaItems(e);(t=this._items).push.apply(t,i),(r=this._itemIDs).push.apply(r,i.map((function(e){return e.id}))),this.dispatchEvent(jt,this._items)},t.prototype.indexForItem=function(e){return(Nt(e)?this._items:this._itemIDs).indexOf(e)},t.prototype.item=function(e){return this._items&&this._items[e]},t.prototype.prepend=function(e,t){var r,i;void 0===t&&(t=!1);var n=this._descriptorToMediaItems(e),o=(this.position<0?0:this.position)+1;t&&(this._items.length=o,this._itemIDs.length=o),(r=this._items).splice.apply(r,[o,0].concat(n)),(i=this._itemIDs).splice.apply(i,[o,0].concat(n.map((function(e){return e.id})))),this.dispatchEvent(jt,this._items)},t.prototype.remove=function(e){if(e===this.position)throw new ne(ne.INVALID_ARGUMENTS);this._items.splice(e,1),this._itemIDs.splice(e,1),this.dispatchEvent(jt,this._items)},t.prototype.shuffle=function(e){void 0===e&&(e=!0);for(var t=this.length;t--;){var r=Math.floor(t*Math.random()),i=this._items[r];this._items[r]=this._items[t],this._items[t]=i}this._handleQueueReorder(e)},t.prototype.unshuffle=function(e){var t=this;void 0===e&&(e=!0);var r=[];this._items.forEach((function(e){var i=t._unshuffledIDs[e.id];r[i]=e})),this._items=r,this._handleQueueReorder(e)},t.prototype.requiresPlayActivity=function(){return this.items.some((function(e){return Te(e)}))},t.prototype._dataRecordToMediaItems=function(e){var t=e.serialize().data;return this._resourceToMediaItem(t)},t.prototype._descriptorToMediaItems=function(e){var t=this,r=[],i=e.loaded||e;if(void 0===i)return r;if(Array.isArray(i))return Lt(n=i[0])?i.forEach((function(e){r.push.apply(r,t._dataRecordToMediaItems(e))})):Ut(n)&&i.forEach((function(e){r.push.apply(r,t._resourceToMediaItem(e))})),r;if(function(e){return e&&e.items&&Array.isArray(e.items)}(i)){var n,o=i.items;return function(e){return e&&void 0!==e.contentId&&void 0!==e.metadata&&void 0!==e.metadata.itemId&&void 0!==e.metadata.itemType}(n=o[0])?r=o.map((function(e){return new Rt(function(e){var t=nt({id:"metadata.itemId",type:"metadata.itemType","attributes.contentRating":function(){if(1===it(e,"metadata.isExplicit"))return Oe},"attributes.playParams":function(){return 0!==it(e,"metadata.isPlayable")&&{id:it(e,"metadata.itemId"),kind:it(e,"metadata.itemType")}},"container.id":"metadata.containerId","container.name":"metadata.containerName","container.type":"metadata.containerType"},e);return Object.assign({attributes:{}},t)}(e))})):Nt(n)&&(r=o.map((function(e){return new Rt(e)}))),r}return Lt(i)?r=this._dataRecordToMediaItems(i):Ut(i)&&(r=this._resourceToMediaItem(i)),r},t.prototype._handleQueueReorder=function(e){this._reindex(),e&&this.dispatchEvent(jt,this._items)},t.prototype._reindex=function(){this._items&&(this._itemIDs=this._items.map((function(e){return e.id})))},t.prototype._resourceToMediaItem=function(e){if(e.relationships&&e.relationships.tracks&&e.relationships.tracks.data){var t,r=(void 0===(n=e.relationships.tracks.data)&&(n=[]),0!==n.length&&n.filter((function(e){var t=e.attributes;return!!t&&(t.workName||t.movementName||t.movementCount||t.movementNumber)})).length>0);return"albums"===e.type||"library-albums"===e.type?t=r?fe.ALBUM_CLASSICAL:fe.ALBUM:"playlists"!==e.type&&"library-playlists"!==e.type||(t=r?fe.PLAYLIST_CLASSICAL:fe.PLAYLIST),t&&(t=Re.prefix?Re.prefix+":"+t:t),e.relationships.tracks.data.map((function(r){return new Rt({attributes:r.attributes,id:r.id,container:{attributes:e.attributes,id:e.id,type:e.type,name:t||void 0}})}))}if("songs"===e.type||"library-songs"===e.type){var i=e.container&&e.container.name?e.container.name:fe.SONG;return[new Rt({relationships:e.relationships,attributes:e.attributes,id:e.id,container:{id:e.id,name:Re.prefix?Re.prefix+":"+i:i}})]}var n;return[]},t}(Et),Bt=function(e,t){return(Bt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};var zt=function(){return(zt=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function qt(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{u(i.next(e))}catch(e){o(e)}}function s(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(a,s)}u((i=i.apply(e,t||[])).next())}))}function Ft(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var Vt="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Kt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Ht(e,t){return e(t={exports:{}},t.exports),t.exports}var Wt=Ht((function(e,t){function r(){return Math.random().toString(16).substring(2)}function i(){return"undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node}function n(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var i="",n=t.length;n--;){var o=t[n];i+=o===Object(o)?JSON.stringify(o):o,e._memoized||(e._memoized={})}return i in e._memoized?e._memoized[i]:e._memoized[i]=e.apply(void 0,t)}}Object.defineProperty(t,"__esModule",{value:!0}),t.generateUUID=function(){for(var e=r()+r();e.length<16;)e+=r();return e.slice(0,16)},t.isLibraryType=n((function(e){return/^(?:[a|i|l|p]{1}\.|pl\.u\-)[a-zA-Z0-9]+$/.test(e)})),t.isNodeEnvironment=i,t.atob=n((function(e){return i()?Buffer.from(e,"base64").toString("ascii"):window.atob(e)})),t.btoa=n((function(e){return i()?Buffer.from(e).toString("base64"):window.btoa(e)})),t.memoize=n,t.urlEncodeParameters=function(e){var t="";return e&&Object.keys(e).map((function(r,i,n){t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]),i<n.length-1&&(t+="&")})),t}}));Kt(Wt),Wt.generateUUID,Wt.isLibraryType;var Yt=Wt.isNodeEnvironment,Gt=(Wt.atob,Wt.btoa,Wt.memoize,Wt.urlEncodeParameters,Ht((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){if(this.token=e,!e||!/^[a-z0-9\-\_]{16,}\.[a-z0-9\-\_]{16,}\.[a-z0-9\-\_]{16,}/i.test(e))throw new Error("Invalid token.");var t=e.split("."),r=t[0],i=t[1],n=this._decode(i),o=n.exp,a=n.iss;if(this.expiration=1e3*o,this.isExpired)throw new Error("Initialized with an expired token.");this.teamId=a;var s=this._decode(r).kid;this.keyId=s}return Object.defineProperty(e.prototype,"isExpired",{get:function(){return this.expiration<Date.now()},enumerable:!0,configurable:!0}),e.prototype._decode=function(e){return JSON.parse(Wt.atob(e))},e}();t.DeveloperToken=r})));Kt(Gt);var Qt=Gt.DeveloperToken,Zt=Ht((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){var t=this;void 0===e&&(e=[]),this._registry={},e.forEach((function(e){t._registry[e]=[]}))}return e.prototype.addEventListener=function(e,t){Array.isArray(this._registry[e])&&this._registry[e].push(t)},e.prototype.dispatchEvent=function(e,t){Array.isArray(this._registry[e])&&this._registry[e].forEach((function(e){return e(t)}))},e.prototype.removeEventListener=function(e,t){if(Array.isArray(this._registry[e])){var r=this._registry[e].indexOf(t);this._registry[e].splice(r,1)}},e}();t.Notifications=r}));Kt(Zt);var Xt=Zt.Notifications,Jt=Ht((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._data={}}return e.prototype.clear=function(){this._data={}},e.prototype.getItem=function(e){return this._data[e]},e.prototype.removeItem=function(e){delete this._data[e]},e.prototype.setItem=function(e,t){this._data[e]=t},e}();t.GenericStorage=r,t.getCookie=function(e){void 0===e&&(e="");var t=document.cookie.match(new RegExp("(?:^|;\\s*)"+e+"=([^;]*)"));if(t)return t[1]},t.setCookie=function(e,t,r,i,n){void 0===r&&(r=""),void 0===i&&(i=14),void 0===n&&(n=window);var o=new Date,a=/\./.test(n.location.hostname)?n.location.hostname:"";/^(?:[a-z\-]+\.)?(?:music|itunes)\.apple\.com$/i.test(a)&&(a="apple.com");var s=a.length>0?"domain="+a+"; ":"";o.setTime(o.getTime()+24*i*60*60*1e3),n.document.cookie=e+"="+t+"; expires="+o.toUTCString()+"; "+s+"path="+r}}));Kt(Jt),Jt.GenericStorage;var $t,er=Jt.getCookie,tr=Jt.setCookie;function rr(e){return void 0===e&&(e={app:$t.APP,p:$t.P}),e.app||(e.app=$t.APP),e.p||(e.p=$t.P),Object.keys(e).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])})).join("&")}!function(e){e.APP="music",e.P="subscribe"}($t||($t={}));var ir=Ht((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.arrayBufferToString=Wt.memoize((function(e){for(var t=new Uint16Array(e),r=t.length,i="",n=0;n<r;n++)i+=String.fromCharCode(t[n]);return i})),t.base64ToUint8Array=Wt.memoize((function(e){var r=Wt.atob(e);return t.stringToUint8Array(r)})),t.ensureArray=function(e){return void 0===e&&(e=[]),Array.isArray(e)?e:[e]},t.stringToUint8Array=Wt.memoize((function(e){for(var t=e.length,r=new ArrayBuffer(t),i=new Uint8Array(r),n=0;n<t;n++)i[n]=e.charCodeAt(n);return i})),t.stringToUint16Array=Wt.memoize((function(e){for(var t=e.length,r=new ArrayBuffer(2*t),i=new Uint16Array(r),n=0;n<t;n++)i[n]=e.charCodeAt(n);return i})),t.uint8ArrayToBase64=Wt.memoize((function(e){for(var t,r,i,n,o,a,s,u=0,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="";u<e.length;)n=(t=e[u++])>>2,o=(3&t)<<4|(r=u<e.length?e[u++]:Number.NaN)>>4,a=(15&r)<<2|(i=u<e.length?e[u++]:Number.NaN)>>6,s=63&i,isNaN(r)?a=s=64:isNaN(i)&&(s=64),l+=c.charAt(n)+c.charAt(o)+c.charAt(a)+c.charAt(s);return l}))}));Kt(ir),ir.arrayBufferToString,ir.base64ToUint8Array,ir.ensureArray,ir.stringToUint8Array,ir.stringToUint16Array,ir.uint8ArrayToBase64;var nr=Ht((function(e,t){var r,i=Vt&&Vt.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{u(i.next(e))}catch(e){o(e)}}function s(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(a,s)}u((i=i.apply(e,t||[])).next())}))},n=Vt&&Vt.__generator||function(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.ParseError=-32700]="ParseError",e[e.InvalidRequest=-32600]="InvalidRequest",e[e.MethodNotFound=-32601]="MethodNotFound",e[e.InvalidParams=-32602]="InvalidParams",e[e.InternalError=-32603]="InternalError"}(r=t.RPCErrorCodes||(t.RPCErrorCodes={}));var o="2.0",a=function(){function e(e){var t=this;void 0===e&&(e={}),this._registry={},this._sequence=0,this.handle=function(e){e.data&&e.data.jsonrpc===o&&("*"!==t.origin&&t.origin!==e.origin||(e.data.method&&t.destination?t.handleRequest(e.data).then((function(e){t.send(t.destination,e)})):(e.data.hasOwnProperty("result")||e.data.error)&&t.handleResponse(e.data)))},this.destination=e.destination,this.methods=e.methods||{},this.origin=e.origin||"*",e.source&&(this.source=e.source)}return Object.defineProperty(e.prototype,"source",{get:function(){return this._source},set:function(e){if(!e&&this._source)return this._source.removeEventListener("message",this.handle),void(this._source=void 0);e.addEventListener("message",this.handle),this._source=e},enumerable:!0,configurable:!0}),e.prototype.apply=function(e,t){var r=this;if(!this.destination)throw new Error("No destination");var i=this._sequence++,n=new Promise((function(e,t){r._registry[i]={resolve:e,reject:t}}));return this.send(this.destination,{jsonrpc:o,id:i,method:e,params:t}),n},e.prototype.call=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return this.apply(e,t)},e.prototype.handleRequest=function(e){return i(this,void 0,void 0,(function(){var t,i,a,s;return n(this,(function(n){switch(n.label){case 0:if(t={jsonrpc:o,id:e.id},!(i=this.methods[e.method]))return[2,Object.assign(t,{error:{code:r.MethodNotFound,message:"Method not found"}})];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,i.apply(null,ir.ensureArray(e.params))];case 2:return a=n.sent(),[2,Object.assign(t,{result:a})];case 3:return s=n.sent(),[2,Object.assign(t,{error:{code:s.code||r.InternalError,message:s.message}})];case 4:return[2]}}))}))},e.prototype.handleResponse=function(e){var t=this._registry[e.id];delete this._registry[e.id],t&&(e.error?t.reject(Object.assign(Error(),e.error)):t.resolve(e.result))},e.prototype.send=function(e,t){e.postMessage(t,e.window===e?this.origin:void 0)},e}();t.Dispatch=a}));Kt(nr),nr.RPCErrorCodes;var or,ar=nr.Dispatch;function sr(e){if("string"!=typeof e)return!1;var t=e.match(/[a-zA-Z0-9=\/+]{32,}==$/);return!(!t||!t.length)&&t.length>0}!function(e){e[e.UNAVAILABLE=-1]="UNAVAILABLE",e[e.NOT_DETERMINED=0]="NOT_DETERMINED",e[e.DENIED=1]="DENIED",e[e.RESTRICTED=2]="RESTRICTED",e[e.AUTHORIZED=3]="AUTHORIZED"}(or||(or={}));var ur,cr="https://authorize.music.apple.com",lr=/^https?:\/\/(.+\.)*(apple\.com|apps\.mzstatic\.com)(\/[\w\d]+)*$/;!function(e){e[e.AUTHORIZE=0]="AUTHORIZE",e[e.SUBSCRIBE=1]="SUBSCRIBE"}(ur||(ur={}));var hr,pr=function(){function e(e,t){void 0===t&&(t={}),this.developerToken=e,this.authenticateMethod="GET",this.target="apple-music-service-view",this.deeplinkParameters=t&&t.deeplinkParameters||{},this.iconURL=t&&t.iconURL,this.authenticateMethod=t&&t.authenticateMethod||"GET",this.isServiceView&&window.opener!==window&&(this.dispatch=new ar({destination:window.opener,origin:"*",source:window}))}return Object.defineProperty(e.prototype,"isServiceView",{get:function(){return window&&window.name===this.target||!1},enumerable:!0,configurable:!0}),e.prototype.focus=function(){this._window&&window.focus&&this._window.focus()},e.prototype.load=function(e){return void 0===e&&(e={action:ur.AUTHORIZE}),qt(this,void 0,void 0,(function(){return Ft(this,(function(t){return e.action===ur.SUBSCRIBE?[2,this._subscribeAction(e.parameters)]:[2,this._authorizeAction(e.parameters)]}))}))},e.prototype.present=function(e,t){void 0===e&&(e="");var r=this._calculateClientDimensions(),i=r.height,n=r.left,o=r.top,a=r.width,s={height:650,menubar:"no",resizable:"no",scrollbars:"no",status:"no",toolbar:"no",width:650},u=zt({},s,{left:a/2-s.width/2+n,top:i/2-s.height/2+o},t),c=Object.keys(u).map((function(e){return e+"="+u[e]})).join(",");return/trident|msie/i.test(navigator.userAgent)?(this._window=window.open(window.location.href,this.target,c)||void 0,this._window.location.href=e):this._window=window.open(e,this.target,c)||void 0,/\bedge\b/i.test(navigator.userAgent)&&(this._window.opener=self),this.focus(),this._window},e.prototype._authorizeAction=function(e){return void 0===e&&(e={}),qt(this,void 0,void 0,(function(){var t,r,i,n=this;return Ft(this,(function(o){return i=window.location&&window.location.href||"","GET"===this.authenticateMethod?r=cr+"/woa?"+rr(zt({},this.deeplinkParameters,{a:btoa(this._thirdPartyInfo()),referrer:i})):(t=this._buildFormElement("https://buy.itunes.apple.com/commerce/account/authenticateMusicKitRequest"),document.body.appendChild(t)),[2,new Promise((function(i,o){var a=n.present(r);n.dispatch=new ar({methods:{authorize:function(e,t,r){sr(e)?i({restricted:t&&"1"===t,userToken:e,cid:r}):o(or.NOT_DETERMINED)},close:function(){},decline:function(){o(or.DENIED)},switchUserId:function(){o(or.NOT_DETERMINED)},thirdPartyInfo:function(){return n._thirdPartyInfo(n.developerToken,Object.assign(n.deeplinkParameters,e))},unavailable:function(){o(or.UNAVAILABLE)}},origin:cr,source:window,destination:a}),t&&t.submit()}))]}))}))},e.prototype._buildFormElement=function(e,t,r){void 0===t&&(t=this.target),void 0===r&&(r=this.developerToken);var i=document.createElement("form");i.setAttribute("method","post"),i.setAttribute("action",e),i.setAttribute("target",t),i.style.display="none";var n=document.createElement("input");n.setAttribute("name","jwtToken"),n.setAttribute("value",r),i.appendChild(n);var o=document.createElement("input");o.setAttribute("name","isWebPlayer"),o.setAttribute("value","true"),i.appendChild(o);var a=document.createElement("input");return a.setAttribute("name","LogoURL"),a.setAttribute("value",""),i.appendChild(a),i},e.prototype._calculateClientDimensions=function(e){return void 0===e&&(e=window),{height:e.innerHeight?e.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,left:e.screenLeft?e.screenLeft:screen.availLeft||screen.left,top:e.screenTop?e.screenTop:screen.availTop||screen.top,width:e.innerWidth?e.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width}},e.prototype._subscribeAction=function(e){return void 0===e&&(e={}),qt(this,void 0,void 0,(function(){var t=this;return Ft(this,(function(r){return Object.assign(e,this.deeplinkParameters),[2,new Promise((function(r,i){var n="https://authorize.music.apple.com/upsell?"+rr(e);t.present(n),window.addEventListener("message",(function(e){var t=e.data,n=e.origin,o=(e.source,"string"==typeof t?JSON.parse(t):t),a=(o.closeWindow,o.launchClient);n&&!lr.test(n)||(a?0===a.supported?i("Unable to subscribe on this platform."):r(a):i("Subscribe action error."))}))}))]}))}))},e.prototype._thirdPartyInfo=function(e,t){void 0===e&&(e=this.developerToken);var r=this.iconURL,i=window.location.host||document.referrer,n=[].slice.call(document.querySelectorAll('link[rel="apple-music-app-icon"]')).concat([].slice.call(document.querySelectorAll('link[rel="apple-touch-icon-precomposed"]')),[].slice.call(document.querySelectorAll('link[rel="apple-touch-icon"]')));if(n&&n[0]&&n[0].href){var o=n.find((function(e){return!!e.sizes&&"120x120"===e.sizes.value}));r=o&&o.href?o.href:n[0].href}return JSON.stringify({thirdPartyIconURL:r,thirdPartyName:i,thirdPartyParameters:t,thirdPartyToken:e})},e}();!function(e){e.ID="us",e.LANGUAGE_TAG="en-gb"}(hr||(hr={}));var dr,fr=function(){function e(e,t,r){this.id=e,this.attributes=t,this.type="storefronts",this.href=r||"/v1/"+this.type+"/"+e}return e.inferFromLanguages=function(e,t){return void 0===t&&(t=navigator.languages||[navigator.language||navigator.userLanguage]),qt(this,void 0,void 0,(function(){var r,i,n,o,a,s;return Ft(this,(function(u){switch(u.label){case 0:return[4,function(e,t){return void 0===t&&(t="https://api.music.apple.com/v1"),qt(this,void 0,void 0,(function(){var r,i;return Ft(this,(function(n){switch(n.label){case 0:return r=new Headers({Authorization:"Bearer "+e}),[4,fetch(t+"/storefronts",{headers:r})];case 1:return[4,n.sent().json()];case 2:return(i=n.sent()).errors?[2,Promise.reject(i.errors)]:[2,i.data]}}))}))}(e)];case 1:return r=u.sent(),i=r.map((function(e){return e.id})),n=t[0]||"en-US",(o=n.toLowerCase().split(/-|_/))[0],a=o[1],s=i.includes(a)?a:"us",[2,r.find((function(e){return e.id===s}))]}}))}))},e}();!function(e){e.authorizationStatusDidChange="authorizationStatusDidChange",e.authorizationStatusWillChange="authorizationStatusWillChange",e.eligibleForSubscribeView="eligibleForSubscribeView",e.storefrontCountryCodeDidChange="storefrontCountryCodeDidChange",e.storefrontIdentifierDidChange="storefrontIdentifierDidChange",e.userTokenDidChange="userTokenDidChange"}(dr||(dr={})),function(e){function t(t,r){var i=e.call(this,[dr.authorizationStatusDidChange,dr.authorizationStatusWillChange,dr.eligibleForSubscribeView,dr.storefrontCountryCodeDidChange,dr.userTokenDidChange])||this;return i.developerToken=t,i.apiBase="https://api.music.apple.com/v1",i.persist="localstorage",i.playBase="https://play.itunes.apple.com/WebObjects/MZPlay.woa/wa",i.prefix="music",i.storage=window.localStorage,i._authorizationStatus=or.NOT_DETERMINED,i._dispatchedSubscribeView=!1,r&&(r.deeplink&&(i.deeplinkParameters=r.deeplink),r.persist&&(i.persist=r.persist),r.prefix&&(i.prefix=r.prefix)),i._developerToken=new Qt(t),i._serviceSetupView=new pr(t,{authenticateMethod:r&&r.authenticateMethod,iconURL:r&&r.iconURL,deeplinkParameters:i.deeplinkParameters}),i.storagePrefix=(i.prefix+"."+i._developerToken.teamId).toLocaleLowerCase(),i.userTokenIsValid&&(i._restrictedEnabled=i.restrictedEnabled,i._authorizationStatus=i.restrictedEnabled?or.RESTRICTED:or.AUTHORIZED),i._storefrontCountryCode=i.storefrontCountryCode,Yt()||i._processLocationHash(window.location.hash),i}(function(e,t){function r(){this.constructor=e}Bt(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(t,e),Object.defineProperty(t.prototype,"authorizationStatus",{get:function(){return this._authorizationStatus},set:function(e){this.dispatchEvent(dr.authorizationStatusWillChange,{authorizationStatus:this._authorizationStatus,newAuthorizationStatus:e}),this._authorizationStatus=e,this.dispatchEvent(dr.authorizationStatusDidChange,{authorizationStatus:e})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cid",{get:function(){if(!this._cid){var e=this._getStorageItem(this.storagePrefix+".c");this._cid=e||void 0}return this._cid},set:function(e){e?this._setStorageItem(this.storagePrefix+".c",e):this._removeStorageItem(this.storagePrefix+".c"),this._cid=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eligibleForSubscribeView",{get:function(){return!this.hasAuthorized&&!this._dispatchedSubscribeView},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasAuthorized",{get:function(){return this.authorizationStatus>or.DENIED},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"restrictedEnabled",{get:function(){if(this.userToken&&"boolean"!=typeof this._restrictedEnabled){var e=this._getStorageItem(this.userToken+".r");e?this._restrictedEnabled="0"!==e:this._storefrontCountryCode&&(this._restrictedEnabled=-1!==["br","ch","gt","hu","id","in","it","kr","la","lt","my","ru","sg","tr"].indexOf(this._storefrontCountryCode)||void 0)}return this._restrictedEnabled},set:function(e){this.userToken&&void 0!==e&&this._setStorageItem(this.userToken+".r",e?"1":"0"),this._restrictedEnabled=e,e&&(this.authorizationStatus=or.RESTRICTED)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"storefrontCountryCode",{get:function(){if(!this._storefrontCountryCode){var e=this._getStorageItem(this.userToken+".s");this._storefrontCountryCode=e||hr.ID}return this._storefrontCountryCode},set:function(e){e&&this.userToken?this._setStorageItem(this.userToken+".s",e):this._removeStorageItem(this.userToken+".s"),this._storefrontCountryCode=e,this.dispatchEvent(dr.storefrontCountryCodeDidChange,{storefrontCountryCode:e})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"storefrontIdentifier",{get:function(){return this._storefrontIdentifier},set:function(e){this._storefrontIdentifier=e,this.dispatchEvent(dr.storefrontIdentifierDidChange,{storefrontIdentifier:e})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userToken",{get:function(){if(!this._userToken){var e=this._getStorageItem(this.storagePrefix+".u");this._userToken=e||void 0}return this._userToken},set:function(e){e&&sr(e)?(this.authorizationStatus=this.restrictedEnabled?or.RESTRICTED:or.AUTHORIZED,this._setStorageItem(this.storagePrefix+".u",e)):(this.authorizationStatus=or.NOT_DETERMINED,this._removeStorageItem(this.storagePrefix+".u")),this._userToken=e,this.dispatchEvent(dr.userTokenDidChange,{userToken:e})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userTokenIsValid",{get:function(){return sr(this.userToken)},enumerable:!0,configurable:!0}),t.prototype.deeplinkURL=function(e){return void 0===e&&(e={}),"https://finance-app.itunes.apple.com/deeplink?"+rr(e=Object.assign(this.deeplinkParameters||{},e))},t.prototype.itunesDeeplinkURL=function(e){return void 0===e&&(e={p:"browse"}),"https://itunes.apple.com/deeplink?"+rr(e=Object.assign(this.deeplinkParameters||{},e))},t.prototype.renewUserToken=function(){return qt(this,void 0,void 0,(function(){var e,t,r;return Ft(this,(function(i){switch(i.label){case 0:return this.userToken?(e=new Headers({Authorization:"Bearer "+this.developerToken,Accept:"application/json","Content-Type":"application/json","X-Apple-Music-User-Token":""+this.userToken}),[4,fetch(this.playBase+"/renewMusicToken",{method:"POST",headers:e})]):[2,this.requestUserToken()];case 1:return 401!==(t=i.sent()).status?[3,3]:[4,this.revokeUserToken()];case 2:return i.sent(),[2,Promise.reject(new Error("Renew token"))];case 3:return[4,t.json()];case 4:return(r=i.sent())["music-token"]&&(this.userToken=r["music-token"]),[2,this.userToken]}}))}))},t.prototype.requestStorefrontCountryCode=function(){return qt(this,void 0,void 0,(function(){var e,t,r,i;return Ft(this,(function(n){switch(n.label){case 0:return this.authorizationStatus<=or.DENIED?[2,Promise.reject("Not authorized: "+this.authorizationStatus)]:(e=new Headers({Authorization:"Bearer "+this.developerToken,"Music-User-Token":this.userToken}),[4,fetch(this.apiBase+"/me/storefront",{headers:e})]);case 1:return(t=n.sent()).ok?[4,t.json()]:(this._reset(),[2,Promise.reject("Storefront Country Code error.")]);case 2:return(r=n.sent()).errors?[2,Promise.reject(r.errors)]:(i=r.data[0])&&i.id?(this.storefrontCountryCode=i.id,[2,this.storefrontCountryCode]):[2,Promise.reject("Storefront Country Code error.")]}}))}))},t.prototype.requestStorefrontIdentifier=function(){return qt(this,void 0,void 0,(function(){var e;return Ft(this,(function(t){switch(t.label){case 0:return this.storefrontIdentifier?[3,2]:[4,fr.inferFromLanguages(this.developerToken)];case 1:e=t.sent(),this.storefrontIdentifier=e.id,t.label=2;case 2:return[2,this.storefrontIdentifier]}}))}))},t.prototype.requestUserToken=function(){return qt(this,void 0,void 0,(function(){var e,t;return Ft(this,(function(r){switch(r.label){case 0:if(this._serviceSetupView.isServiceView)return[2,this.userToken];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this._serviceSetupView.load({action:ur.AUTHORIZE})];case 2:return e=r.sent(),this.cid=e.cid,this.userToken=e.userToken,this.restrictedEnabled=e.restricted,[3,4];case 3:return t=r.sent(),this._reset(),this.authorizationStatus=t,[2,Promise.reject(t)];case 4:return[2,this.userToken]}}))}))},t.prototype.revokeUserToken=function(){return qt(this,void 0,void 0,(function(){return Ft(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this._webPlayerLogout()];case 1:case 2:return e.sent(),[3,3];case 3:return this.dispatchEvent(dr.authorizationStatusWillChange,{authorizationStatus:this.authorizationStatus,newAuthorizationStatus:or.NOT_DETERMINED}),this._reset(),this.dispatchEvent(dr.authorizationStatusDidChange,{authorizationStatus:this.authorizationStatus}),this.dispatchEvent(dr.userTokenDidChange,{userToken:this._userToken}),[2]}}))}))},t.prototype.presentSubscribeView=function(e){return void 0===e&&(e=!0),qt(this,void 0,void 0,(function(){var t;return Ft(this,(function(r){switch(r.label){case 0:if(this._serviceSetupView.isServiceView||!this.eligibleForSubscribeView)return[2];if(!e)return this.dispatchEvent(dr.eligibleForSubscribeView),this._dispatchedSubscribeView=!0,[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this._serviceSetupView.load({action:ur.SUBSCRIBE})];case 2:return t=r.sent(),this._dispatchedSubscribeView=!0,[2,t];case 3:return r.sent(),[2,this.revokeUserToken()];case 4:return[2]}}))}))},t.prototype.me=function(){return qt(this,void 0,void 0,(function(){var e,t,r,i;return Ft(this,(function(n){switch(n.label){case 0:return this.authorizationStatus<=or.DENIED?[2,Promise.reject("Not authorized: "+this.authorizationStatus)]:(e=new Headers({Authorization:"Bearer "+this.developerToken,"Music-User-Token":this.userToken}),[4,fetch(this.apiBase+"/me/account?meta=subscription",{headers:e})]);case 1:return(t=n.sent()).ok?[4,t.json()]:(this._reset(),[2,Promise.reject("Account error.")]);case 2:return(r=n.sent()).errors?[2,Promise.reject(r.errors)]:(i=r.meta)&&i.subscription?(this.storefrontCountryCode=i.subscription.storefront,[2,i.subscription]):[2,Promise.reject("Account error.")]}}))}))},t.prototype._getStorageItem=function(e){if(e)return"cookie"===this.persist?er(btoa(e)):"localstorage"===this.persist?this.storage.getItem(e):void 0},t.prototype._processLocationHash=function(e){var t=/^\#([a-zA-Z0-9+\/]{200,}={0,2})$/;if(t.test(e)){var r=e.replace(t,"$1");try{var i=JSON.parse(atob(r)),n=i.itre,o=i.musicUserToken,a=i.cid;this.restrictedEnabled=n&&"1"===n,this.userToken=o,this.cid=a}catch(e){}history.replaceState(null,document.title," ")}},t.prototype._removeStorageItem=function(e){return"cookie"===this.persist?tr(btoa(e),"","/",0):"localstorage"===this.persist?this.storage.removeItem(e):void 0},t.prototype._reset=function(e){void 0===e&&(e=or.NOT_DETERMINED),this._authorizationStatus=e,this._cid=void 0,this._dispatchedSubscribeView=!1,this._restrictedEnabled=void 0,this._storefrontCountryCode=void 0,this._removeStorageItem(this.storagePrefix+".c"),this._removeStorageItem(this._userToken+".r"),this._removeStorageItem(this.storagePrefix+".u"),this._removeStorageItem(this._userToken+".s"),this._userToken=void 0},t.prototype._setStorageItem=function(e,t){return"cookie"===this.persist?tr(btoa(e),t,"/",180):"localstorage"===this.persist?this.storage.setItem(e,t):void 0},t.prototype._webPlayerLogout=function(){return qt(this,void 0,void 0,(function(){var e,t;return Ft(this,(function(r){switch(r.label){case 0:return e=new Headers({Authorization:"Bearer "+this.developerToken,Accept:"application/json","Content-Type":"application/json","X-Apple-Music-User-Token":""+this.userToken}),[4,fetch(this.playBase+"/webPlayerLogout",{method:"POST",headers:e})];case 1:return(t=r.sent()).ok?[2,t.json()]:[2,Promise.reject(t.status)]}}))}))}}(Xt);var yr,br,mr,vr,gr=function(){function e(e){var t=e.mediaSource,r=e.manifest,i=e.currentTime,n=e.duration;this._currentBufferIndex=0,this.isBufferActionRunning=!1,this.timeToTrim=10,this.mediaSource=t,Re.logger.trace("mediasource",t),this.sourceBuffer=t.addSourceBuffer(De),Re.logger.trace("sourcebuffer",this.sourceBuffer),this.manifest=r,this._currentTime=i||0,this.duration=n,this.updateEndHandler=this.dequeueBufferAction.bind(this),this.bufferActionsQueue=[],this.sourceBuffer.addEventListener("updateend",this.updateEndHandler),this.addSegment(0)}return Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._currentTime},set:function(e){if(this._currentTime!==e){this._currentTime=e;var t=this.isOverBufferLimit,r=this.timeToTrim,i=e>this.timeToTrim;t&&i&&(this.removeToTime(r),this.addSegment(this.currentBufferIndex+1),this.timeToTrim+=10)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"segments",{get:function(){return this.manifest.segments||[]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentBufferIndex",{get:function(){return this._currentBufferIndex},set:function(e){var t=this.segments,r=this.mediaSource;e===t.length-1?this.addBufferAction(r.endOfStream.bind(r)):this.addSegment(e+1),this._currentBufferIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBufferUpdating",{get:function(){return this.isBufferActionRunning||this.sourceBuffer.updating},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startBufferedTime",{get:function(){return 0===this.sourceBuffer.buffered.length?0:this.sourceBuffer.buffered.start(0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endBufferedTime",{get:function(){return 0===this.sourceBuffer.buffered.length?0:this.sourceBuffer.buffered.end(0)},enumerable:!0,configurable:!0}),e.prototype.waitForSeekToLoad=function(e){return G(this,void 0,void 0,(function(){var t=this;return Q(this,(function(r){return[2,new Promise((function(r){t.addBufferAction(t._checkSeekFinished(e,r))}))]}))}))},e.prototype._checkSeekFinished=function(e,t){var r=this;return function(){if(e>r.startBufferedTime&&e<r.endBufferedTime)return t();r.addBufferAction(r._checkSeekFinished(e,t))}},e.prototype.seek=function(e){return G(this,void 0,void 0,(function(){var t,r,i,n,o,a,s;return Q(this,(function(u){switch(u.label){case 0:return r=(t=this).startBufferedTime,i=t.endBufferedTime,n=t.duration,o=t.segments,t.mediaSource,t.sourceBuffer,r<=e&&i>=e||e>n?[2]:(this.removeToTime(i),this.timeToTrim=10*Math.floor(e/10),a=e/n<.05?e/n:e/n-.05,s=Math.floor(o.length*a),this.addSegment(s),[4,this.waitForSeekToLoad(e)]);case 1:return u.sent(),[2]}}))}))},e.prototype.remove=function(){this.sourceBuffer.removeEventListener("updateend",this.updateEndHandler);try{this.mediaSource.removeSourceBuffer(this.sourceBuffer)}catch(e){return}},e.prototype.dequeueBufferAction=function(){return G(this,void 0,void 0,(function(){var e,t,r;return Q(this,(function(i){switch(i.label){case 0:return(e=this).sourceBuffer,t=e.bufferActionsQueue,this.isBufferUpdating?[2]:(r=t.shift())?(this.isBufferActionRunning=!0,[4,r()]):[3,2];case 1:i.sent(),this.isBufferActionRunning=!1,this.isBufferUpdating||this.dequeueBufferAction(),i.label=2;case 2:return[2]}}))}))},e.prototype.addBufferAction=function(e){this.bufferActionsQueue.push(e),this.isBufferUpdating||this.dequeueBufferAction()},e.prototype.addSegment=function(e){var t=this;this.addBufferAction((function(){return new Promise((function(r){var i=t,n=i.segments,o=(i.mediaSource,i.endBufferedTime,n[e]);o&&o.load().then((function(i){try{t.sourceBuffer.appendBuffer(i),t.currentBufferIndex=e,t.isOverBufferLimit=!1}catch(e){"QuotaExceededError"===e.name&&(t.isOverBufferLimit=!0)}r()}))}))}))},e.prototype.removeToTime=function(e){var t=this;this.addBufferAction((function(){return t.sourceBuffer.remove(0,e),new Promise((function(e){return e()}))}))},e}(),_r=/^#EXT-X-KEY:[^\n]+URI="([^"]+)"/im,Pr=/^#EXT-X-BYTERANGE:([^\n]+)\n/gim,kr=/^#EXT-X-MAP:([^\n]+)\n/im,Er=function(){function e(e,t){this._downlink=0,this._data=e,this._url=t}return e.load=function(e,t){return void 0===t&&(t=!0),G(this,void 0,void 0,(function(){var r,i,n,o;return Q(this,(function(a){switch(a.label){case 0:return(i=!!window.sessionStorage&&t)&&(r=window.sessionStorage.getItem(e))?[2,Promise.resolve(new this(r,e))]:(n=(new Date).getTime(),[4,fetch(e)]);case 1:return[4,a.sent().text()];case 2:return r=a.sent(),(o=new this(r,e)).downlink=function(e,t){return 8*t.length/(((new Date).getTime()-e)/1e3)/1024}(n,r),i&&window.sessionStorage.setItem(e,r),[2,Promise.resolve(o)]}}))}))},Object.defineProperty(e.prototype,"downlink",{get:function(){return this._downlink},set:function(e){this._downlink=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"segments",{get:function(){if(!this._byteRanges){var e=function(e){if(e&&kr.test(e))return e.match(kr)[1].split(",").reduce((function(e,t){var r=t.split("="),i=r[0],n=r[1];return e[i.toLowerCase()]=n.replace(/\"/gi,""),e}),{})}(this._data),t=function(e){if(e&&Pr.test(e))return e.match(Pr).map((function(e){var t=e.match(/^#EXT-X-BYTERANGE:([0-9]+)@([0-9]+)\n/);return[t[1],t[2]]}))}(this._data),r=this._url.split("/").pop()||"",i=this._url.replace(r,e.uri),n=t.map((function(e){var t=e[0],r=e[1];return new wr({url:i,startByte:r,length:t})})),o=e.byterange.split("@"),a=o[0],s=o[1];n.unshift(new wr({url:i,startByte:s,length:a})),this._byteRanges=n}return this._byteRanges},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extURI",{get:function(){if(!this._extURI){var e=this._data.match(_r);this._extURI=e&&e[1]||void 0}return this._extURI},enumerable:!0,configurable:!0}),e}(),wr=function(){function e(e){var t=e.url,r=e.startByte,i=e.length;this.url=t,this.startByte=parseInt(r,10),this.length=parseInt(i,10),this.endByte=this.startByte+this.length-1,this.range="bytes="+this.startByte+"-"+this.endByte}return e.prototype.load=function(){return G(this,void 0,void 0,(function(){var e,t,r,i,n;return Q(this,(function(o){switch(o.label){case 0:return t=(e=this).url,(r=e.range)&&t?((i=new Headers).append("Range",r),[4,fetch(t,{headers:i})]):[2];case 1:return[4,o.sent().arrayBuffer()];case 2:return n=o.sent(),[2,new Uint8Array(n)]}}))}))},e}();!function(e){e[e.STANDARD=64]="STANDARD",e[e.HIGH=256]="HIGH"}(yr||(yr={})),function(e){e[e.DEFAULT=0]="DEFAULT",e[e.PREVIEW_ONLY=1]="PREVIEW_ONLY"}(br||(br={})),function(e){e[e.ACCURATE=0]="ACCURATE",e[e.ROUND=1]="ROUND"}(mr||(mr={})),function(e){e[e.none=0]="none",e[e.loading=1]="loading",e[e.playing=2]="playing",e[e.paused=3]="paused",e[e.stopped=4]="stopped",e[e.ended=5]="ended",e[e.seeking=6]="seeking",e[e.waiting=8]="waiting",e[e.stalled=9]="stalled",e[e.completed=10]="completed"}(vr||(vr={}));var Tr,Ir,Ar,Sr="mk-player-tsid",Cr=Je.bufferedProgressDidChange,Or=Je.mediaCanPlay,Dr=Je.mediaItemDidChange,Rr=Je.mediaItemStateDidChange,Lr=Je.mediaItemStateWillChange,Nr=Je.mediaItemWillChange,Ur=Je.mediaPlaybackError,jr=Je.mediaPlaybackPreview,xr=Je.metadataDidChange,Mr=Je.primaryPlayerDidChange,Br=Je.playbackBitrateDidChange,zr=Je.playbackDurationDidChange,qr=Je.playbackProgressDidChange,Fr=Je.playbackStateDidChange,Vr=Je.playbackStateWillChange,Kr=Je.playbackTargetAvailableDidChange,Hr=Je.playbackTimeDidChange,Wr=Je.playbackVolumeDidChange,Yr=vr.playing,Gr=function(e){function t(t,r){void 0===r&&(r=[]);var i=e.call(this,[Cr,Or,Dr,Rr,Lr,Nr,Ur,jr,xr,Mr,Br,zr,qr,Fr,Vr,Kr,Hr,Wr].concat(r))||this;i.privateEnabled=!1,i.siriInitiated=!1,i._bitrate=yr.STANDARD,i._currentBufferedProgress=0,i._paused=!1,i._playbackState=vr.none,i._stopped=!1,i._timingAccuracy=mr.ROUND,i._currentPlaybackProgress=0,i._downlinkSamples=[],i._isPrimaryPlayer=!0,i._mode=br.DEFAULT,i._nowPlayingItem=null,i._playActivityStub=new Se,i._playbackTargetAvailable=!1,i._serial=Date.now().toString(),i._bitrate=t.bitrate||yr.STANDARD,i._timingAccuracy=t.accurateTiming?mr.ACCURATE:mr.ROUND,window.navigator&&window.navigator.connection&&window.navigator.connection.downlink&&i._recalculateBitrate(100*(window.navigator.connection.downlink||0)),i.storekit=t.storekit,i.privateEnabled=t.privateEnabled||!1,i.siriInitiated=t.siriInitiated||!1;var n="visibilitychange",o="visibilityState";void 0!==document.mozHidden?(n="mozvisibilitychange",o="mozVisibilityState"):void 0!==document.msHidden?(n="msvisibilitychange",o="msVisibilityState"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",o="webkitVisibilityState"),document.addEventListener(n,(function(e){return Re.logger.log("visibilityState",e.target[o]),"hidden"===e.target[o]?i.isPlaying&&i.playActivity.exit(i.currentPlaybackTime):"visible"===e.target[o]?i.playActivity.activate(!i.isPlaying):void 0}));var a="onpagehide"in window?"pagehide":"unload";return window.addEventListener(a,(function(){return i.isPlaying&&i.playActivity.exit(i.currentPlaybackTime)})),window.addEventListener("storage",(function(e){var t=e.key,r=e.newValue;t===Sr&&r&&(i.isPrimaryPlayer=r===i._serial)}),!1),localStorage.setItem(Sr,i._serial),setTimeout((function(){i.playActivity.activate(!i.isPlaying)}),500),i}return Y(t,e),Object.defineProperty(t.prototype,"bitrate",{get:function(){return this._bitrate},set:function(e){this._bitrate!==e&&(this._bitrate=e,this.dispatchEvent(Br,{bitrate:e}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canSupportDRM",{get:function(){return!!this.extension&&this.extension.hasMediaSession},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentBufferedProgress",{get:function(){return this._currentBufferedProgress},set:function(e){this._currentBufferedProgress!==e&&(this._currentBufferedProgress=e,this.dispatchEvent(Cr,{progress:e}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentPlaybackDuration",{get:function(){return!this.previewOnly&&this.hasAuthorization&&this.nowPlayingItem&&this.nowPlayingItem.playbackDuration?this._timing(this.nowPlayingItem.playbackDuration/1e3):this._timing(this._currentDuration)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentPlaybackTime",{get:function(){return this._timing(this._currentTime)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentPlaybackTimeRemaining",{get:function(){return this.currentPlaybackDuration-this.currentPlaybackTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentPlaybackProgress",{get:function(){return this._currentPlaybackProgress||0},set:function(e){this._currentPlaybackProgress!==e&&(this._currentPlaybackProgress=e,this.dispatchEvent(qr,{progress:e}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"formattedCurrentPlaybackDuration",{get:function(){return ae(this.currentPlaybackDuration)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasAuthorization",{get:function(){return le(this.storekit)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPlaying",{get:function(){return this.playbackState===Yr},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPrimaryPlayer",{get:function(){return this._isPrimaryPlayer},set:function(e){e!==this._isPrimaryPlayer&&(this._isPrimaryPlayer=e,this._isPrimaryPlayer?localStorage.setItem(Sr,this._serial):(this.dispatchEvent(Mr,{target:this}),this.pause()))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"medianDownlink",{get:function(){return this._downlinkSamples.reduce((function(e,t){return e+t}),0)/this._downlinkSamples.length||0},enumerable:!0,configurable:!0}),t.prototype.mute=function(){this.volume=0},Object.defineProperty(t.prototype,"nowPlayingItem",{get:function(){return this._nowPlayingItem},set:function(e){e?this._nowPlayingItem&&this._nowPlayingItem.isEqual(e)||(this.dispatchEvent(Nr,{item:e}),this.isPlaying&&this.pause(),this.canSupportDRM&&this.extension.cancelPendingRenewal(),this._nowPlayingItem&&(this._nowPlayingItem.state=wt.ended,this._nowPlayingItem.endMonitoringStateDidChange(),this._nowPlayingItem.endMonitoringStateWillChange()),this._nowPlayingItem=e,this._nowPlayingItem.state=wt.playing,e&&e.info&&this._setTargetElementTitle(e.info),this.dispatchEvent(Dr,{item:e}),this.dispatchEvent(zr,{currentTarget:this._targetElement,duration:this.currentPlaybackDuration,target:this._targetElement,type:"durationchange"})):this._nowPlayingItem=null},enumerable:!0,configurable:!0}),t.prototype.pause=function(){return G(this,void 0,void 0,(function(){return Q(this,(function(e){switch(e.label){case 0:return this.isPlaying?[4,this._pauseMedia()]:[3,3];case 1:return e.sent(),this._paused=!0,[4,this.playActivity.pause(this.currentPlaybackTime)];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))},t.prototype.play=function(){return G(this,void 0,void 0,(function(){return Q(this,(function(e){switch(e.label){case 0:return this.nowPlayingItem?[4,this._playMedia()]:[2];case 1:return e.sent(),[4,this.playActivity.play()];case 2:return e.sent(),[2]}}))}))},t.prototype.preload=function(){return this._loadMedia()},t.prototype.playMediaItem=function(e,t){return void 0===t&&(t=!1),G(this,void 0,void 0,(function(){var r,i,n,o,a=this;return Q(this,(function(s){switch(s.label){case 0:return e&&e.isPlayable?(e.beginMonitoringStateDidChange((function(e){return a.dispatchEvent(Rr,e)})),e.beginMonitoringStateWillChange((function(e){return a.dispatchEvent(Lr,e)})),r=this._paused&&!t,i=!this.canSupportDRM,this.previewOnly||(!this.hasAuthorization||i)&&!e.playRawAssetURL?(this.nowPlayingItem=e,i&&this.dispatchEvent(jr,{item:e}),[2,this._playAssetURL(e.previewURL,r)]):e.playRawAssetURL&&e.attributes.assetUrl?(this.nowPlayingItem=e,[2,this._playAssetURL(e.attributes.assetUrl,r)]):[4,this._loadMedia()]):[2,Promise.reject(new ne(ne.MEDIA_PLAYBACK,"Not Playable."))];case 1:return s.sent(),[4,this.prepareToPlay(e,t)];case 2:return s.sent(),e.playRawAssetURL?(this.nowPlayingItem=e,[2,this._playAssetURL(e.assetURL,r)]):(this.extension.initiated=t,this.extension.setMediaItem(e),this.nowPlayingItem=e,e.state=wt.loading,[4,Er.load(e.assetURL,!1)]);case 3:return n=s.sent(),this.extension.extURI=n.extURI,e.state=wt.ready,this.extension.isFairplay?[2,this._playAssetURL(e.assetURL,r)]:[3,4];case 4:return n.downlink&&this._recalculateBitrate(n.downlink),this._buffer&&this._buffer.remove(),o=new MediaSource,[4,this._playAssetURL(window.window.URL.createObjectURL(o),!0)];case 5:s.sent(),o.addEventListener("sourceopen",(function(t){if(0===o.activeSourceBuffers.length&&(a._buffer=new gr({duration:e.playbackDuration/1e3,mediaSource:o,manifest:n}),!r&&a.playbackState!==vr.paused))return a._playMedia()})),s.label=6;case 6:return[2]}}))}))},Object.defineProperty(t.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(e){this._playbackRate=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"playbackState",{get:function(){return this._playbackState},set:function(e){if(e!==this._playbackState){var t={oldState:this._playbackState,state:e};this.dispatchEvent(Vr,t),this._playbackState=e,this.dispatchEvent(Fr,t)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"playbackTargetAvailable",{get:function(){return void 0!==window.WebKitPlaybackTargetAvailabilityEvent&&this._playbackTargetAvailable},set:function(e){e!==this._playbackTargetAvailable&&(this._playbackTargetAvailable=e,this.dispatchEvent(Kr,{available:e}))},enumerable:!0,configurable:!0}),t.prototype.prepareToPlay=function(e,t){return void 0===t&&(t=!1),G(this,void 0,void 0,(function(){var r;return Q(this,(function(i){switch(i.label){case 0:if(!this.hasAuthorization)return[2,Promise.reject(new ne(ne.AUTHORIZATION_ERROR,"Unable to prepare for playback."))];i.label=1;case 1:return i.trys.push([1,3,,13]),[4,e.prepareToPlay(this.storekit.developerToken,this.storekit.userToken,this.storekit.storefrontCountryCode)];case 2:return i.sent(),[3,13];case 3:return r=i.sent(),[ne.AUTHORIZATION_ERROR,ne.SUBSCRIPTION_ERROR].includes(r.errorCode)?[4,this.storekit.revokeUserToken()]:[3,5];case 4:return i.sent(),[3,12];case 5:if(r.errorCode!==ne.TOKEN_EXPIRED)return[3,11];i.label=6;case 6:return i.trys.push([6,9,,10]),[4,this.storekit.renewUserToken()];case 7:return i.sent(),[4,e.prepareToPlay(this.storekit.developerToken,this.storekit.userToken,this.storekit.storefrontCountryCode)];case 8:return i.sent(),e.playbackData=this._playbackDataForItem(e),[2,e];case 9:return i.sent(),[3,10];case 10:return[3,12];case 11:r.errorCode===ne.CONTENT_UNAVAILABLE&&e.equivalent&&(r=new ne(ne.CONTENT_EQUIVALENT,r.message)),i.label=12;case 12:return t?[2,Promise.reject(r)]:(this.dispatchEvent(Ur,r),[2]);case 13:return e.playbackData=this._playbackDataForItem(e),[2,e]}}))}))},Object.defineProperty(t.prototype,"previewOnly",{get:function(){return this._mode===br.PREVIEW_ONLY},set:function(e){this._mode=e?br.PREVIEW_ONLY:br.DEFAULT},enumerable:!0,configurable:!0}),t.prototype.seekToTime=function(e){return G(this,void 0,void 0,(function(){var t;return Q(this,(function(r){switch(r.label){case 0:return t=this.currentPlaybackTime,this._buffer?[4,this._buffer.seek(e)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[4,this._seekToTime(e)];case 3:return r.sent(),[4,this.playActivity.scrub(t)];case 4:return r.sent(),[4,this.playActivity.scrub(e,be.SCRUB_END)];case 5:return r.sent(),[2]}}))}))},Object.defineProperty(t.prototype,"storekit",{get:function(){return this._storekit},set:function(e){var t=this;e&&(e.addEventListener(dr.authorizationStatusWillChange,(function(e){var r=e.authorizationStatus,i=e.newAuthorizationStatus;return G(t,void 0,void 0,(function(){return Q(this,(function(e){switch(e.label){case 0:return this.isPlaying?r>or.DENIED&&i<or.RESTRICTED?[4,this.stop(be.PLAYBACK_SUSPENDED)]:[3,2]:[3,4];case 1:return e.sent(),[3,4];case 2:return[4,this.stop()];case 3:e.sent(),e.label=4;case 4:return[2]}}))}))})),this._storekit=e)},enumerable:!0,configurable:!0}),t.prototype.stop=function(e){return G(this,void 0,void 0,(function(){return Q(this,(function(t){switch(t.label){case 0:return this._stopped=!0,[4,this._stopMedia()];case 1:return t.sent(),[4,this.playActivity.stop(this.currentPlaybackTime,e)];case 2:return t.sent(),this.nowPlayingItem=null,[2]}}))}))},Object.defineProperty(t.prototype,"volume",{get:function(){return this._volume},set:function(e){this._volume=e},enumerable:!0,configurable:!0}),t.prototype._calculatePlaybackProgress=function(){this.currentPlaybackProgress=Math.round(100*(this.currentPlaybackTime/this.currentPlaybackDuration||0))/100},Object.defineProperty(t.prototype,"playActivity",{get:function(){return this._storekit&&this._storekit.userTokenIsValid&&this._requiresPlayActivity()?(this._playActivityClient||(this._playActivityClient=new Ae(this._storekit.developerToken,this._storekit.userToken,this._storekit.storefrontCountryCode,{app:{build:Re.app.build,name:Re.app.name,version:Re.app.version},logInfo:Re.logger.enabled,sourceType:Re.sourceType})),this._playActivityClient):this._playActivityStub},enumerable:!0,configurable:!0}),t.prototype._playbackDataForItem=function(e){var t=this;return e.isCloudUpload?e.assets[0]:e.assets.filter((function(e){var r=e.flavor,i=new RegExp("\\d{1,2}\\:(c"+(t.extension.isFairplay?"bc":"tr")+"p)(\\d{2,3})","i");return i.test(r)&&parseInt(r.match(i)[2],0)<=t.bitrate}))[0]},t.prototype._recalculateBitrate=function(e){this._downlinkSamples.push(e),this.medianDownlink&&this.medianDownlink>=65?this.bitrate=yr.HIGH:this.bitrate=yr.STANDARD},t.prototype._requiresPlayActivity=function(){return!!this.nowPlayingItem&&Te(this.nowPlayingItem)},t.prototype._timing=function(e){return void 0===e&&(e=0),this._timingAccuracy===mr.ROUND?Math.round(e):e},t}(Et),Qr=function(){function e(){this.bitrate=yr.STANDARD,this.canSupportDRM=!1,this.currentBufferedProgress=NaN,this.currentPlaybackDuration=NaN,this.currentPlaybackProgress=NaN,this.currentPlaybackTime=NaN,this.currentPlaybackTimeRemaining=NaN,this.formattedCurrentPlaybackDuration={hours:NaN,minutes:NaN},this.isLooping=!1,this.isPlaying=!1,this.isPrimaryPlayer=!0,this.isReady=!1,this.nowPlayingItem=null,this.playbackRate=NaN,this.playbackState=vr.none,this.playbackTargetAvailable=!1,this.volume=NaN,this._playActivity=new Se}return Object.defineProperty(e.prototype,"playActivity",{get:function(){return this._playActivity},enumerable:!0,configurable:!0}),e.prototype.activate=function(){},e.prototype.deactivate=function(){},e.prototype.destroy=function(){},e.prototype.mute=function(){},e.prototype.pause=function(){return Promise.resolve()},e.prototype.play=function(){return Promise.resolve()},e.prototype.playMediaItem=function(e,t){return Promise.resolve()},e.prototype.preload=function(){return Promise.resolve()},e.prototype.prepareToPlay=function(e,t,r){return Promise.resolve()},e.prototype.seekToTime=function(e){return Promise.resolve()},e.prototype.showPlaybackTargetPicker=function(){},e.prototype.stop=function(e){return Promise.resolve()},e}();!function(e){e.MP4="audio/mp4"}(Tr||(Tr={})),function(e){e.FAIRPLAY="com.apple.fps",e.PLAYREADY="com.microsoft.playready",e.WIDEVINE="com.widevine.alpha"}(Ir||(Ir={})),function(e){e.playbackLicenseError="playbackLicenseError",e.playbackSessionError="playbackSessionError"}(Ar||(Ar={}));var Zr,Xr,Jr,$r=/max-age=(\d+)/i,ei=function(e){function t(){var t=e.call(this,[Ar.playbackLicenseError,Ar.playbackSessionError])||this;return t.initiated=!0,t.isLibrary=!1,t.keySystem=Ir.FAIRPLAY,t._storage=window.sessionStorage,t.boundDispatchKeyError=t.dispatchKeyError.bind(t),t.boundDispatchSessionError=t.dispatchSessionError.bind(t),t.boundHandleSessionCreation=t.handleSessionCreation.bind(t),t}return Y(t,e),Object.defineProperty(t.prototype,"extID",{get:function(){if(this.extURI)return this.extURI.replace("data:;base64,","")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isFairplay",{get:function(){return this.keySystem===Ir.FAIRPLAY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPlayready",{get:function(){return this.keySystem===Ir.PLAYREADY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isWidevine",{get:function(){return this.keySystem===Ir.WIDEVINE},enumerable:!0,configurable:!0}),t.prototype.acquirePlaybackLicense=function(e,t,r){return void 0===r&&(r=this.initiated),G(this,void 0,void 0,(function(){var i,n;return Q(this,(function(o){switch(o.label){case 0:return this.keyServerURL&&this.developerToken&&this.userToken?(i=new Headers({Authorization:"Bearer "+this.developerToken,Accept:"application/json","Content-Type":"application/json","X-Apple-Music-User-Token":""+this.userToken}),[4,fetch(this.keyServerURL,{method:"POST",body:JSON.stringify({"key-system":this.keySystem,"user-initiated":r,adamId:""+this.adamId,isLibrary:this.isLibrary,challenge:t,uri:e}),headers:i})]):[2];case 1:return(n=o.sent()).ok?[4,n.json()]:[2,Promise.reject(new ne(ne.MEDIA_LICENSE,"Error acquiring license"))];case 2:return[2,o.sent()]}}))}))},t.prototype.cancelPendingRenewal=function(){this._pendingRenewal&&(clearTimeout(this._pendingRenewal),this._pendingRenewal=void 0)},t.prototype.startLicenseSession=function(e){var t,r=this,i=e.message,n=e.target;if(this.isPlayready){var o=String.fromCharCode.apply(null,new Uint16Array(i.buffer||i)),a=(new DOMParser).parseFromString(o,"application/xml");t=a.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue}else t=lt(new Uint8Array(i));return this.acquirePlaybackLicense(this.extURI,t).then((function(e){r._handleLicenseResponse(e,n,t)}))},t.prototype.setKeyURLs=function(e){this.keyCertURL=e[this.isFairplay?"hls-key-cert-url":"widevine-cert-url"],this.keyServerURL=e["hls-key-server-url"]},t.prototype.dispatchKeyError=function(e){this.dispatchEvent(Ar.playbackSessionError,new ne(ne.MEDIA_KEY,e))},t.prototype.dispatchSessionError=function(e){this.dispatchEvent(Ar.playbackSessionError,new ne(ne.MEDIA_SESSION,e))},t.prototype.loadCertificateBuffer=function(){return G(this,void 0,void 0,(function(){var e,t,r,i,n,o,a,s,u,c,l,h,p;return Q(this,(function(d){switch(d.label){case 0:if(!this.keyCertURL)return[2,Promise.reject(new ne(ne.MEDIA_SESSION,"No certificate URL"))];if((e=document.createElement("a")).href=this.keyCertURL,t=Date.now(),r=(""+e.hostname+e.pathname).replace(/[^a-z0-9.]/gi,"."),i=this._storage.getItem(r),n=parseInt(this._storage.getItem("com.ai.mk.vmcc.exp")||"",10),i&&n&&n>t){for(o=new Uint8Array(i.length),a=i.length;a--;)o[a]=i.charCodeAt(a);return[2,o.buffer]}return[4,fetch(this.keyCertURL+"?t="+Date.now())];case 1:return s=d.sent(),u=s.headers.get("cache-control"),c=86400,u&&$r.test(u)&&(l=u.match($r))&&l[1]&&(c=parseInt(l[1],10)),[4,s.arrayBuffer()];case 2:return h=d.sent(),p=String.fromCharCode.apply(String,new Uint8Array(h)),/^\<\?xml/.test(p)?[2,Promise.reject(new ne(ne.MEDIA_CERTIFICATE,"Invalid certificate."))]:(this._storage.setItem(r,p),this._storage.setItem("com.ai.mk.vmcc.exp",(t+1e3*c).toString()),[2,h])}}))}))},t.prototype.handleSessionCreation=function(e){return G(this,void 0,void 0,(function(){var t=this;return Q(this,(function(r){return[2,this.createSession(e).catch((function(e){t.dispatchSessionError(e)}))]}))}))},t.prototype._handleLicenseResponse=function(e,t,r){var i=this;if(e.license){e["renew-after"]&&(this._pendingRenewal=setTimeout((function(){i.acquirePlaybackLicense(i.extURI,r,!1).then((function(e){i._handleLicenseResponse(e,t,r)}))}),1e3*e["renew-after"]));var n=ut(e.license);return t.update(n)}var o=ne.serverError(e);if(this.initiated)throw o;this.dispatchEvent(Ar.playbackLicenseError,o)},t}(Et),ti=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Y(t,e),t.prototype.attachMedia=function(e,t){var r=this;return this.keySystem=t.keySystem,e.addEventListener("encrypted",this.boundHandleSessionCreation,!1),t.createMediaKeys().then((function(t){e.setMediaKeys(t)})).catch((function(e){return r.dispatchKeyError(e)}))},t.prototype.detachMedia=function(e){e.removeEventListener("encrypted",this.boundHandleSessionCreation)},t.prototype.createSession=function(e){var t=this,r=e.initData,i=e.initDataType,n=e.target;return this._mediaKeysServerCertificate?this._createSession(n,r,i):this.loadCertificateBuffer().then((function(e){return n.mediaKeys.setServerCertificate(e).then((function(){return t._mediaKeysServerCertificate=e,t._createSession(n,r,i)}))}))},t.prototype.generatePSSH=function(e){for(var t=new Uint8Array([0,0,0,52,112,115,115,104,0,0,0,0,237,239,139,169,121,214,74,206,163,200,39,220,213,29,33,237,0,0,0,20,8,1,18,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),r=ut(e),i=0;i<r.length;i++)t[t.length-16+i]=r[i];return t},t.prototype._createSession=function(e,t,r){var i=e.mediaKeys.createSession(),n=this.isWidevine?this.generatePSSH(this.extID):t;return i.addEventListener("message",this.startLicenseSession.bind(this)),i.generateRequest(r,n)},t}(ei),ri=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Y(t,e),t.prototype.attachMedia=function(e,t){return this.keySystem=t.keySystem,e.addEventListener("msneedkey",this.boundHandleSessionCreation,!1),e.addEventListener("mskeyerror",this.boundDispatchKeyError),e},t.prototype.detachMedia=function(e){e.removeEventListener("msneedkey",this.boundHandleSessionCreation,!1),e.removeEventListener("mskeyerror",this.boundDispatchKeyError)},t.prototype.createSession=function(e){var t=e.initData,r=e.target;if(!r.msKeys){var i=new MSMediaKeys(this.keySystem);r.msSetMediaKeys(i)}var n=r.msKeys.createSession(Tr.MP4,t);return n.addEventListener("mskeyerror",this.dispatchKeyError),n.addEventListener("mskeymessage",this.startLicenseSession.bind(this)),n},t}(ei),ii=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Y(t,e),t.prototype.attachMedia=function(e,t){return e.addEventListener("webkitneedkey",this.boundHandleSessionCreation,!1),e.addEventListener("webkitkeyerror",this.boundDispatchKeyError),e},t.prototype.detachMedia=function(e){e.removeEventListener("webkitneedkey",this.boundHandleSessionCreation,!1),e.removeEventListener("webkitkeyerror",this.boundDispatchKeyError)},t.prototype.createSession=function(e){var t=this,r=e.initData,i=e.target,n=document.createElement("a");n.href=st(r.buffer);var o=i.contentId=n.hostname;if(!i.webkitKeys){var a=new window.WebKitMediaKeys(this.keySystem);i.webkitSetMediaKeys(a)}return this.loadCertificateBuffer().then((function(e){var n=t._concatInitDataIdAndCertificate(r,o,e),a=i.webkitKeys.createSession(Tr.MP4,n);a.contentId=o,a.addEventListener("webkitkeyerror",t.dispatchKeyError),a.addEventListener("webkitkeymessage",t.startLicenseSession.bind(t))}))},t.prototype._concatInitDataIdAndCertificate=function(e,t,r){"string"==typeof t&&(t=ct(t)),r=new Uint8Array(r);var i=0,n=new ArrayBuffer(e.byteLength+4+t.byteLength+4+r.byteLength),o=new DataView(n);new Uint8Array(n,i,e.byteLength).set(e),i+=e.byteLength,o.setUint32(i,t.byteLength,!0),i+=4;var a=new Uint8Array(n,i,t.byteLength);return a.set(t),i+=a.byteLength,o.setUint32(i,r.byteLength,!0),i+=4,new Uint8Array(n,i,r.byteLength).set(r),new Uint8Array(n,0,n.byteLength)},t}(ei),ni=function(e){function t(t,r){var i=e.call(this,[Ar.playbackLicenseError,Ar.playbackSessionError])||this;if(i.audio=t,Re.browser().isIE||Re.browser().isSafari&&Re.browser().engineMajorVersion<=601)return i;if(window.WebKitMediaKeys&&window.WebKitMediaKeys.isTypeSupported(Ir.FAIRPLAY+".1_0",Tr.MP4))i.session=new ii,i.session.attachMedia(t,{keySystem:Ir.FAIRPLAY});else if(window.MSMediaKeys&&window.MSMediaKeys.isTypeSupported(Ir.PLAYREADY,Tr.MP4))i.session=new ri,i.session.attachMedia(t,{keySystem:Ir.PLAYREADY});else if(i.hasMediaKeySupport&&t.canPlayType(r)){i.session=new ti;var n=[{initDataTypes:["cenc","keyids"],audioCapabilities:[{contentType:r}],distinctiveIdentifier:"optional",persistentState:"required"}];navigator.requestMediaKeySystemAccess(Ir.WIDEVINE,n).then((function(e){i.session.attachMedia(t,e)})).catch((function(){navigator.requestMediaKeySystemAccess(Ir.PLAYREADY,n).then((function(e){i.session.attachMedia(t,e)}))}))}return i.session&&i.session.addEventListener(Ar.playbackLicenseError,(function(e){i.dispatchEvent(Ar.playbackLicenseError,e)})),i}return Y(t,e),Object.defineProperty(t.prototype,"hasMediaKeySupport",{get:function(){return!!(navigator&&navigator.requestMediaKeySystemAccess&&window.MediaKeys&&window.MediaKeySystemAccess)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasMediaSession",{get:function(){return void 0!==this.session},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isFairplay",{get:function(){return this.session.isFairplay},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extURI",{set:function(e){this.session.extURI=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"initiated",{set:function(e){this.session.initiated=e},enumerable:!0,configurable:!0}),t.prototype.cancelPendingRenewal=function(){this.session.cancelPendingRenewal()},t.prototype.setMediaItem=function(e){this.session.developerToken=Re.storekit.developerToken,this.session.userToken=Re.storekit.userToken,this.session.adamId=e.songId,this.session.isLibrary=e.isCloudItem,this.session.setKeyURLs(e.keyURLs)},t.prototype.destroy=function(e){this.session&&this.session.detachMedia(e)},t}(Et),oi=Je.mediaCanPlay,ai=Je.mediaPlaybackError,si=Je.metadataDidChange,ui=Je.playbackDurationDidChange,ci=Je.playbackTimeDidChange,li=Je.playbackVolumeDidChange,hi=(vr.completed,vr.ended),pi=vr.loading,di=vr.paused,fi=vr.playing,yi=vr.seeking,bi=vr.stopped,mi=vr.waiting,vi=["canplay","durationchange","ended","error","loadedmetadata","loadstart","pause","playing","progress","seeked","seeking","timeupdate","volumechange","waiting"],gi=function(e){function t(t){var r=e.call(this,t)||this;r.mediaPlayerType="audio";var i=document.createElement("audio");return i.autoplay=!1,i.id="apple-music-player",i.controls=!1,i.muted=!1,i.playbackRate=1,i.preload="metadata",i.volume=1,vi.forEach((function(e){return i.addEventListener(e,r)})),window.WebKitPlaybackTargetAvailabilityEvent&&i.addEventListener("webkitplaybacktargetavailabilitychanged",(function(e){r.playbackTargetAvailable="available"===e.availability})),r.extension=new ni(i,De),r.extension.addEventListener(Ar.playbackLicenseError,(function(e){r.dispatchEvent(ai,e)})),r.extension.addEventListener(Ar.playbackSessionError,(function(e){r.dispatchEvent(ai,new ne(ne.MEDIA_SESSION,e))})),document.body.appendChild(i),r.audio=i,r}return Y(t,e),Object.defineProperty(t.prototype,"isReady",{get:function(){return 0!==this.audio.readyState},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_currentDuration",{get:function(){return this.audio.duration},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_currentTime",{get:function(){return this.audio.currentTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_playbackRate",{get:function(){return this.audio.playbackRate},set:function(e){this.audio.playbackRate=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_targetElement",{get:function(){return this.audio},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_volume",{get:function(){return this.audio.volume},set:function(e){this.audio.volume=e},enumerable:!0,configurable:!0}),t.prototype.activate=function(){return Promise.resolve()},t.prototype.deactivate=function(){return Promise.resolve()},t.prototype.destroy=function(){var e=this;return this.extension.destroy(this.audio),vi.forEach((function(t){return e.audio.removeEventListener(t,e)})),null!==this.audio.parentNode&&this.audio.parentNode.removeChild(this.audio),Promise.resolve()},t.prototype.handleEvent=function(e){return G(this,void 0,void 0,(function(){var t;return Q(this,(function(r){switch(e.type){case"canplay":this.dispatchEvent(oi,e);break;case"durationchange":this.audio.duration!==1/0&&(e.duration=this.currentPlaybackDuration,this.dispatchEvent(ui,e),this._calculatePlaybackProgress());break;case"ended":this.playbackState=hi;break;case"error":case"loadedmetadata":this.dispatchEvent(si,e);break;case"loadstart":this.playbackState=pi;break;case"pause":this.playbackState=this._stopped?bi:di;break;case"playing":this._paused=!1,this._stopped=!1,this.isPrimaryPlayer=!0,this.playbackState=fi;break;case"progress":1===(t=this.audio.buffered).length&&0===t.start(0)&&(this.currentBufferedProgress=Math.round(t.end(0)/this.currentPlaybackDuration*100));break;case"seeked":this._paused?this.playbackState=di:this._stopped?this.playbackState=bi:this.playbackState=fi;break;case"seeking":this.playbackState===di?this._paused=!0:this.playbackState===bi&&(this._stopped=!0),this.playbackState=yi;break;case"timeupdate":this.dispatchEvent(ci,{currentPlaybackDuration:this.currentPlaybackDuration,currentPlaybackTime:this.currentPlaybackTime,currentPlaybackTimeRemaining:this.currentPlaybackTimeRemaining}),this._calculatePlaybackProgress(),this._buffer&&(this._buffer.currentTime=this.currentPlaybackTime);break;case"volumechange":this.dispatchEvent(li,e);break;case"waiting":this.playbackState=mi}return[2]}))}))},Object.defineProperty(t.prototype,"isLooping",{get:function(){return"boolean"==typeof this.audio.loop&&this.audio.loop},set:function(e){"boolean"==typeof this.audio.loop&&(this.audio.loop=e)},enumerable:!0,configurable:!0}),t.prototype.showPlaybackTargetPicker=function(){this.playbackTargetAvailable&&this.audio.webkitShowPlaybackTargetPicker()},t.prototype._seekToTime=function(e){return this.audio.currentTime=e,Promise.resolve()},t.prototype._loadMedia=function(){return this.audio.load()},t.prototype._pauseMedia=function(){return this.audio.pause(),Promise.resolve()},t.prototype._playAssetURL=function(e,t){return void 0===t&&(t=!1),this.audio.src=e,t?this._loadMedia():this._playMedia()},t.prototype._playMedia=function(){var e=this.audio.play();return e&&e.catch&&e.catch((function(){})),e},t.prototype._setTargetElementTitle=function(e){this.audio&&(this.audio.title=e)},t.prototype._stopMedia=function(){return this.audio.pause(),this.audio.currentTime=0,this.audio.removeAttribute("src"),this.audio.removeAttribute("title"),Promise.resolve()},t}(Gr),_i=function(e){function t(t,r){return void 0===r&&(r=.3),e.call(this,t,r)||this}return Y(t,e),t.prototype.handlePlaybackThreshold=function(){return G(this,void 0,void 0,(function(){return Q(this,(function(e){switch(e.label){case 0:return[4,this._playbackController.prepareToPlay(this._next,!1,!0)];case 1:return e.sent(),[2]}}))}))},t.prototype.shouldMonitor=function(){return!!this._playbackController.hasAuthorization&&(this._next=this._playbackController.queue.nextPlayableItem,void 0!==this._next&&!this._next.isPreparedToPlay)},t.prototype.reset=function(){e.prototype.reset.call(this),this._next=void 0},t}(function(){function e(e,t){var r=this;this.isMonitoring=!1,this._threshhold=-1,this._playbackController=e,this._percentage=t,this.reset(),this._boundHandleTimeChange=this.handleTimeChange.bind(this),this._boundUpdateThreshhold=this.updateThreshold.bind(this),this._playbackController.addEventListener(Je.mediaItemDidChange,(function(){r.handleMediaItemChange()}))}return e.prototype.clearMonitor=function(){this.clearListeners(),this.reset()},e.prototype.reset=function(){this._threshhold=-1,this.isMonitoring=!1},e.prototype.clearListeners=function(){this._playbackController.removeEventListener(Je.playbackDurationDidChange,this._boundUpdateThreshhold),this._playbackController.removeEventListener(Je.playbackTimeDidChange,this._boundHandleTimeChange)},e.prototype.handleMediaItemChange=function(){this.isMonitoring&&this.clearMonitor(),this.shouldMonitor()&&(this._playbackController.addEventListener(Je.playbackDurationDidChange,this._boundUpdateThreshhold),this._playbackController.addEventListener(Je.playbackTimeDidChange,this._boundHandleTimeChange),this.isMonitoring=!0)},e.prototype.handleTimeChange=function(e){var t=e.currentPlaybackDuration,r=e.currentPlaybackTime;return G(this,void 0,void 0,(function(){return Q(this,(function(e){switch(e.label){case 0:return this._threshhold<0&&this.updateThreshold({duration:t}),r<this._threshhold?[2]:(this.clearListeners(),[4,this.handlePlaybackThreshold()]);case 1:return e.sent(),this.reset(),[2]}}))}))},e.prototype.updateThreshold=function(e){var t=e.duration;this._threshhold=t*this._percentage},e}());!function(e){e[e.none=0]="none",e[e.one=1]="one",e[e.all=2]="all"}(Zr||(Zr={})),function(e){e[e.off=0]="off",e[e.songs=1]="songs"}(Xr||(Xr={})),(Jr=e.PlayerSeek||(e.PlayerSeek={}))[Jr.FORWARD=30]="FORWARD",Jr[Jr.BACK=15]="BACK";var Pi,ki=Je.queueItemsDidChange,Ei=Je.queuePositionDidChange,wi=[Je.bufferedProgressDidChange,Je.mediaCanPlay,Je.mediaItemDidChange,Je.mediaItemStateDidChange,Je.mediaItemStateWillChange,Je.mediaItemWillChange,Je.mediaPlaybackError,Je.mediaPlaybackPreview,Je.metadataDidChange,Je.primaryPlayerDidChange,Je.playbackBitrateDidChange,Je.playbackDurationDidChange,Je.playbackProgressDidChange,Je.playbackStateDidChange,Je.playbackStateWillChange,Je.playbackTargetAvailableDidChange,Je.playbackTimeDidChange,Je.playbackVolumeDidChange],Ti=function(t){function r(r){var i=t.call(this,[ki,Ei].concat(wi))||this;return i._playerState={bitrate:e.PlaybackBitrate.STANDARD,isLooping:!1,playbackRate:1,volume:1},i._queue=new Mt({}),i._repeatMode=Zr.none,i._shuffleMode=Xr.off,i._storekit=r.storekit,i._playerOptions=r,i._playersByType={},i._currentPlayer=i._getPlayerByType("audio")||new Qr,i._preloader=new _i(i),i}return Y(r,t),Object.defineProperty(r.prototype,"bitrate",{get:function(){return this._currentPlayer.bitrate},set:function(e){this._updatePlayerState("bitrate",e)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"canSupportDRM",{get:function(){return this._currentPlayer.canSupportDRM},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"continuous",{get:function(){return this._continuous||this.hasAuthorization},set:function(e){this._continuous=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentBufferedProgress",{get:function(){return this._currentPlayer.currentBufferedProgress},set:function(e){this._currentPlayer.currentBufferedProgress=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentPlaybackDuration",{get:function(){return this._currentPlayer.currentPlaybackDuration},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentPlaybackTime",{get:function(){return this._currentPlayer.currentPlaybackTime},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentPlaybackTimeRemaining",{get:function(){return this._currentPlayer.currentPlaybackTimeRemaining},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentPlaybackProgress",{get:function(){return this._currentPlayer.currentPlaybackProgress},set:function(e){this._currentPlayer.currentPlaybackProgress=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"formattedCurrentPlaybackDuration",{get:function(){return this._currentPlayer.formattedCurrentPlaybackDuration},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"hasAuthorization",{get:function(){return le(this.storekit)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isPlaying",{get:function(){return this._currentPlayer.isPlaying},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isReady",{get:function(){return this._currentPlayer.isReady},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isPrimaryPlayer",{get:function(){return this._currentPlayer.isPrimaryPlayer},set:function(e){this._currentPlayer.isPrimaryPlayer=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"nowPlayingItem",{get:function(){return this._currentPlayer.nowPlayingItem},set:function(e){this._currentPlayer.nowPlayingItem=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"nowPlayingItemIndex",{get:function(){if(this.queue)return this.queue.position},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"playbackRate",{get:function(){return this._currentPlayer.playbackRate},set:function(e){this._updatePlayerState("playbackRate",e)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"queue",{get:function(){return this._queue},set:function(e){var t=this;this.hasAuthorization&&(e.isRestricted=this.storekit.restrictedEnabled||!1),this.shuffleMode===Xr.songs&&e.shuffle(!1),this._currentPlayer.nowPlayingItem=null;var r=e.item(e.position);r&&r.isPlayable&&this._currentPlayer.prepareToPlay(r).then((function(e){t._currentPlayer.nowPlayingItem=e})).catch((function(){})),e.addEventListener(ki,(function(e){return t.dispatchEvent(ki,e)})),e.addEventListener(Ei,(function(e){return t.dispatchEvent(Ei,e)})),this._queue=e,this.dispatchEvent(ki,e.items)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"repeatMode",{get:function(){return this._repeatMode},set:function(e){this._repeatMode=e,this._updatePlayerState("isLooping",this._repeatMode===Zr.one)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"shuffle",{set:function(e){this.shuffleMode=e?Xr.songs:Xr.off},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"shuffleMode",{get:function(){return this._shuffleMode},set:function(e){e!==this._shuffleMode&&(this._shuffleMode=e,e===Xr.songs?this.queue.shuffle():this.queue.unshuffle(),this.nowPlayingItem&&(this.queue.position=this.queue.indexForItem(this.nowPlayingItem.id)))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"storekit",{get:function(){return this._storekit},set:function(e){var t=this;e&&(e.addEventListener(Ze.authorizationStatusWillChange,(function(e){var r=e.authorizationStatus,i=e.newAuthorizationStatus;return G(t,void 0,void 0,(function(){return Q(this,(function(e){switch(e.label){case 0:return this.isPlaying?r>Qe.DENIED&&i<Qe.RESTRICTED?[4,this.stop(be.PLAYBACK_SUSPENDED)]:[3,2]:[3,4];case 1:return e.sent(),[3,4];case 2:return[4,this.stop()];case 3:e.sent(),e.label=4;case 4:return[2]}}))}))})),this._storekit=e)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"volume",{get:function(){return this._currentPlayer.volume},set:function(e){this._updatePlayerState("volume",e)},enumerable:!0,configurable:!0}),r.prototype.changeToMediaAtIndex=function(e){return void 0===e&&(e=0),G(this,void 0,void 0,(function(){return Q(this,(function(t){return[2,this._changeToMediaAtIndex(e,!0)]}))}))},r.prototype.changeToMediaItem=function(e){return G(this,void 0,void 0,(function(){var t;return Q(this,(function(r){return-1===(t=this.queue.indexForItem(e))?[2,Promise.reject(new ne(ne.MEDIA_DESCRIPTOR))]:[2,this.changeToMediaAtIndex(t)]}))}))},r.prototype.destroy=function(){Object.values(this._playersByType).forEach((function(e){return e.destroy()}))},r.prototype.mute=function(){this._currentPlayer.mute()},r.prototype.pause=function(){return G(this,void 0,void 0,(function(){return Q(this,(function(e){return[2,this._currentPlayer.pause()]}))}))},r.prototype.play=function(){return G(this,void 0,void 0,(function(){return Q(this,(function(e){return this._currentPlayer.nowPlayingItem?[2,this._currentPlayer.play()]:!this._queue||this._queue.isEmpty?[2]:-1!==this.queue.nextPlayableItemIndex?[2,this.changeToMediaAtIndex(this.queue.nextPlayableItemIndex)]:[2]}))}))},Object.defineProperty(r.prototype,"playbackState",{get:function(){return this._currentPlayer.playbackState},enumerable:!0,configurable:!0}),r.prototype.preload=function(){return G(this,void 0,void 0,(function(){return Q(this,(function(e){return[2,this._currentPlayer.preload()]}))}))},r.prototype.prepareToPlay=function(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=!1),G(this,void 0,void 0,(function(){var i;return Q(this,(function(n){try{return[2,this._currentPlayer.prepareToPlay(e,t,r)]}catch(e){if(i=!r&&-1===[ne.DEVICE_LIMIT,ne.STREAM_UPSELL].indexOf(e.errorCode),this.continuous&&i)return[2,this._next()]}return[2]}))}))},r.prototype.showPlaybackTargetPicker=function(){this._currentPlayer.playbackTargetAvailable&&this._currentPlayer.showPlaybackTargetPicker()},r.prototype.skipToNextItem=function(){return G(this,void 0,void 0,(function(){return Q(this,(function(e){return[2,this._next(!0)]}))}))},r.prototype.skipToPreviousItem=function(){return G(this,void 0,void 0,(function(){return Q(this,(function(e){return[2,this._previous(!0)]}))}))},r.prototype.seekToTime=function(e){return G(this,void 0,void 0,(function(){return Q(this,(function(t){return[2,this._currentPlayer.seekToTime(e)]}))}))},r.prototype.seekForward=function(){return G(this,void 0,void 0,(function(){var t;return Q(this,(function(r){return(t=this.currentPlaybackTime+e.PlayerSeek.FORWARD)>this.currentPlaybackDuration?[2,this.skipToNextItem()]:[2,this.seekToTime(t)]}))}))},r.prototype.seekBackward=function(){return G(this,void 0,void 0,(function(){var t;return Q(this,(function(r){return t=this.currentPlaybackTime-e.PlayerSeek.BACK,[2,this.seekToTime(Math.max(0,t))]}))}))},r.prototype.stop=function(e){return G(this,void 0,void 0,(function(){return Q(this,(function(t){switch(t.label){case 0:return[4,this._currentPlayer.stop(e)];case 1:return t.sent(),[2]}}))}))},r.prototype._applyPlayerState=function(e){var t=this;return Object.keys(this._playerState).forEach((function(r){e.hasOwnProperty(r)&&(e[r]=t._playerState[r])})),e},r.prototype._changeToMediaAtIndex=function(t,r,i){return void 0===t&&(t=0),void 0===r&&(r=!1),G(this,void 0,void 0,(function(){var n,o,a,s,u,c,l,h;return Q(this,(function(p){switch(p.label){case 0:if(this.queue.isEmpty)return[2];this.queue.position=t,n=this.currentPlaybackTime,o=this.playbackState,a=this.queue.item(t),p.label=1;case 1:return p.trys.push([1,3,,4]),[4,this._currentPlayer.playMediaItem(a,r)];case 2:return p.sent(),"song"!==a.type||null===this.nowPlayingItem?[2]:(s=this.nowPlayingItem.container,u={container:{id:s.id,name:s.name,type:s.type},duration:this.nowPlayingItem.playbackDuration/1e3,id:this.nowPlayingItem.id,cloudId:this.nowPlayingItem.cloudId},c=i===be.TRACK_SKIPPED_BACKWARDS||i===be.TRACK_SKIPPED_FORWARDS,r&&o===e.PlaybackStates.playing&&c?[2,this._currentPlayer.playActivity.skip(u,i,n)]:(l=(c||r)&&o!==e.PlaybackStates.playing,[2,this._currentPlayer.playActivity.play(u,l?0:n)]));case 3:return h=p.sent(),[2,Promise.reject(h)];case 4:return[2]}}))}))},r.prototype._getPlayerByType=function(t){var r,i=this;if(this._playersByType[t])return this._applyPlayerState(this._playersByType[t]);if("audio"!==t)throw new Error("Invalid player type requested: "+t);return r=new gi(this._playerOptions),wi.forEach((function(e){r.addEventListener(e,(function(t){return i.dispatchEvent(e,t)}))})),r.addEventListener(Je.playbackStateDidChange,(function(t){var r=t.state;return G(i,void 0,void 0,(function(){return Q(this,(function(t){switch(t.label){case 0:return r!==e.PlaybackStates.ended?[3,4]:this.continuous?[4,this._next()]:[3,2];case 1:return t.sent(),[3,4];case 2:return[4,this.stop(be.NATURAL_END_OF_TRACK)];case 3:t.sent(),t.label=4;case 4:return[2]}}))}))})),this._playersByType[t]=r,this._applyPlayerState(r)},r.prototype._next=function(t){return void 0===t&&(t=!1),G(this,void 0,void 0,(function(){return Q(this,(function(r){switch(r.label){case 0:return this.queue.isEmpty?[2]:this.repeatMode!==Zr.one?[3,2]:[4,this.seekToTime(0)];case 1:return r.sent(),[2,this.play()];case 2:return void 0===this.queue.nextPlayableItemIndex||-1===this.queue.nextPlayableItemIndex?[3,3]:[2,this._changeToMediaAtIndex(this.queue.nextPlayableItemIndex,t,be.TRACK_SKIPPED_FORWARDS)];case 3:return this.repeatMode!==Zr.all?[3,4]:[2,this._changeToMediaAtIndex(0,!1)];case 4:return this.isPlaying?[4,this.stop(be.TRACK_SKIPPED_FORWARDS)]:[3,6];case 5:r.sent(),r.label=6;case 6:this._currentPlayer.playbackState=e.PlaybackStates.completed,r.label=7;case 7:return[2]}}))}))},r.prototype._previous=function(e){return void 0===e&&(e=!1),G(this,void 0,void 0,(function(){return Q(this,(function(t){return this.queue.isEmpty?[2]:-1!==this.queue.previousPlayableItemIndex?[2,this._changeToMediaAtIndex(this.queue.previousPlayableItemIndex,e,be.TRACK_SKIPPED_BACKWARDS)]:[2]}))}))},r.prototype._updatePlayerState=function(e,t){this._playerState[e]=t,this._currentPlayer[e]=t},r}(Et),Ii="1.1932.0-2",Ai=function(t){function r(r,i){void 0===i&&(i={});var n=t.call(this,Object.keys(Je))||this;if(n.privateEnabled=!1,n.siriInitiated=!1,n.version=Ii,n._bag=Re,n._maxBitrate=e.PlaybackBitrate.STANDARD,n._playbackErrorDialog=!0,"object"==typeof r&&(i=r,r=void 0),!r)throw new Error("MusicKit was initialized without an developerToken.");Object.assign(Re.features,Ne(i.features)),i.debug&&(Re.logger.enabled=!0),Re.app=i.app||{},(i.affiliateToken||i.campaignToken)&&(i.linkParameters=Object.assign(i.linkParameters||{},{at:i.affiliateToken,ct:i.campaignToken}));var o=new Xe(r,{authenticateMethod:Re.features["legacy-authenticate-method"]?"POST":"GET",deeplink:i.linkParameters,iconURL:Re.app.icon,persist:i.persist});return o.addEventListener(Je.authorizationStatusDidChange,(function(e){n.dispatchEvent(Je.authorizationStatusDidChange,e)})),o.addEventListener(Je.storefrontCountryCodeDidChange,(function(e){n.dispatchEvent(Je.storefrontCountryCodeDidChange,e)})),o.addEventListener(Je.storefrontIdentifierDidChange,(function(e){n.dispatchEvent(Je.storefrontIdentifierDidChange,e)})),o.addEventListener(Je.userTokenDidChange,(function(e){n._api&&(n._api.clearCacheItems(),n._api=void 0),n.dispatchEvent(Je.userTokenDidChange,e)})),n.storekit=Re.storekit=o,i.bitrate&&(n.bitrate=i.bitrate),i.prefix&&/^(?:web|preview)$/.test(i.prefix)&&(n.prefix=Re.prefix=i.prefix),i.sourceType&&(Re.sourceType=i.sourceType),i.storefrontId&&(n.storefrontId=i.storefrontId),i.suppressErrorDialog&&(n._playbackErrorDialog=!i.suppressErrorDialog),n.privateEnabled=i.privateEnabled||!1,n.siriInitiated=i.siriInitiated||!1,Re.logger.debug("MusicKit JS Version: "+n.version),Re.logger.debug("Link Parameters",i.linkParameters),Re.app&&Re.logger.debug("App",Re.app),n}return Y(r,t),Object.defineProperty(r.prototype,"developerToken",{get:function(){return this.storekit.developerToken},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"api",{get:function(){if(!this._api){var e=Re.features["api-session-storage"]?sessionStorage:void 0;this._api=new gt(Re.urls.api,this.developerToken,this.storefrontId,this.musicUserToken,this.storekit.storefrontCountryCode,e)}return this._api},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bitrate",{get:function(){return this.player.bitrate},set:function(e){this.player.bitrate=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isAuthorized",{get:function(){return this.storekit.hasAuthorized},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isRestricted",{get:function(){return this.storekit.authorizationStatus===Qe.RESTRICTED},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"musicUserToken",{get:function(){return this.storekit.userToken},set:function(e){this.storekit.userToken=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"subscribeURL",{get:function(){return this.storekit.deeplinkURL({p:"subscribe"})},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"subscribeFamilyURL",{get:function(){return this.storekit.deeplinkURL({p:"subscribe-family"})},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"subscribeIndividualURL",{get:function(){return this.storekit.deeplinkURL({p:"subscribe-individual"})},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"subscribeStudentURL",{get:function(){return this.storekit.deeplinkURL({p:"subscribe-student"})},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"player",{get:function(){var t=this;if(!this._player){this._player=new Ti({accurateTiming:!!Re.features["player-accurate-timing"],bitrate:this._maxBitrate,privateEnabled:this.privateEnabled,siriInitiated:this.siriInitiated,storekit:this.storekit});var r=Je.bufferedProgressDidChange,i=Je.mediaCanPlay,n=Je.mediaItemDidChange,o=Je.mediaItemStateDidChange,a=Je.mediaItemStateWillChange,s=Je.mediaItemWillChange,u=Je.mediaPlaybackError,c=Je.metadataDidChange,l=Je.playbackDurationDidChange,h=Je.playbackProgressDidChange,p=Je.playbackStateDidChange,d=Je.playbackTimeDidChange,f=Je.playbackVolumeDidChange,y=Je.primaryPlayerDidChange,b=Je.queueItemsDidChange,m=Je.queuePositionDidChange;this._player.addEventListener(u,(function(e){return t._handlePlaybackError(e)})),this._player.addEventListener(p,(function(r){e.PlaybackStates.paused!==r.state&&e.PlaybackStates.ended!==r.state||t.storekit.presentSubscribeView(!1),t.dispatchEvent(p,r)})),[r,i,n,o,a,s,c,y,l,h,d,f,b,m].forEach((function(e){return t._player.addEventListener(e,(function(r){return t.dispatchEvent(e,r)}))}))}return this._player},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"storefrontId",{get:function(){return this._apiStorefrontId||this.storekit.storefrontCountryCode},set:function(e){if(this._api&&this._api.storefrontId!==e){this._api.clearCacheItems();var t=Re.features["api-session-storage"]?sessionStorage:void 0;this._api=new gt(Re.urls.api,this.developerToken,e,this.musicUserToken,this.storekit.storefrontCountryCode,t)}this._apiStorefrontId=e},enumerable:!0,configurable:!0}),r.prototype.addToLibrary=function(e,t){return G(this,void 0,void 0,(function(){var r;return Q(this,(function(i){switch(i.label){case 0:return[4,this.authorize()];case 1:return i.sent(),t||(t=/[a-z]{2}\.[a-z0-9\-]+/i.test(e)?"playlists":"albums"),(r={})[t]=[e],[2,this.api.addToLibrary(r)]}}))}))},r.prototype.authorize=function(){return G(this,void 0,void 0,(function(){var e,t=this;return Q(this,(function(r){switch(r.label){case 0:return this.deferPlayback(),this.storekit.userTokenIsValid?[2,this.storekit.userToken]:[4,this.storekit.requestUserToken()];case 1:return e=r.sent(),this.storekit.userTokenIsValid?[4,this.storekit.requestStorefrontCountryCode().catch((function(e){return t.unauthorize(),Promise.reject(e)}))]:[3,3];case 2:return r.sent(),[2,e];case 3:return[2]}}))}))},r.prototype.changeToMediaAtIndex=function(e){return G(this,void 0,void 0,(function(){return Q(this,(function(t){switch(t.label){case 0:return this._checkAuthorization()?[4,this.authorize()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2,this.player.changeToMediaAtIndex(e)]}}))}))},r.prototype.cleanup=function(){this._player&&this._player.destroy&&this._player.destroy()},r.prototype.deferPlayback=function(){return G(this,void 0,void 0,(function(){return Q(this,(function(e){switch(e.label){case 0:return this.player.isPlaying||this.player.isReady?[3,2]:[4,this.player.preload()];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},r.prototype.me=function(){return G(this,void 0,void 0,(function(){return Q(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.storekit.me()];case 1:return[2,e.sent()];case 2:return e.sent(),[2,Promise.reject(new ne(ne.AUTHORIZATION_ERROR,"Unauthorized"))];case 3:return[2]}}))}))},r.prototype.pause=function(){return G(this,void 0,void 0,(function(){var e;return Q(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.player.pause()];case 1:return t.sent(),[3,3];case 2:return e=t.sent(),this._handlePlaybackError(e),[3,3];case 3:return[2,Promise.resolve()]}}))}))},r.prototype.play=function(){return G(this,void 0,void 0,(function(){var e;return Q(this,(function(t){switch(t.label){case 0:return this._checkAuthorization()?[4,this.authorize()]:[3,2];case 1:t.sent(),t.label=2;case 2:return t.trys.push([2,4,,5]),[4,this.player.play()];case 3:return t.sent(),[3,5];case 4:return e=t.sent(),this._handlePlaybackError(e),[3,5];case 5:return[2,Promise.resolve()]}}))}))},r.prototype.playNext=function(e,t){return void 0===t&&(t=!1),G(this,void 0,void 0,(function(){var r;return Q(this,(function(i){switch(i.label){case 0:return!this.player.queue||this.player.queue.isEmpty?[2,this.setQueue(e)]:[4,this._dataForQueueOptions(e)];case 1:return r=i.sent(),[2,this.player.queue.prepend(r,t)]}}))}))},r.prototype.playLater=function(e){return G(this,void 0,void 0,(function(){var t;return Q(this,(function(r){switch(r.label){case 0:return!this.player.queue||this.player.queue.isEmpty?[2,this.setQueue(e)]:[4,this._dataForQueueOptions(e)];case 1:return t=r.sent(),[2,this.player.queue.append(t)]}}))}))},r.prototype.seekToTime=function(e){return G(this,void 0,void 0,(function(){var t;return Q(this,(function(r){switch(r.label){case 0:return this._checkAuthorization()?[4,this.authorize()]:[3,2];case 1:r.sent(),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,this.player.seekToTime(e)];case 3:return r.sent(),[3,5];case 4:return t=r.sent(),this._handlePlaybackError(t),[3,5];case 5:return[2,Promise.resolve()]}}))}))},r.prototype.setQueue=function(e){return G(this,void 0,void 0,(function(){var t;return Q(this,(function(r){switch(r.label){case 0:return[4,this.deferPlayback()];case 1:return r.sent(),[4,this._dataForQueueOptions(e)];case 2:return t=r.sent(),this.player.queue=new Mt(t),[2,this.player.queue]}}))}))},r.prototype.skipToNextItem=function(){return G(this,void 0,void 0,(function(){var e;return Q(this,(function(t){switch(t.label){case 0:return this._checkAuthorization()?[4,this.authorize()]:[3,2];case 1:t.sent(),t.label=2;case 2:return t.trys.push([2,4,,5]),[4,this.player.skipToNextItem()];case 3:return t.sent(),[3,5];case 4:return e=t.sent(),this._handlePlaybackError(e),[3,5];case 5:return[2,Promise.resolve()]}}))}))},r.prototype.skipToPreviousItem=function(){return G(this,void 0,void 0,(function(){var e;return Q(this,(function(t){switch(t.label){case 0:return this._checkAuthorization()?[4,this.authorize()]:[3,2];case 1:t.sent(),t.label=2;case 2:return t.trys.push([2,4,,5]),[4,this.player.skipToPreviousItem()];case 3:return t.sent(),[3,5];case 4:return e=t.sent(),this._handlePlaybackError(e),[3,5];case 5:return[2,Promise.resolve()]}}))}))},r.prototype.seekForward=function(){return G(this,void 0,void 0,(function(){var e;return Q(this,(function(t){switch(t.label){case 0:return this._checkAuthorization()?[4,this.authorize()]:[3,2];case 1:t.sent(),t.label=2;case 2:return t.trys.push([2,4,,5]),[4,this.player.seekForward()];case 3:return t.sent(),[3,5];case 4:return e=t.sent(),this._handlePlaybackError(e),[3,5];case 5:return[2,Promise.resolve()]}}))}))},r.prototype.seekBackward=function(){return G(this,void 0,void 0,(function(){var e;return Q(this,(function(t){switch(t.label){case 0:return this._checkAuthorization()?[4,this.authorize()]:[3,2];case 1:t.sent(),t.label=2;case 2:return t.trys.push([2,4,,5]),[4,this.player.seekBackward()];case 3:return t.sent(),[3,5];case 4:return e=t.sent(),this._handlePlaybackError(e),[3,5];case 5:return[2,Promise.resolve()]}}))}))},r.prototype.stop=function(){return G(this,void 0,void 0,(function(){var e;return Q(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.player.stop()];case 1:return t.sent(),[3,3];case 2:return e=t.sent(),this._handlePlaybackError(e),[3,3];case 3:return[2,Promise.resolve()]}}))}))},r.prototype.unauthorize=function(){return G(this,void 0,void 0,(function(){return Q(this,(function(e){return this.storekit.revokeUserToken(),[2]}))}))},r.prototype._dataForQueueOptions=function(e){return G(this,void 0,void 0,(function(){var t,r,i,n,o,a,s,u,c,l,h;return Q(this,(function(p){switch(p.label){case 0:if(t=e,e.url&&(r=ue(e.url),i=r.contentId,n=r.kind,o=r.storefrontId,e[n]=i,this.storefrontId=o),e.station)throw new ne(ne.UNSUPPORTED_ERROR,"station is not a supported option.");return e.albums&&(e.album=e.albums[0]),e.playlists&&(e.playlist=e.playlists[0]),e.song&&(e.songs=[e.song]),(a=e.songs?e.songs[0]:e.album||e.playlist)?(s=ce(a),u=s?this.api.library:this.api,s?[4,this.authorize()]:[3,2]):[3,8];case 1:p.sent(),p.label=2;case 2:return e.album?(c=t,[4,u.album(a,e.parameters)]):[3,4];case 3:return c.loaded=p.sent(),[3,8];case 4:return e.playlist?(l=t,[4,u.playlist(a,e.parameters)]):[3,6];case 5:return l.loaded=p.sent(),[3,8];case 6:return e.songs?(h=t,[4,u.songs(e.songs,e.parameters)]):[3,8];case 7:h.loaded=p.sent(),p.label=8;case 8:return[2,t]}}))}))},r.prototype._handlePlaybackError=function(e){Re.logger.log("mediaPlaybackError",e),this.dispatchEvent(Je.mediaPlaybackError,e),this._playbackErrorDialog&&e.hasOwnProperty("presentDialog")&&e.presentDialog()},r.prototype._checkAuthorization=function(){return!this.player.isReady},r}(Ct),Si={HIDE:"none",SHOW:""},Ci=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,16)},Oi=function(){function e(e,t){void 0===e&&(e=void 0),void 0===t&&(t=Si);var r=this;if(this.elements=e,this.classes=t,!document||"function"!=typeof MutationObserver||!e)return this.elements=void 0,void(this.identifiers=[]);this.identifiers=Object.keys(e),this.identifiers.forEach((function(t){for(var i=r._nodesForDefinitionId(t),n=0;n<i.length;++n){var o=i[n];r.attach(o,e[t])}})),new MutationObserver(this._mutationDidOccur.bind(this)).observe(document.body,{attributes:!0,childList:!0,subtree:!0})}return e.prototype.attach=function(e,t){void 0===t&&(t=this.elements[e.id]),!e.innerText&&t.defaultText&&(e.innerText=t.defaultText),t.click&&e.addEventListener("mouseup",t.click),this._renderDefinition(e,t)},e.prototype.detach=function(e,t){void 0===t&&(t=this.elements[e.id]),t&&t.click&&e.removeEventListener("mouseup",t.click)},e.prototype.update=function(e){var t=this;void 0===e&&(e=this.identifiers),this.elements&&Ci((function(){e.forEach((function(e){for(var r=t.elements[e],i=t._nodesForDefinitionId(e),n=0;n<i.length;++n){var o=i[n];r&&o&&t._renderDefinition(o,r)}}))}))},e.prototype._mutationDidOccur=function(e){var t=this;e.forEach((function(e){if("attributes"===e.type){var r=t.elements[e.attributeName];r&&t.attach(e.target,r)}for(var i=function(r){var i=e.addedNodes[r];if(!i.id&&!i.dataset)return"continue";i.id&&t.elements[i.id]&&t.attach(i,t.elements[i.id]),t.identifiers.forEach((function(e){i.getAttribute(e)&&t.attach(i,t.elements[e])}))},n=0;n<e.addedNodes.length;++n)i(n);for(var o=function(r){var i=e.removedNodes[r];if(!i.id&&!i.dataset)return"continue";i.id&&t.elements[i.id]&&t.detach(i,t.elements[i.id]),t.identifiers.forEach((function(e){i.getAttribute(e)&&t.detach(i,t.elements[e])}))},a=0;a<e.removedNodes.length;++a)o(a)}))},e.prototype._nodesForDefinitionId=function(e){var t=/^data-/.test(e)?"["+e+"]":"#"+e;return document.querySelectorAll(t)},e.prototype._renderDefinition=function(e,t){var r=this,i="function"==typeof t.enabled?t.enabled(e):t.enabled||!0,n="function"==typeof t.display?t.display(e):t.display||!0;Ci((function(){i?e.removeAttribute("disabled"):e.setAttribute("disabled",!0),e.style.display=n?r.classes.SHOW:r.classes.HIDE,n&&0===e.children.length&&t.content&&(e.innerText=t.content(e))}))},e}(),Di=/^http(?:s)?\:\/\/(?:itunes|(embed\.)?(music|podcast))\.apple\.com/i,Ri=["allow-forms","allow-popups","allow-same-origin","allow-scripts","allow-storage-access-by-user-activation","allow-top-navigation-by-user-activation"],Li=ne.errors,Ni="undefined"!=typeof window&&"undefined"!=typeof document,Ui="apple-music-now-playing";function ji(e){var t=document.createEvent("Event");t.initEvent(e,!0,!0),setTimeout((function(){return document.dispatchEvent(t)}))}function xi(e,t){if(!e||!t)return!1;if(oe.test(e)){var r=ue(e).contentId;r&&(e=r)}return e===t.id||t.container&&t.container.id===e}function Mi(e){if(!e)throw new ne(ne.INVALID_ARGUMENTS,"configuration required");var t,r,i,n,o,a,s,u,c=e.declarativeMarkup,l=e.developerToken,h=e.mergeQueryParams;if(!l)throw new ne(ne.CONFIGURATION_ERROR,"Missing developer token");return h&&Ni&&window.location&&(e.linkParameters=Object.assign(e.linkParameters||{},Fe(window.location.href))),Pi&&Pi.cleanup(),Pi=new Ai(l,e),c&&(r={defaultText:"Sign In to Apple Music",click:(t=Pi).authorize.bind(t),display:function(){return t.player.canSupportDRM&&!t.isAuthorized}},i={content:function(){return se(t.player.currentPlaybackDuration)},display:function(){return t.player.nowPlayingItem}},n={content:function(){return Math.round(100*t.player.currentPlaybackProgress)+"%"},display:function(){return t.player.nowPlayingItem}},o={content:function(){return se(t.player.currentPlaybackTime)},display:function(){return t.player.nowPlayingItem}},a={click:function(e){var t=e.target;t.togglePlaybackTime=!t.togglePlaybackTime},content:function(e){return se(e.togglePlaybackTime?t.player.currentPlaybackDuration:t.player.currentPlaybackTimeRemaining)},display:function(){return t.player.nowPlayingItem}},s={defaultText:"Sign Out of Apple Music",click:t.unauthorize.bind(t),display:function(){return t.player.canSupportDRM&&t.isAuthorized}},u=new Oi({"apple-music-authorize":r,"apple-music-current-playback-duration":i,"apple-music-current-playback-progress":n,"apple-music-current-playback-time":o,"apple-music-current-playback-time-remaining":a,"apple-music-unauthorize":s,"data-apple-music-authorize":r,"data-apple-music-add-to-library":{click:function(e){var r=e.target.dataset,i=r.appleMusicAddToLibrary,n=r.appleMusicType;t.addToLibrary(i,n)}},"data-apple-music-current-playback-duration":i,"data-apple-music-current-playback-progress":n,"data-apple-music-current-playback-time":o,"data-apple-music-current-playback-time-remaining":a,"data-apple-music-now-playing":{content:function(e){var r=e.dataset.appleMusicNowPlaying||"info",i=it(t.player.nowPlayingItem,r);if(!(/artworkurl$/i.test(r)&&e.height&&e.width))return i;e.src=mt({url:i},e.height,e.width)},display:function(){return t.player.nowPlayingItem}},"data-apple-music-skip-to-next-item":{defaultText:"Next",click:t.skipToNextItem.bind(t),enabled:function(){return!t.player.queue.isEmpty}},"data-apple-music-seek-forward":{defaultText:"Seek Forward",click:t.seekForward.bind(t),enabled:function(){return!t.player.queue.isEmpty}},"data-apple-music-seek-backward":{defaultText:"Seek Backward",click:t.seekBackward.bind(t),enabled:function(){return!t.player.queue.isEmpty}},"data-apple-music-pause":{defaultText:"Pause",click:t.pause.bind(t),display:function(){return t.player.isPlaying}},"data-apple-music-play":{defaultText:"Play",click:t.play.bind(t),display:function(){return!t.player.isPlaying},enabled:function(){return!t.player.queue.isEmpty}},"data-apple-music-set-queue":{click:function(e){var r=e.target.dataset,i=r.appleMusicAutoplay,n=r.appleMusicSetQueue,o=r.appleMusicType;if(xi(n,t.player.nowPlayingItem))return t.player.isPlaying?t.pause():t.play();o||(o=oe.test(n)?"url":/^pl\./i.test(n)?"playlist":"album");var a={};a[o]=n,t.setQueue(a).then((function(e){"false"!==i&&t.play()}))},display:function(e){if(t.player.nowPlayingItem){var r=e.dataset,i=r.appleMusicSetQueue;r.appleMusicType,xi(i,t.player.nowPlayingItem)?e.classList.add(Ui):e.classList.remove(Ui)}return!0}},"data-apple-music-skip-to-previous-item":{defaultText:"Previous",click:t.skipToPreviousItem.bind(t),enabled:function(){return!t.player.queue.isEmpty}},"data-apple-music-unauthorize":s}),t.addEventListener(Je.authorizationStatusDidChange,(function(){u.update(["apple-music-authorize","apple-music-unauthorize","data-apple-music-authorize","data-apple-music-unauthorize"])})),t.addEventListener(Je.playbackStateDidChange,(function(){u.update(["data-apple-music-pause","data-apple-music-play","data-apple-music-skip-to-next-item","data-apple-music-skip-to-previous-item","data-apple-music-seek-forward","data-apple-music-seek-backward"])})),t.addEventListener(Je.mediaItemDidChange,(function(){u.update(["data-apple-music-now-playing","data-apple-music-set-queue"])})),t.addEventListener(Je.playbackDurationDidChange,(function(){u.update(["apple-music-current-playback-duration","data-apple-music-current-playback-duration"])})),t.addEventListener(Je.playbackProgressDidChange,(function(){u.update(["apple-music-current-playback-progress","data-apple-music-current-playback-progress"])})),t.addEventListener(Je.playbackTimeDidChange,(function(){u.update(["apple-music-current-playback-time","apple-music-current-playback-time-remaining","data-apple-music-current-playback-time","data-apple-music-current-playback-time-remaining"])})),t.addEventListener(Je.queueItemsDidChange,(function(){u.update(["data-apple-music-pause","data-apple-music-play","data-apple-music-skip-to-next-item","data-apple-music-skip-to-previous-item","data-apple-music-seek-forward","data-apple-music-seek-backward"])}))),ji(Je.configured),Pi}if(Ni){ji(Je.loaded);var Bi=function(){function e(e){var t=document.head.querySelector("meta[name="+e+"]");return t&&t.content?t.content:void 0}var t,r=e("apple-music-developer-token")||e("JWT"),i=e("apple-music-app-build")||e("version"),n=e("apple-music-app-name"),o=e("apple-music-app-version");return(r||i||n||o)&&(t={},r&&(t.developerToken=r),(i||n||o)&&(t.app={},i&&(t.app.build=i),n&&(t.app.name=n),o&&(t.app.version=o))),t}(),zi=/interactive|complete|loaded/.test(document.readyState);Bi&&Bi.developerToken&&!zi&&!Pi&&(Bi.declarativeMarkup=!0,document.addEventListener("DOMContentLoaded",(function(){return Mi(Bi)})))}e.errors=Li,e.Events=Je,e.MediaItem=Rt,e.MKError=ne,e.formatArtworkURL=mt,e.formatMediaTime=se,e.configure=Mi,e.getInstance=function(){if(!Pi)throw new ne(ne.CONFIGURATION_ERROR,"No configured instance");return Pi},e.Queue=Mt,e.version=Ii,e.formattedMediaURL=ue,e.formattedMilliseconds=function(e){return ae(e/1e3)},e.formattedSeconds=ae,e.generateEmbedCode=function(e,t){if(void 0===t&&(t={height:"450",width:"660"}),!Di.test(e))throw new Error("Invalid content url");"song"===ue(e).kind&&(t.height="150"),t.height=(""+t.height).replace(/(\d+)px/i,"$1"),t.width=(""+t.width).replace(/^(\d+)(?!px)%?$/i,"$1px");var r="width:100%;max-width:"+t.width+";overflow:hidden;background:transparent;",i=window.localStorage.getItem("mk-generate-swizzle")||"https://embed.music.apple.com";return'<iframe allow="autoplay *; encrypted-media *;" frameborder="0" height="'+t.height+'" style="'+r+'" sandbox="'+Ri.join(" ")+'" src="'+e.replace(Di,i)+'"></iframe>'},Object.defineProperty(e,"__esModule",{value:!0})}));